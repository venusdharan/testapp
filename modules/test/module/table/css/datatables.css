var __extends,AutoSuggest;(function(n){var t;(function(n){var t,i,r,u,f,e;(function(n){n.User="SRCHHPGUSR"})(t=n.CookieNames||(n.CookieNames={})),function(n){n.AutoSuggest="AS"}(i=n.CrumbNames||(n.CrumbNames={})),function(n){n.CursorPosition="cp";n.ConversationId="cvid";n.SuggestionCount="sc";n.PartialQuery="pq";n.SuggestionPosition="sp";n.SuggestionType="qs";n.PreviewPaneSuggestionType="qsc";n.SkipValue="sk";n.PreviewPaneSkipValue="skc";n.Ghosting="ghc";n.Css="css";n.Count="count";n.DataSet="ds";n.SessionId="sid";n.TimeStamp="qt";n.Query="q";n.ImpressionGuid="ig";n.QFQuery="qry";n.FormCode="form";n.HashedMuid="nclid";n.RequestElToken="elvr";n.AppId="appid";n.History="history";n.NoHistory="nohs";n.ApiTextDecoration="textdecorations";n.ClientId="clientid";n.Market="mkt";n.Scope="scope";n.CountryCode="cc";n.HomeGeographicRegion="hgr";n.SetLang="setlang"}(r=n.QueryParams||(n.QueryParams={})),function(n){n.ImpressionGuid="X-MSEdge-IG"}(u=n.Headers||(n.Headers={})),function(n){n.HitHighlighting="h";n.PopularNow="p";n.Local="l";n.Answers="a"}(f=n.Options||(n.Options={})),function(n){n.Id="id";n.Query="query";n.Url="url";n.Navigation="nav";n.Type="stype";n.Autocomplete="hc";n.SubstrateInst="substrateInst";n.InstData="h";n.AriaLabel="aria-label"}(e=n.SuggestionAttributes||(n.SuggestionAttributes={}))})(t=n.Service||(n.Service={}))})(AutoSuggest||(AutoSuggest={})),function(n){function g(t,i){if(i){var r=k.exec(t);return r&&n.TopLevelDomains[r[1].toLowerCase()]==1}return k.test(t)}function kt(n){return pt.test(n)}function s(t){var i=t;return t=t.replace(/%([^0-9a-fA-F])/g,"%25$1").replace(/%([^0-9a-fA-F])/g,"%25$1").replace(/%(.[^0-9a-fA-F])/g,"%25$1").replace(/%(.[^0-9a-fA-F])/g,"%25$1").replace(/%(.)?$/,"%25$1"),n.safeExecute(function(){return decodeURI(t)},"safeDecodeURI",i,i)}function u(n,t){var r,u,i;if(!n)return null;if(n=n.trim(),n.includes("%")&&h(n))if(n.includes("?")){var e=/([^?]*)(.*)/.exec(n),f=e[1],o=e[2];f=s(f);n=f+o}else n=s(n);return(r=at.exec(n),!r)?null:(u=r[0].length,t&&u<n.length)?null:(i={length:u,type:0,protocol:r[1]||"",auth:r[2]||"",hostname:r[3]||"",port:r[4]||"",path:r[5]||"",parameters:r[6]||"",unparsedSegment:n.substr(u)},i.auth&&!i.auth.includes(":")&&!i.protocol&&!i.port&&!i.path&&!i.parameters)?null:i.protocol||i.path&&i.path.endsWith("/")?i:vt.test(i.hostname)||g(i.hostname,t)||v.test(i.hostname)||p.test(i.hostname)?i:g(i.hostname,!1)?null:(i.type=i.path&&!kt(i.path)?1:2,i)}function ti(n){return gt.some(function(t){return n.startsWith(t)})||dt.test(n)||n.toLocaleLowerCase().includes(ni)}function ii(n,t,i){var f=0,e=0,s=0,r;(t.startsWith("read:")||t.startsWith("ftp:"))&&(t=t.replace(o,""));r=u(t,!0);r&&r.type==0&&(f=ri(i,r),e=ui(i,t,r),s=fi(i,r));n.protocolMatchLength=f;n.domainMatchLength=e;n.pathMatchLength=s}function ri(n,t){var i=o.exec(n),r=i?i[1]:n.trim();return t.protocol.startsWith(r)?r.length:0}function ui(t,i,r){var u,f,o,e,s;return v.test(r.hostname)||p.test(r.hostname)?r.hostname.startsWith(t)||i.startsWith(t)?t.length:0:(u=r.hostname.split("."),u.length==1?f=HitHighlightingParser.addMarkers(u[0],t):(u=u.length>2&&n.SecondLevelDomains[u[u.length-2]]?u.splice(0,u.length-2):u.splice(0,u.length-1),o=u.join("."),f=HitHighlightingParser.addMarkers(o,t)),e=f.indexOf(HitHighlightingParser.startMarker),e==-1)?0:t.includes(".")?(t.endsWith("/")&&(t=t.substr(0,t.length-1)),r.hostname.includes(t)?t.length:0):(s=f.indexOf(HitHighlightingParser.endMarker),s-e-1)}function fi(n,t){var i,r,u;return t.path?(i=HitHighlightingParser.addMarkers(t.path,n),r=i.indexOf(HitHighlightingParser.startMarker),r==-1)?0:(u=i.indexOf(HitHighlightingParser.endMarker),u-r-1):0}function ei(n){return yt.test(n)}function nt(n){return o.test(n)}function h(n){return ct.test(n)}function oi(n){return nt(n)&&!h(n)}function si(n){var t;return t=typeof n=="string"?n:c(n,!0),t=hi(t),t.trim().replace(/^ht+p(s)?[:;]+[\\\/]*|^\/*/i,function(n,t){return t?"https://":"http://"})}function hi(n){if(!n||!n.includes("\\"))return n;var i=n.includes("?")?n.indexOf("?"):n.length,r=n.includes("#")?n.indexOf("#"):n.length,t=Math.min(i,r),u=n.substring(0,t),f=n.substr(t);return u.replace(/\\/g,"/")+f}function c(n,t){var i=n.protocol?n.protocol:"";return i+=!t&&n.auth?n.auth:"",i+=n.hostname,i+=n.port?n.port:"",i+=n.path?n.path:"",i+=n.parameters?n.parameters:"",i+(n.unparsedSegment?n.unparsedSegment:"")}function i(n,t){var i=n,r,f;return t&1&&(r=tt.exec(i),r&&(i=r[1])),t&2&&(r=it.exec(i),r&&(i=r[1])),t&4&&(r=rt.exec(i),r&&(i=r[1])),t&8&&(r=ut.exec(i),r&&(i=r[1])),t&16&&(r=ci.exec(i),r&&(i=r[1])),t&32&&(f=u(i,!1),f&&(f.protocol=f.protocol.toLocaleLowerCase(),f.hostname=f.hostname.toLocaleLowerCase(),i=c(f))),t&64&&(i=s(i)),i}function li(n){return ut.test(n)}function f(n){return it.test(n)?1:tt.test(n)?2:rt.test(n)?3:0}function ai(n,t,r){var f,u,o,s,e;return t?t=="/"?n:(f=i(t,7),f!=t)?n:(u=i(n,7),!u)?n:(o=t.toLowerCase(),"https".startsWith(o)&&!u.startsWith(t))?n:r?u:(s=i(f,8),s!=f)?u:(e=i(u,8),!e)?u:"www".startsWith(o)&&!e.startsWith(t)?u:e:i(n,r?7:15)||n}function vi(n,t){var i=f(t);switch(f(n)){case 1:return i!=2;case 2:return i!=1;case 3:case 0:return!0}}function yi(t,r,u){if(i(r,127)!=i(u,127))return!1;var e=f(t.originalQuery);return n.contains([1,2],e)&&!vi(r,u)?!1:!0}function et(n){var i=u(n,!0),r,t;return i?(t=i.hostname.split("."),r=i.hostname&&t.length>1?t[t.length-1]=="com"&&ft.some(function(n){return t[t.length-2]==n}):!0,r?i.path:null):null}function pi(t){if(t=="https://www.bing.com/?form=EDGSTP&pc=MESP"||t=="https://www.bing.com/?form=EDGSTP&pc=MESPB")return!0;var i=et(t);return!!i&&n.contains(["/search","/entityexplore"],i.toLowerCase())}function wi(n){var t=u(n.replace(/^ftp:/,"http:"),!0);return(t?t.hostname:null)||""}function bi(t){var r=t.queryToFetch.toLocaleLowerCase(),f,u;return r?(f=["/","ht","htt","http","https","ww","www"],u=i(r,15),!u||n.contains(f,r)||u!=r&&"www".startsWith(i(r,7))):!1}function ki(n){var t,i;return ht.test(n)?!0:(t=n.replace(wt,"/"),bt.test(t)?t=t.replace(d,"."):t.includes(".")&&(t=t.replace(d,"")),i=u(t,!0),i&&i.type==0)}var r="\\-\\s\\[\\]\\/\\\\!@#$%^&*()+={}:;~`\"'|<,>.。?",ot="(?:[^"+r+"]-*)*[^"+r+"](?:-*[^"+r+"])*",l="(?:[^"+r+"]-*)*[^"+r+"0-9](?:-*[^"+r+"])*",st="(?:(?:"+ot+"[.。])*"+l+")[.。]?",a="(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])",e="(?:(?:"+a+"\\.){3}"+a+")",v=new RegExp("^"+e+"$"),t="(?:[0-9a-fA-F]{1,4})",y="(?::(?:(?::"+t+"){1,7}|:)|(?:"+t+":){1,7}:|(?:"+t+":){7}"+t+"|(?:"+t+":){1,6}(?::"+t+"){1}|(?:"+t+":){1,5}(?::"+t+"){2}|(?:"+t+":){1,4}(?::"+t+"){3}|(?:"+t+":){1,3}(?::"+t+"){4}|(?:"+t+":){1,2}(?::"+t+"){5}|(?:"+t+":){1,1}(?::"+t+"){6}|fe80:(?::"+t+"){0,4}%[0-9]+|::ffff:"+e+"|)",p=new RegExp("^\\["+y+"\\]$","i"),w="ht+ps?[:;]+[\\\\/]*",ht=new RegExp(w,"i"),b=w+"|/+",ct=new RegExp("^("+b+")","i"),lt=st+"|"+e+"|\\["+y+"\\]",at=new RegExp("^("+b+")?([^/]+@)?("+lt+")(:(?:6553[0-5]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{1,4}|[1-9][0-9]{0,3}))?([\\/\\\\][^?#]*)?([?#].*)?","i"),vt=/^localhost[.。]?$/,k=new RegExp("[.。]("+l+")[.。]?$","i"),yt=/((^[\\]{2}).+)|(^[a-z]:\\.*)/i,o=/^([a-z0-9\-]+):/i,pt=/\s/,d=/\s+/g,wt=/\s+\/(?!\/)/g,bt=/([^\/]|^)\/(?!\/)/,ft;n.tryParseUrl=u;var dt=/file:\/\/\/[^:\/]+:\/[^\/]+\/[^\/]+\/AppData\//i,gt=["ms-appx:","ms-appx-web:","ms-browser-extension:",],ni="microsoft.microsoftedge_8wekyb3d8bbwe";n.isJunkUrl=ti;n.computeUrlMatchLengths=ii;n.isUncOrLocalPath=ei;n.startsWithProtocol=nt;n.isHttpProtocol=h;n.isNonHttpProtocol=oi;n.cleanAndFixUrlProtocol=si;n.parsedUrlToString=c;var tt=/^ht+ps:\/*(.*)/i,it=/^ht+p:\/*(.*)/i,rt=/^\/{2,}(.*)/,ut=/^www\.(.*)/i,ci=/^(.*[^:\/])\/+$/;n.normalizeUrl=i;n.hasWww=li;n.getProtocol=f;n.prettyPrintUrl=ai;n.isDuplicateUrl=yi;ft=["bing","staging-bing-int","working-bing-int","bing-int","bing-exp"];n.tryGetBingPath=et;n.isBingSearchUrl=pi;n.getDomain=wi;n.isEmptyUrlPrefix=bi;n.queryLooksLikeUrl=ki}(AutoSuggest||(AutoSuggest={})),function(n){var t,i;(function(n){function t(t,i,r,u,f,e){var o={T:n.QFPERFPING_EVENT_NAME,ST:r,CVID:u,OFFSETS:i,STATE:f,V:n.QFPERFPING_VERSION,RFC:e};return{ImpressionGuid:t,EventType:n.CLIENTINST_EVENT_TYPE,Data:o}}n.CLIENTINST_EVENT_TYPE="ClientInst";n.QFPERFPING_EVENT_NAME="QFPerfPing";n.CLICK_EVENT_TYPE="Click";n.QFPERFPING_VERSION="2";n.QFPERFPING_INVALID_MEASURE=-2;n.INVALID_SEQUENCE_NUMBER=-2;n.KVALUE_SUGGESTIONS_START=1e3;n.KVALUE_SUFFIX_START=1;n.KVALUE_NON_SUGGESTIONS_START=100;n.DEFAULT_APP_NAMESPACE="SmartSearch";n.DEFAULT_SERVICE_NAME="AutoSuggest";n.createPerfPingEvent=t})(t=n.InstrumentationCommon||(n.InstrumentationCommon={}));i=function(){function n(n,t){this._kValue=n;this._handOffType=t}return n.createInstrumentedItem=function(t){return new n(n.generateKValue(t))},n.getNonSuggestionInstrumentedItem=function(t,i,r){return new n(i[t],r)},n.prototype.getKValue=function(){return this._kValue},n.prototype.getAppNS=function(){return n.AppNS},n.prototype.getLayoutKValue=function(){return this._kValue+"."+n.Suffix},n.prototype.getHValue=function(){return"ID="+n.AppNS+","+this.getLayoutKValue()},n.prototype.getHandoffType=function(){return this._handOffType},n.resetKValues=function(n){delete this._keystrokesKValues[n]},n.generateKValue=function(n){var r=n,i=this._keystrokesKValues[r];return i>0||(i=t.KVALUE_SUGGESTIONS_START),this._keystrokesKValues[r]=++i,i},n.AppNS=t.DEFAULT_APP_NAMESPACE,n.Suffix=t.KVALUE_SUFFIX_START,n._keystrokesKValues={},n}();n.InstrumentedItem=i}(AutoSuggest||(AutoSuggest={})),function(n){function st(){return matchMedia("screen and (-ms-high-contrast)").matches}function ht(){return navigator.onLine}function ct(n){return!n.isAnswer&&(n.handoffType==0||n.handoffType==11)}function c(n){return n?n.replace(it,"$1").replace(rt,"$1 "):n}function lt(n){return n?n.replace(/[-{}]/g,"").toLowerCase():null}function at(n){return!n||Object.keys(n).length===0}function l(n,t,i,r){var f,e;n&&(n=n.slice(0,t)+u+n.slice(t,n.length));f=i(n);f&&(e=f.indexOf(u),t=e!=-1?e:t,f=f.replace(u,""));r(f,t)}function vt(n){if(!n)return SharedLogHelper.LogError("getInputType",null,new Error("event object is missing")),0;switch(n.pointerType){case"mouse":return 2;case"touch":return 3;case"pen":return 4;default:return 1}}function e(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];i.forEach(function(t){return delete n.enabledDataSources[t]})}function yt(t,i,u){return t.queryToFetch&&(t.queryToFetch.length<u.minQueryLengthForWebProvider||u.bingDisabledCountriesList.length>0&&r(u.bingDisabledCountriesList,i.toLowerCase()))?(e(t,n.WebDataSource),!0):!1}function a(t){if(t){t=n.normalizeUrl(t,15);for(var i=1;i<t.length-1;++i)if(ft.includes(t[i]))return!0}return!1}function pt(n,t,i){var r,u;return l(n,t,function(n){return c(n)},function(n,t){r=n;u=t}),r&&(r=r.trim(),u=Math.min(u,r.length)),{originalQuery:n,originalCursorPosition:t,queryToFetch:r,cursorPosition:u,enabledDataSources:{},equals:function(n){return(r?r.toLowerCase():r)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)&&i==n.topHitRestriction},isMultiWord:a(r),getCacheKey:function(){return r},topHitRestriction:i}}function v(n,t,i){return t&&!t.enabledDataSources[n]?!1:r(i.enabledDataSources,n)}function y(n,t,i,u,f){var e=u.enabledDataSources[n];return e?e.suggestionIsEnabled&&!e.suggestionIsEnabled(t,i)?!1:r(f.enabledDataSources,n):!1}function r(n,t){return n.indexOf(t)!=-1}function wt(n,t){var i=n.indexOf(t);return i!=-1?(n.splice(i,1),!0):!1}function bt(n,t){var i=n.findIndex(t);return i!=-1?n.splice(i,1)[0]:null}function kt(n,t){return n.filter(function(n){return!r(t,n)})}function dt(n,t){if(n.length!=t.length)return!1;for(var i=0;i<n.length;++i)if(n[i]!=t[i])return!1;return!0}function gt(n,t){if(n===t)return!0;if(!n||!t||Object.keys(n).length!=Object.keys(t).length)return!1;for(var i in n)if(n[i]!=t[i])return!1;return!0}function p(){return n.getCurrentDate().getTime()}function i(n){var t=Math.abs(Math.floor(n));return(t<10?"0":"")+t}function ni(){var t=n.getCurrentDate(),r=-t.getTimezoneOffset(),u=r>=0?"+":"-";return t.getFullYear()+"-"+i(t.getMonth()+1)+"-"+i(t.getDate())+"T"+i(t.getHours())+":"+i(t.getMinutes())+":"+i(t.getSeconds())+"."+i(t.getMilliseconds())+u+i(r/60)+":"+i(r%60)}function ti(n,t){return n?n.replace(ut,function(n,i){return t[i]}):n}function ii(n){var t=n?n.number:null,i=n?n.name:null;return t==-2147023673||i=="Canceled"}function f(n,t,i,r,u,f){try{return n()}catch(e){return f||SharedLogHelper.LogError(t,r,e),u&&u(),i}}function ri(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];f(function(){return sj_evt.fire.apply(sj_evt,[n].concat(i))},n)}function o(n,t){var i=[],r=!0,u=function(){for(var u=[],n=0;n<arguments.length;n++)u[n]=arguments[n];r?i.push(u):t.apply(null,u)};n(u);r=!1;i.forEach(function(n){return t.apply(null,n)})}function ui(n){return r(s,n)}function fi(n){return r(w,n)}function ei(n,t,i){return i?n==93:n==121&&t}function oi(n,t){return n==8||n==46||n==88&&t.ctrlKey}function si(){return _w.location.protocol}function hi(){return _w.location.host}function ci(){return _w.innerWidth}function li(){return _d.activeElement}function b(t){return t&&+t!=n.WindowsApiDefaultDate&&!isNaN(t.getTime())&&t.getFullYear()!=1600}function d(n){return b(n)?Math.abs(p()-n.getTime())/k:null}function ai(n){return d(n)>14}function vi(n){return encodeURIComponent(n).replace(/[!'()*]/g,escape).replace(/%20/g,"+")}var u=String.fromCharCode(57346),it=new RegExp("^\\s*("+u+")?\\s*"),rt=new RegExp("\\s*("+u+")?\\s+","g"),ut=/{([0-9]+)}/g,ft=" -_/\\",et=-2147215328,ot=-2147023673,t,s,w,k,h,g,nt,tt;SharedLogHelper.RegisterErrorFilter(function(n){var t=n?n.number:null,i=n?n.name:null;return t===ot||t===et||i==="Canceled"});n.isHighContrastEnabled=st;n.isBrowserOnline=ht;n.isWebSuggestion=ct;n.cleanQuery=c;n.cleanGuid=lt;n.isEmpty=at;n.mantainCursorPositionIn=l;n.getInputType=vt;n.disableDataSources=e;n.disableWebDataSourceIfNeeded=yt;n.isMultiWord=a;n.parseQuery=pt;n.isDataSourceEnabled=v;n.isSuggestionTypeEnabled=y;n.contains=r;n.tryRemove=wt;n.removeFirstWhere=bt;n.except=kt;n.sequenceEqual=dt;n.objEquals=gt;n.log=function(){};n.getCurrentDate=function(){return new Date};sa_config.th&&(n.log=function(n,t){return ClientTestHooks.ClientLog("- "+n,t)},t=ClientTestHooks.getUrlValue("currentdate",null),t&&(t.includes("-")||t.length!=8||(t=t.substr(0,4)+"-"+t.substr(4,2)+"-"+t.substr(6,2)),n.getCurrentDate=function(){return new Date(t)}));n.getCurrentTime=p;n.getDateWithTimezone=ni;n.fetchWrapper=function(n,t,i){return i()};n.formatString=ti;n.isCancellation=ii;n.safeExecute=f;n.safeFireEvent=ri;n.ensureCallbackIsAsync=o;n.WebDataSource="Web";n.MRUDataSource="MRU";n.DataSourceStateFor200Response=null;n.isBingEnabledCache=!0;s=[38,40,];w=s.concat(37,39,36,35);n.isUpOrDownKey=ui;n.isMovingCursorKey=fi;n.isContextMenuKey=ei;n.isDeletionKey=oi;n.getWindowProtocol=si;n.getWindowHost=hi;n.getWindowWidth=ci;n.getCurrentActiveElement=li;n.WindowsApiDefaultDate=-116444736e5;n.isValidDate=b;k=864e5;n.getTimeDiffInDays=d;n.olderThan2Weeks=ai;h=function(){function n(){this._cancellations={};this._lastId=0}return n.prototype.register=function(n,t){var i=++this._lastId;return this._cancellations[i]={action:n,skipOnDismissAndLaunch:t},i},n.prototype.unregister=function(n){delete this._cancellations[n]},n.prototype.cancelAll=function(n){var i,t;for(i in this._cancellations)t=this._cancellations[i],t.skipOnDismissAndLaunch&&n||t.action();this._cancellations={}},n}();n.CancellationManager=h;g=function(){function n(){}return n.prototype.getItem=function(n){try{return _w.localStorage.getItem(n)}catch(t){return SharedLogHelper.LogError("localStorage",t,new Error("getItem")),undefined}},n.prototype.setItem=function(n,t){try{_w.localStorage.setItem(n,t)}catch(i){SharedLogHelper.LogError("localStorage",i,new Error("setItem"))}},n.prototype.removeItem=function(n){try{return _w.localStorage.removeItem(n)}catch(t){SharedLogHelper.LogError("localStorage",t,new Error("removeItem"))}},n}();n.LightweightStorage=g;nt=function(){function n(){this._sequenceNumber=0}return n.prototype.getSequenceNumber=function(){return this._sequenceNumber},n.prototype.incrementSequenceNumber=function(){this._sequenceNumber++},n}();n.SequenceNumberManager=nt;tt=function(){function t(n,t,i,r,u,f,e,o,s){var c=this;this._config=n;this._host=t;this._suggestionsParsers=i;this._rootViewModel=r;this._suggestionsRenderingManager=u;this._webProviders=f;this._otherProviders=e;this._instrumentationHelper=o;this._sequenceNumberManager=s;n.cancellationEnabled&&(this._cancellationManager=new h);t.bindShown(function(){c._lastQuery=null;c._currentQuery=null;c._isPaneDismissed=!1});t.bindDismissed(function(){c.stopFurtherProcessing(!0);c.finalizeKeystroke(!0);c._isPaneDismissed=!0});t.bindQueryChangedOrInitialized(function(n,t){return c.onQueryChanged(n,c._config.d,t)});t.bindOnSubmit(function(n,t,i){return c.onSubmit(n,t,i)});t.initializeEvents();sj_be(_d.body,"dragstart",function(n){return n.preventDefault(),n.stopPropagation(),!1});sj_b.addEventListener("click",function(n){n.shiftKey&&sj_pd(n)})}return t.prototype.clearFetchTimer=function(){this._fetchTimer&&(sb_ct(this._fetchTimer),this._fetchTimer=null)},t.prototype.finishPreviousQuery=function(n){this.cancelPreviousQuery(n);this._suggestionsRenderingManager.resetTimers()},t.prototype.finalizeKeystroke=function(n){var t=this._sequenceNumberManager.getSequenceNumber();t>0&&this._instrumentationHelper.finalizeKeystrokeLog(t);n||this._sequenceNumberManager.incrementSequenceNumber()},t.prototype.onQueryChanged=function(n,t,i){var r=this,u;this.clearFetchTimer();this._stopFurtherProcessing=!1;this._currentQuery=n;this._lastQuery&&(!this._lastQuery.equals(this._currentQuery)||i)&&this.cancelPreviousQuery(!1);t<=0?this.fetchForQueryChange(0,!1,i):(u=Date.now(),this._fetchTimer=sb_st(function(){r._fetchTimer=null;f(function(){return r.fetchForQueryChange(Date.now()-u,!1,i)},"fetchTimer")},t))},t.prototype.onSubmit=function(n,t,i){var r=this;this._fetchTimer&&(this._currentQuery||(this._currentQuery=this._host.getQuery()),this.fetchForQueryChange(0,!0,!1));this._rootViewModel.submit(n,t,this._sequenceNumberManager.getSequenceNumber(),function(){return r.stopFurtherProcessing(!0)},i,this._isPaneDismissed)},t.prototype.cancelPreviousQuery=function(n){this._cancellationManager&&this._cancellationManager.cancelAll(n)},t.prototype.stopFurtherProcessing=function(n){this.clearFetchTimer();this.finishPreviousQuery(n);this._stopFurtherProcessing=!0},t.prototype.fetchForQueryChange=function(t,i,r){var u=this,e,f,h;if(this.clearFetchTimer(),this._lastQuery&&this._lastQuery.equals(this._currentQuery)&&!r)this._rootViewModel.onQueryChanged(this._currentQuery,this._sequenceNumberManager.getSequenceNumber());else if(e=this._host.getQuery(),e.equals(this._currentQuery)){if(this.finishPreviousQuery(i),this.finalizeKeystroke(!1),this._lastQuery=this._currentQuery,f=this._sequenceNumberManager.getSequenceNumber(),this._instrumentationHelper.instrumentBeginRequest(f,this._currentQuery,t),h=!this._config.enabledDataSources.some(function(n){return v(n,u._currentQuery,u._config)}),h)this._rootViewModel.onQueryChanged(this._currentQuery,f);if(this._suggestionsRenderingManager.initiateSequenceNumber(f,this._currentQuery),!h){var s=function(){return!u._stopFurtherProcessing&&(u._config.d>0?e.equals(u._currentQuery):f==u._sequenceNumberManager.getSequenceNumber())},c=function(n,t,i,r){return u.onResponseReceived(e,f,n,t,i,s,r)},l=function(t){n.fetchWrapper(e,s,function(){u._webProviders.forEach(function(n){return u.fetchWeb(e,n,f,t,s)});u._otherProviders.forEach(function(n){return u.fetch(e,n,f,t,s)})});u._rootViewModel.onQueryChanged(u._currentQuery,f)};o(l,c)}}},t.prototype.fetchWeb=function(t,i,r,u,e){var c=this,s=n.Service.QueryParams,o=this._host.getCustomUrlParameters(t),h;this._host.shouldRequestEltoken()&&(o[s.RequestElToken]="1");o[s.CursorPosition]=t.cursorPosition.toString();o[s.ConversationId]=this._host.getConversationId();o[s.ImpressionGuid]=this._instrumentationHelper.getImpressionGuid(r);h=this._host.getCustomHeaders();f(function(){return i.fetch(t,u,r,c._cancellationManager,e,o,h)},"fetch "+i.getName())},t.prototype.fetch=function(n,t,i,r,u){var e=this;f(function(){return t.fetch(n,r,i,e._cancellationManager,u)},"fetch "+t.getName())},t.prototype.onResponseReceived=function(n,t,i,r,u,f,e){var s=this,h,c;f()&&(this._instrumentationHelper.instrumentResponseReceived(t,i,u,e),h=function(i,r,f){return s.onSuggestionsParsed(n,t,i,u,r,f)},c=function(u){var e=s._suggestionsParsers[i];e?e.parse(n,t,i,r,f,u,s._cancellationManager):(SharedLogHelper.LogError("onResponseReceived",null,new Error("No parser for data source "+i)),u(i,[],null))},o(c,h))},t.prototype.onSuggestionsParsed=function(n,t,i,r,u,f){var e=this;u=u.filter(function(t){return y(i,t.type,t.handoffType,n,e._config)});this._instrumentationHelper.instrumentDataSource(t,i,u,f);this._rootViewModel.onSuggestionsParsed(n,t,i,r,u);this._suggestionsRenderingManager.queueSuggestions(t,i,u,f)},t}();n.Core=tt;n.encodeQueryParameter=vi}(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(t){function st(t){return n.contains(ut,t)}function ht(t){return n.contains(ft,t)}function ct(t){return n.contains(w,t)}function lt(t){return n.contains(et,t)}function at(t){return n.contains(ot,t)}function s(n,i,r){return{dataSource:i,requirementLevel:function(){return n.cortanaCapabilitiesAvailable&&!n.substrateContentForWindowsAccount?f.CortanaPersonalized:f.Bing},conditionalRequirements:function(){return t.isCloudSearchEnabledCache?n.substrateContentForWindowsAccount?t.windowsAccountType==2:t.isMainAccountMSA:!1},suggestionIsEnabled:r?function(n){return n==r}:undefined}}function l(n,i){if(!t.isCloudSearchEnabledCache)return!1;if(i.substrateContentForWindowsAccount)return t.windowsAccountType==n;if(n==2){if(t.isMainAccountAAD||t.isSubstrateO365AccountConnected)return!1}else if(!t.isSubstrateO365AccountConnected&&t.isSubstrateOutlookAccountConnected&&!t.isMainAccountAAD)return!1;return!0}function k(n){return n==1?t.isSubstrateO365AccountConnected:t.isSubstrateOutlookAccountConnected}function e(n,t,i,r){return{dataSource:t,requirementLevel:function(){return n.substrateContentForWindowsAccount?f.None:f.CortanaPersonalized},conditionalRequirements:function(){return r&&l(i,n)&&k(i)}}}function d(n,i){return i?!l(2,n)&&!l(1,n)?!1:n.substrateContentForWindowsAccount?!k(t.windowsAccountType):t.isCortanaEnabledCache?!t.isSubstrateO365AccountConnected&&(!t.isSubstrateOutlookAccountConnected||t.isMainAccountAAD)||!t.isCortanaPersonalized:!1:!1}function yt(e,o){t.ScopeConfig[u.All].enabledDataSourcesForZeroInput=o?[{dataSource:n.MRUDataSource},{dataSource:i.MRUApps},{dataSource:i.MRUSettings},{dataSource:i.MRUFilesAndFolders},n.contains(e.enabledDataSources,i.LocalRecentApps)?{dataSource:i.LocalRecentApps}:{dataSource:i.LocalApps,suggestionIsEnabled:function(n){return n==r.App}},{dataSource:i.LocalDocumentsAndFolders},{dataSource:i.LocalMedia},{dataSource:n.WebDataSource,requirementLevel:function(){return f.Bing}},h,]:[]}function g(c){t.ScopeConfig={};t.ScopeConfig[u.All]={icon:{content:o.WindowsLogo,type:2,needsAccentColor:!0},prefixesLocString:"ScopeAll",enabledDataSources:[{dataSource:i.LocalApps},{dataSource:i.LocalSettings},{dataSource:i.LocalDocumentsAndFolders},{dataSource:i.LocalMedia},{dataSource:i.CommandLine},{dataSource:i.PowerBi,requirementLevel:function(){return f.Cortana},conditionalRequirements:function(n){return n&&n.length>=6&&n.trim().includes(" ")}},{dataSource:n.MRUDataSource},{dataSource:i.MRUApps},{dataSource:i.MRUSettings},{dataSource:i.MRUFilesAndFolders},{dataSource:n.WebDataSource,requirementLevel:function(){return f.Bing}},{dataSource:i.BingApps,requirementLevel:function(){return f.Bing}},{dataSource:i.BingSettings,requirementLevel:function(){return f.Bing}},h,s(c,i.OneDrive),e(c,i.SubstrateSuggestionsEnterprise,1,c.substrateBookmarksEnabled||c.substrateDocumentsEnabled||c.substratePeopleEnabled),e(c,i.SubstrateSuggestionsConsumer,2,c.substratePeopleEnabled),{dataSource:i.IndexerBasedApps},],enabledDataSourcesForZeroInput:[]};c.substrateEmailSearchOnL1?(t.ScopeConfig[u.All].enabledDataSources.push(e(c,i.SubstrateSearchConsumer,2,c.substrateEmailsEnabled)),t.ScopeConfig[u.All].enabledDataSources.push(e(c,i.SubstrateSearchEnterprise,1,c.substrateEmailsEnabled))):c.substrateDocumentsSearchOnL1&&t.ScopeConfig[u.All].enabledDataSources.push(e(c,i.SubstrateSearchEnterprise,1,c.substrateDocumentsEnabled));t.ScopeConfig[u.Apps]={icon:{content:o.GenericApp,type:2},prefixesLocString:"ScopeApps",enabledDataSources:[{dataSource:n.WebDataSource,suggestionIsEnabled:function(){return!1},requirementLevel:function(){return f.Bing}},{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUApps},{dataSource:i.LocalApps,suggestionIsEnabled:function(n){return n==r.App}},{dataSource:i.BingApps,requirementLevel:function(){return f.Bing}},{dataSource:i.IndexerBasedApps},],enabledDataSourcesForZeroInput:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUApps},n.contains(c.enabledDataSources,i.LocalRecentApps)?{dataSource:i.LocalRecentApps}:{dataSource:i.LocalApps,suggestionIsEnabled:function(n){return n==r.App}}]};t.ScopeConfig[u.Settings]={icon:{content:o.Settings,type:2},prefixesLocString:"ScopeSettings",enabledDataSources:[{dataSource:n.WebDataSource,suggestionIsEnabled:function(){return!1},requirementLevel:function(){return f.Bing}},{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUSettings},{dataSource:i.LocalSettings},{dataSource:i.BingSettings,requirementLevel:function(){return f.Bing}}],enabledDataSourcesForZeroInput:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUSettings},]};t.ScopeConfig[u.Photos]={icon:{content:o.Photo2,type:2},prefixesLocString:"ScopePhotos",enabledDataSources:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Photo}},{dataSource:i.LocalMedia,suggestionIsEnabled:function(n){return n==r.Photo}},s(c,i.OneDrive,r.Photo),s(c,i.MyStuffOneDrive,r.Photo),{dataSource:i.MyStuffPhotos,suggestionIsEnabled:function(n){return n==r.Photo}},],enabledDataSourcesForZeroInput:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Photo}},{dataSource:i.LocalMedia,suggestionIsEnabled:function(n){return n==r.Photo}},]};t.ScopeConfig[u.Videos]={icon:{content:v.Video,type:1},prefixesLocString:"ScopeVideos",enabledDataSources:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Video}},{dataSource:i.LocalMedia,suggestionIsEnabled:function(n){return n==r.Video}},s(c,i.OneDrive,r.Video),s(c,i.MyStuffOneDrive,r.Video),{dataSource:i.MyStuffVideos,suggestionIsEnabled:function(n){return n==r.Video}},],enabledDataSourcesForZeroInput:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Video}},{dataSource:i.LocalMedia,suggestionIsEnabled:function(n){return n==r.Video}},]};t.ScopeConfig[u.Music]={icon:{content:o.Audio,type:2},prefixesLocString:"ScopeMusic",enabledDataSources:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Music}},{dataSource:i.LocalMedia,suggestionIsEnabled:function(n){return n==r.Music}},s(c,i.OneDrive,r.Music),s(c,i.MyStuffOneDrive,r.Music),{dataSource:i.MyStuffMusic,suggestionIsEnabled:function(n){return n==r.Music}},],enabledDataSourcesForZeroInput:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Music}},{dataSource:i.LocalMedia,suggestionIsEnabled:function(n){return n==r.Music}},]};t.ScopeConfig[u.Documents]={icon:{content:o.Page,type:2},prefixesLocString:"ScopeDocuments",enabledDataSources:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Document}},{dataSource:i.MyStuffPhotos,suggestionIsEnabled:function(n){return n==r.Document}},{dataSource:i.MyStuffVideos,suggestionIsEnabled:function(n){return n==r.Document}},{dataSource:i.LocalDocumentsAndFolders,suggestionIsEnabled:function(n){return n==r.Document}},{dataSource:i.LocalMedia,suggestionIsEnabled:function(n){return n==r.Document}},s(c,i.OneDrive,r.Document),s(c,i.MyStuffOneDrive,r.Document),{dataSource:i.LocalApps,suggestionIsEnabled:function(n){return n==r.StartMenuDocument}},{dataSource:i.MyStuffDocuments,suggestionIsEnabled:function(n){return n==r.Document}},e(c,i.SubstrateSuggestionsEnterprise,1,c.substrateDocumentsEnabled),e(c,i.SubstrateSearchEnterprise,1,c.substrateDocumentsEnabled),],enabledDataSourcesForZeroInput:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Document}},{dataSource:i.LocalDocumentsAndFolders,suggestionIsEnabled:function(n){return n==r.Document}},{dataSource:i.LocalMedia,suggestionIsEnabled:function(n){return n==r.Document}}]};t.ScopeConfig[u.Folders]={icon:{content:o.FolderOpen,type:2},prefixesLocString:"ScopeFolders",enabledDataSources:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Folder}},{dataSource:i.LocalDocumentsAndFolders,suggestionIsEnabled:function(n){return n==r.Folder}},s(c,i.OneDrive,r.Folder),s(c,i.MyStuffOneDrive,r.Folder),{dataSource:i.MyStuffFolders,suggestionIsEnabled:function(n){return n==r.Folder}},],enabledDataSourcesForZeroInput:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(){return!1}},{dataSource:i.MRUFilesAndFolders,suggestionIsEnabled:function(n){return n==r.Folder}},{dataSource:i.LocalDocumentsAndFolders,suggestionIsEnabled:function(n){return n==r.Folder}},]};t.ScopeConfig[u.Web]={icon:{content:v.Globe,type:1},prefixesLocString:"ScopeWeb",enabledDataSources:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(n,t){return t==1}},{dataSource:n.WebDataSource,suggestionIsEnabled:function(t,i){return n.contains([0,9,10,5,1],i)},requirementLevel:function(){return f.Bing}},{dataSource:i.LocalApps,suggestionIsEnabled:function(n,t){return t==1}},h,e(c,i.SubstrateSuggestionsEnterprise,1,c.substrateBookmarksEnabled),],enabledDataSourcesForZeroInput:[{dataSource:n.MRUDataSource,suggestionIsEnabled:function(n,t){return t==1}},{dataSource:n.WebDataSource,suggestionIsEnabled:function(t,i){return n.contains([0,9,10,1],i)},requirementLevel:function(){return f.Bing}},h,]};t.ScopeConfig[u.PathCompletion]={icon:{content:o.WindowsLogo,type:2,needsAccentColor:!0},prefixesLocString:"",enabledDataSources:[{dataSource:i.PathCompletion},{dataSource:i.CommandLine},],enabledDataSourcesForZeroInput:[]};t.ScopeConfig[u.Emails]={icon:{content:o.Mail,type:2},prefixesLocString:"ScopeEmails",enabledDataSources:[e(c,i.SubstrateSearchEnterprise,1,c.substrateEmailsEnabled),e(c,i.SubstrateSearchConsumer,2,c.substrateEmailsEnabled),],enabledDataSourcesForZeroInput:[],showUpsellOnSuggestionsList:function(){return d(c,c.substrateEmailsEnabled)}};t.ScopeConfig[u.People]={icon:{content:o.People,type:2},prefixesLocString:"ScopePeople",enabledDataSources:[e(c,i.SubstrateSuggestionsEnterprise,1,c.substratePeopleEnabled),e(c,i.SubstrateSuggestionsConsumer,2,c.substratePeopleEnabled),],enabledDataSourcesForZeroInput:[],showUpsellOnSuggestionsList:function(){return d(c,c.substratePeopleEnabled)}};for(var l in t.ScopeConfig)t.ScopeConfig[l].enabledDataSources=t.ScopeConfig[l].enabledDataSources.filter(function(t){return n.contains(c.enabledDataSources,t.dataSource)}),t.ScopeConfig[l].enabledDataSourcesForZeroInput=t.ScopeConfig[l].enabledDataSourcesForZeroInput.filter(function(t){return n.contains(c.enabledDataSources,t.dataSource)})}function pt(){c=null}function wt(n,i,r){var f,e;if(c={},n.scopesOrder.length!=0){f=function(f){var e=parseInt(f),o=t.ScopeConfig[e],s,h;e!=u.All&&o.prefixesLocString&&y(e,o,n)&&(s=i(o.prefixesLocString)+","+r(o.prefixesLocString),h=HitHighlightingParser.removeDiacritics(s.toLocaleLowerCase()).split(","),h.forEach(function(n){return c[n.trim()]=e}))};for(e in t.ScopeConfig)f(e)}}function bt(n,t){return n.prefixesLocString?t.getLocString(n.prefixesLocString).split(",")[0].trim():""}function y(t,r,f){var e,h,o,s,c;if(r.showUpsellOnSuggestionsList&&r.showUpsellOnSuggestionsList())return!0;for(e=f.enabledDataSources.filter(function(t){return t!=n.MRUDataSource}),n.isBingEnabledCache&&t!=u.Web&&(e=e.filter(function(t){return t!=n.WebDataSource})),t==u.Web&&(e=e.filter(function(n){return n!=i.LocalApps&&n!=i.EdgeBrowsingHistory&&n!=i.SubstrateSuggestionsEnterprise})),h=function(n){p(n,null)||(e=e.filter(function(t){return t!=n.dataSource}))},o=0,s=r.enabledDataSources;o<s.length;o++)c=s[o],h(c);return r.enabledDataSources.some(function(t){return n.contains(e,t.dataSource)})?!0:!1}function kt(i,r,f,e,o,s,h){var c=n.parseQuery(i,r,s),l,a,w,v,p,y;if(c.forceGroupOnTop=h,c.fullPartialQuery=c.queryToFetch,c.scope=u.All,l=ri(f,c,o),l)c.isFormulatedQuery=!0;else for(c.fullPartialQuery&&(dt(c,f),e&&c.scope!=e.scope&&(c.isFormulatedQuery=!0)),(c.scope==u.All||c.scope==u.Web)&&(a=n.tryParseUrl(c.queryToFetch,!0),a&&a.type==0?(c.isProtocol=!0,c.fixedUrl=n.cleanAndFixUrlProtocol(a)):nt.test(c.queryToFetch)&&(c.isProtocol=!0,c.fixedUrl=n.cleanAndFixUrlProtocol(c.queryToFetch))),l=t.ScopeConfig[c.scope],w=c.queryToFetch?l.enabledDataSources:l.enabledDataSourcesForZeroInput,v=0,p=w;v<p.length;v++)y=p[v],n.contains(f.enabledDataSources,y.dataSource)&&(c.enabledDataSources[y.dataSource]=y);return gt(c,f),c.showProgressBar=t.isL2(c)&&f.dataSourcesWithProgressBar.some(function(n){return!!c.enabledDataSources[n]}),c.equals=function(n){return(c.queryToFetch?c.queryToFetch.toLowerCase():c.queryToFetch)==(n.queryToFetch?n.queryToFetch.toLowerCase():n.queryToFetch)&&n.scope==c.scope&&(n.taskFrame?n.taskFrame.raw:"")==(c.taskFrame?n.taskFrame.raw:"")&&n.topHitRestriction==c.topHitRestriction},c.getCacheKey=function(){return c.cursorPosition+c.queryToFetch.toLocaleLowerCase()+c.scope+t.regionCache},c}function dt(t,i){var o=n.isDataSourceEnabled(r.PathCompletion,null,i)?tt.test(t.fullPartialQuery):!1,e,f;if(o){t.scope=u.PathCompletion;return}for(e in c)if(HitHighlightingParser.removeDiacritics(t.fullPartialQuery.toLocaleLowerCase()).replace(/\s+:/,":").startsWith(e+":")){f=t.originalQuery.indexOf(":");t.queryToFetch=t.originalQuery.substr(f+1);t.cursorPosition=Math.max(0,t.originalCursorPosition-f-1);n.mantainCursorPositionIn(t.queryToFetch,t.cursorPosition,n.cleanQuery,function(n,i){t.queryToFetch=n;t.cursorPosition=i});t.scope=c[e];t.scopePrefix=t.originalQuery.substr(0,f);t.isMultiWord=n.isMultiWord(t.queryToFetch);break}}function p(i,r){var u=i.requirementLevel?i.requirementLevel():f.None,e;return(i.requiredCortanaCapabilities&&i.requiredCortanaCapabilities().length>0&&u<f.CortanaPersonalized&&(u=f.CortanaPersonalized),!t.isCortanaPersonalized&&u>=f.CortanaPersonalized)?!1:!t.isCortanaEnabledCache&&u>=f.Cortana?!1:!n.isBingEnabledCache&&u>=f.Bing?!1:i.requiredCortanaCapabilities&&!i.requiredCortanaCapabilities().every(function(i){return n.contains(t.availableCortanaCapabilities,i)})?!1:(e=r?r.queryToFetch:"",i.conditionalRequirements&&!i.conditionalRequirements(e))?!1:!0}function gt(r,u){var c,f,o,s,e,h;for(n.disableWebDataSourceIfNeeded(r,t.regionCache,u),c=r.queryToFetch?t.ScopeConfig[r.scope].enabledDataSources:t.ScopeConfig[r.scope].enabledDataSourcesForZeroInput,f=0,o=c;f<o.length;f++)s=o[f],p(s,r)||n.disableDataSources(r,s.dataSource);r.queryToFetch||(e=!0,u.mruCandidatesEnabled?(h=SearchAppWrapper.CortanaApp.queryFormulationView.searchHistory,h&&h.isDeviceHistoryEnabled||(e=!1)):e=!1,e||n.disableDataSources(r,i.LocalApps,i.LocalRecentApps,i.LocalDocumentsAndFolders,i.LocalMedia))}function ri(i,r,f){var e=it(f,u.All),l,h,s,c,o;if(e!=u.All&&(l=t.ScopeConfig[e],y(e,t.ScopeConfig[e],i)&&(h=t.ScopeConfig[e].enabledDataSources.filter(function(n){return ui(n.dataSource)}),h.length>0))){for(r.taskFrame=f,s=0,c=h;s<c.length;s++)o=c[s],n.contains(i.enabledDataSources,o.dataSource)&&p(o,null)&&(r.enabledDataSources[o.dataSource]=o);return l}return null}function it(n,t){var r,i;if(n){r=n.parsed;switch(r.Uri){case ni:if(i=r.FileType,i&&i.Value){if(i.Value=="Picture")return u.Photos;if(i.Value=="Video")return u.Videos}return u.Documents;case ti:case ii:return u.Emails}}return t}function ui(n){switch(n){case i.MyStuffDocuments:case i.MyStuffPhotos:case i.MyStuffVideos:case i.MyStuffMusic:case i.MyStuffFolders:case i.MyStuffOneDrive:case i.SubstrateSearchConsumer:case i.SubstrateSearchEnterprise:return!0;default:return!1}}var u,i,a,r,v,rt,o,f,b,vt,h,c,nt,tt;(function(n){n[n.All=0]="All";n[n.Apps=1]="Apps";n[n.Settings=2]="Settings";n[n.Photos=3]="Photos";n[n.Videos=4]="Videos";n[n.Music=5]="Music";n[n.Documents=6]="Documents";n[n.Files=7]="Files";n[n.Folders=8]="Folders";n[n.Web=9]="Web";n[n.PathCompletion=10]="PathCompletion";n[n.Emails=11]="Emails";n[n.People=13]="People"})(u=t.Scope||(t.Scope={})),function(n){n.BingApps="OSTMA";n.BingSettings="QS";n.LocalApps="PP";n.LocalRecentApps="LRA";n.IndexerBasedApps="IBA";n.LocalSettings="ST";n.LocalDocumentsAndFolders="FL";n.LocalMedia="LM";n.CommandLine="CG";n.PathCompletion="PT";n.PowerBi="PBI";n.EdgeBrowsingHistory="EBH";n.MRUApps="MPP";n.MRUSettings="MST";n.MRUFilesAndFolders="MFF";n.OneDrive="ODC";n.MyStuffOneDrive="MODC";n.MyStuffDocuments="MDOC";n.MyStuffFolders="MFOL";n.MyStuffPhotos="MPHO";n.MyStuffVideos="MVID";n.MyStuffMusic="MMUS";n.SubstrateSuggestionsEnterprise="SSUE";n.SubstrateSuggestionsConsumer="SSUC";n.SubstrateSearchEnterprise="SSEE";n.SubstrateSearchConsumer="SSEC"}(i=t.DataSources||(t.DataSources={})),function(n){n.Store="CS";n.SpellCorrectedApp="QP";n.SpellCorrectedSetting="QS";n.DirectNav="MD";n.Deeplink="ML";n.SearchHistory="HS";n.Person="PPL";n.PersonEmail="PPLE";n.PersonMessage="PPLM";n.Email="OLE";n.Local="ELA";n.Bookmark="SBKS";n.Entity="MB"}(a=t.OnlineSuggestionTypes||(t.OnlineSuggestionTypes={})),function(n){n.App="PP";n.Setting="ST";n.Music="MU";n.Photo="LI";n.Video="LV";n.Document="FL";n.Folder="FD";n.PathCompletion="PT";n.CommandLine="CG";n.PowerBi="PBI";n.BrowsingHistory="EBH";n.JumpListItem="JL";n.VCDExample="VCDE";n.StartMenuUrl="LURL";n.StartMenuDocument="LDOC"}(r=t.LocalSuggestionTypes||(t.LocalSuggestionTypes={})),function(n){n.Globe="&#xE774";n.Video="&#xE714";n.ViewAll="&#xE8A9";n.FileExplorer="&#xEC50"}(v=t.SegoeFontIcons||(t.SegoeFontIcons={})),function(n){n.Cancel="";n.Clear="";n.Filter="";n.ReturnKey=""}(rt=t.SegoeFontIconsUnencoded||(t.SegoeFontIconsUnencoded={})),function(n){n.ChevronDown="&#xE70D";n.Cancel="&#xE711";n.Settings="&#xE713";n.Mail="&#xE715";n.People="&#xE716";n.Search="&#xE721";n.Forward="&#xE72A";n.Back="&#xE72B";n.FavoriteStarFill="&#xE735";n.ChevronLeft="&#xE76B";n.ChevronRight="&#xE76C";n.Contact="&#xE77B";n.WindowsLogo="&#xE782";n.Page="&#xE7C3";n.HalfStarLeft="&#xE7C6";n.History="&#xE81C";n.Recent="&#xE823";n.Sync="&#xE895";n.Help="&#xE897";n.Message="&#xE8BD";n.Audio="&#xE8D6";n.Info="&#xE946";n.FolderOpen="&#xE838";n.StoreLogo="&#xEA96";n.GenericApp="&#xEB3B";n.DoubleBookmark="&#xEB8F";n.Photo2="&#xEB9F";n.PowerBILogo="&#xEA1E";n.RemindMe="&#xED48";n.BrowseCards="&#xED4A";n.PageList="&#xF106"}(o=t.CortanaFontIcons||(t.CortanaFontIcons={}));var ut=[r.App,a.SpellCorrectedApp],ft=[r.Setting,a.SpellCorrectedSetting],w=[r.Photo,r.Video,r.Music],et=[r.Document,r.StartMenuDocument,r.Folder].concat(w),ot=[u.Documents,u.Folders,u.Photos,u.Videos,u.Music];t.isApp=st;t.isSetting=ht;t.isMedia=ct;t.isFileOrFolder=lt;t.isFileOrFolderScope=at,function(n){n[n.None=0]="None";n[n.Bing=1]="Bing";n[n.Cortana=2]="Cortana";n[n.CortanaPersonalized=3]="CortanaPersonalized"}(f||(f={})),function(n){n.Personalization="Personalization";n.BrowsingHistory="BrowsingHistory"}(b=t.CortanaCapabilities||(t.CortanaCapabilities={})),function(n){n.Bookmarks="Bookmarks";n.Documents="Documents";n.People="People";n.EmailMessage="Message"}(vt=t.SubstrateDataTypes||(t.SubstrateDataTypes={}));t.substrateContentAllowed=l;h={dataSource:i.EdgeBrowsingHistory,requiredCortanaCapabilities:function(){return[b.BrowsingHistory]},conditionalRequirements:function(t){return!t||n.normalizeUrl(t,31).length>=3}};t.setZeroInputDataSourcesForL1=yt;t.populateScopeConfig=g,function(){var n=sa_config||{};n.enabledDataSources||(n.enabledDataSources=[]);g(n)}();t.cleanScopePrefixes=pt;t.scopeListRequiresUpdate=!1;t.initScopePrefixes=wt;t.getScopeDisplayName=bt;t.isScopeEnabled=y;t.isMobileCache=SearchAppWrapper.CortanaApp.isMobile||navigator.userAgent.toLowerCase().includes("xbox one")||navigator.userAgent.toLowerCase().includes("hololens");t.windowsAccountType=0;t.cortanaAccountType=0;nt=/^ht+ps?[;:]+|^www[.。]|^\/+/;tt=/^[a-z]:\\|^%[^%]+%\\|^\\/i;t.parseQuery=kt;var ni="action://FindMyStuff/FindDocument",ti="action://FindMyStuff/FindMessage",ii="action://FindMyStuff/FindAttachment";t.getScopeFromTaskFrame=it})(t=n.WSB||(n.WSB={}))}(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(t){function k(n,t){return n.type==t.type&&n.source==t.source}function nt(n){switch(n){case t.DataSources.LocalApps:return"Apps";case t.DataSources.LocalSettings:return"Settings";case t.DataSources.LocalDocumentsAndFolders:return"Files";case t.DataSources.LocalMedia:return"Media";default:return null}}function tt(n){switch(n){case t.DataSources.LocalMedia:case t.DataSources.LocalDocumentsAndFolders:case t.DataSources.MRUFilesAndFolders:case t.DataSources.PathCompletion:case t.DataSources.CommandLine:case t.DataSources.MyStuffDocuments:case t.DataSources.MyStuffFolders:case t.DataSources.MyStuffPhotos:case t.DataSources.MyStuffVideos:case t.DataSources.MyStuffMusic:case t.DataSources.EdgeBrowsingHistory:return!0;case t.DataSources.BingApps:case t.DataSources.BingSettings:case t.DataSources.LocalApps:case t.DataSources.LocalRecentApps:case t.DataSources.LocalSettings:case t.DataSources.PowerBi:case t.DataSources.MRUApps:case t.DataSources.MRUSettings:case t.DataSources.IndexerBasedApps:return!1}throw new Error("New local data source "+n+" needs to be explicity classified as potentially containing PII or not");}function it(n,t){var i=t?e(n):n.type;return n.deviceItem&&n.handoffType==2?i+"\t"+n.deviceItem.id:i+"\t"+n.query}function rt(n){var t=n.id;return t&&n.handoffType==2?n.type+"\t"+t:n.type+"\t"+n.query}function ut(n){switch(n){case t.DataSources.LocalDocumentsAndFolders:case t.DataSources.LocalMedia:case t.DataSources.MyStuffDocuments:case t.DataSources.MyStuffPhotos:case t.DataSources.MyStuffVideos:case t.DataSources.MyStuffMusic:case t.DataSources.MyStuffFolders:return!0;default:return!1}}function ft(n){return n&&(n.tagName.toLowerCase()=="body"||n.tagName.toLowerCase()=="iframe"||n.className&&n.classList.contains("suggestion"))}function et(n){return n.kind=="Modern Setting"}function ot(n){return t.isApp(n.type)?n.deviceItem:null}function st(n){return t.isFileOrFolder(n.type)?n.deviceItem:null}function c(n){switch(n){case t.LocalSuggestionTypes.PowerBi:case t.LocalSuggestionTypes.BrowsingHistory:return!1}return!0}function ht(n){return c(n.type)?n.deviceItem:null}function ct(n){return n.type==t.LocalSuggestionTypes.CommandLine?n.deviceItem:null}function lt(n){return n.type==t.LocalSuggestionTypes.PathCompletion?n.deviceItem:null}function at(n){return n.type==t.LocalSuggestionTypes.PowerBi?n.deviceItem:null}function vt(n){return n.type==t.LocalSuggestionTypes.BrowsingHistory?n.deviceItem:null}function yt(n){return n&&n.classList.contains(t.CssClass_ScopeTile)}function e(n){if(t.isApp(n.type))return i.Apps;var u=s(n);if(u)return u.groupType;if(t.isSetting(n.type))return i.Settings;switch(n.type){case t.LocalSuggestionTypes.CommandLine:return i.Command;case t.LocalSuggestionTypes.PathCompletion:return i.PathCompletion;case t.LocalSuggestionTypes.Photo:return i.Photos;case t.LocalSuggestionTypes.Video:return i.Videos;case t.LocalSuggestionTypes.Music:return i.Music;case t.LocalSuggestionTypes.PowerBi:return i.PowerBi;case t.LocalSuggestionTypes.Document:case t.LocalSuggestionTypes.StartMenuDocument:case r.SearchDocumentsFileExplorer:return i.Documents;case t.LocalSuggestionTypes.Folder:return i.Folders;case t.OnlineSuggestionTypes.Email:return i.Emails;case t.OnlineSuggestionTypes.Person:return i.People;case t.LocalSuggestionTypes.BrowsingHistory:return i.EdgeHistory;case t.OnlineSuggestionTypes.Bookmark:return i.Bookmarks;case t.OnlineSuggestionTypes.Local:return i.LocalPlaces;default:if(n.isAnswer)return n.answerHtml||v(n)||n.autoOpenPreviewPaneWhenOnTopHit?i.SearchSuggestions:i.Cortana;switch(n.handoffType){case 3:return i.Store;case 5:case 4:return i.Cortana;case 0:case 9:return i.SearchSuggestions;case 1:return i.Websites}throw new Error("Unexpected handoff type: "+n.handoffType);}}function pt(n){return n.click&&!n.instItem}function o(n){switch(n){case i.JumpListTasks:case i.JumpListPinned:case i.JumpListRecent:case i.JumpListFrequent:case i.JumpListCustom:return!0;default:return!1}}function wt(n){var t=n.type;return o(t)||t==i.VCDExamples||t==i.Related||t==i.Contact}function bt(n){if(o(n)||n==i.VCDExamples)return i.Apps;if(n==i.Related)return i.SearchSuggestions;if(n==i.Contact)return i.People;throw new Error("Not a top hit child group: "+n);}function s(n){var t=n;return t.parent?t:null}function kt(n){return n.type==t.LocalSuggestionTypes.JumpListItem?n:null}function l(n){switch(n){case i.Apps:case i.Store:return t.Scope.Apps;case i.Settings:return t.Scope.Settings;case i.Documents:return t.Scope.Documents;case i.Folders:return t.Scope.Folders;case i.Photos:return t.Scope.Photos;case i.Videos:return t.Scope.Videos;case i.Music:return t.Scope.Music;case i.LocalPlaces:case i.SearchSuggestions:case i.Websites:case i.EdgeHistory:case i.Bookmarks:return t.Scope.Web;case i.Emails:return t.Scope.Emails;case i.People:return t.Scope.People}return t.Scope.All}function dt(n){switch(n){case 0:return t.IconSize_TopResult;case 1:return t.IconSize_Suggestion;case 2:return t.IconSize_GridLayout_Scaled;case 3:return t.IconSize_StartMenu}throw new Error("Unsupported image size: "+n);}function gt(){var n=t.uiLanguageCache.toLocaleLowerCase();return a[n]||n}function ni(n,t,i,r,u,f,e,o,s,h,c){return{text:n,getIcon:t,icon:i,type:r,query:u,ciMatchedQuery:null,id:h,click:c,handoffType:e,instItem:f,isAnswer:!1,answerHtml:null,selected:!1,featureStore:undefined,sequenceNumber:o,getMruData:function(){return null},template:0,mayContainPII:s,features:[]}}function ti(n,t){if(n.answerHtml)return null;var i=HitHighlightingParser.removeMarkers(n.additionalInfoTextFor3LinesTemplate);return n.template==1&&n.additionalInfoTextFor3LinesTemplate&&n.secondaryText?i+=", "+HitHighlightingParser.removeMarkers(n.secondaryText):i=i||HitHighlightingParser.removeMarkers(n.secondaryText),t=t||i,HitHighlightingParser.removeMarkers(n.text)+(n.rightAlignedText?", "+n.rightAlignedText:"")+(t?", "+t:"")}function ii(n){return n.scope!=t.Scope.All||!!n.taskFrame}function ri(n){return typeof n=="string"?n==t.LocalSuggestionTypes.Photo||n==t.LocalSuggestionTypes.Video:n==i.Photos||n==i.Videos}function ui(n,i){var f,u,e,r;if(!n||t.isMobileCache)return null;if(i.scope==t.Scope.All){if(f=[],n.ISUPN&&n.ISUPG)if(u=n.ISUPN.split("\t"),e=n.ISUPG.split("\t"),u.length==e.length)for(r=0;r<u.length;r++)f.push(e[r]+"\t"+u[r]);else SharedLogHelper.LogError("parseWebSuppressionSignals",null,new Error("parsedNames.length != parsedGroups.length"));return{fullySuppressedGroups:n.FSUP?n.FSUP.split("\t"):null,partiallySuppressedGroups:n.PSUP?n.PSUP.split("\t"):null,suppressedSuggestions:f}}return null}function fi(n){return n==t.Scope.Emails}function v(n){return n.isAnswer&&(n.handoffType==9||n.handoffType==0&&(!!n.additionalInfoText||!!n.secondaryIcon))}function ei(n){if(s(n))return!1;switch(n.handoffType){case 0:case 9:case 5:case 10:case 4:return!0;case 3:return n.type==r.SearchTheStore;case 2:return n.type==t.LocalSuggestionTypes.PowerBi||n.type==r.SearchDocumentsFileExplorer;default:return!1}}function y(r){return!t.PreviewPane||!n.isBingEnabledCache?!1:r.handoffType==0&&!r.answerHtml||e(r)==i.Websites&&r.type!=t.LocalSuggestionTypes.StartMenuUrl}function oi(n,t,i){if(!y(i))return!1;var r=t.query||n.queryToFetch,u=i.query||n.queryToFetch;return r.toLocaleLowerCase()==u.toLocaleLowerCase()}function si(r,u,f){return r==i.Documents&&f.substrateDocumentsEnabled&&t.isSubstrateO365AccountConnected||t.isFileOrFolderScope(l(r))&&(n.isDataSourceEnabled(t.DataSources.OneDrive,u,f)||n.isDataSourceEnabled(t.DataSources.MyStuffOneDrive,u,f))}function hi(n,t){switch(n){case 2:return"OneDrive";case 3:return t.getLocString("OneDriveForBusiness");case 4:return"SharePoint";case 1:return t.getLocString("ThisPC")}return null}function ci(n){if(ThresholdUtilities.isRightToLeftLanguage(t.uiLanguageCache))switch(n){case 37:return 39;case 39:return 37}return n}function li(){return{content:t.CortanaFontIcons.Search,type:2}}function ai(n){return n.getLocString("SearchSuggestions")}function vi(n){return n.getLocString("Websites")}function yi(n){return n.getLocString("SeeWebResults")}function pi(n,t){var i="b_hide";t?n.classList.remove(i):n.classList.add(i)}function wi(t){var i=n.safeExecute(function(){return JSON.parse(t)},"parseTaskFrame");return i?{raw:t,parsed:i}:null}function bi(){u={}}function w(t){var i=u[t],r;return typeof i=="undefined"&&(r=SearchAppWrapper.CortanaApp.queryFormulationView.deviceSearch,r.getFolderPathFromKnownFolderIdGuid?(i=n.safeExecute(function(){return r.getFolderPathFromKnownFolderIdGuid(t)},"getPathFromFolderID","",t),i=i.toLocaleLowerCase()):i="",u[t]=i),i}function ki(){f={}}function di(n){var t,i;return n.startsWith("{")?(t=f[n],t||(i=n.match(b),t=i?w(i[1])+i[2]:n,f[n]=t),t):n}function gi(n){return n.startsWith("file:")&&(n=n.slice(5)),n.replace(/\//g,"\\")}var i,r,d,g,h,a,p,u,f,b;(function(n){n[n.Apps=0]="Apps";n[n.Settings=1]="Settings";n[n.Cortana=2]="Cortana";n[n.Command=3]="Command";n[n.Photos=4]="Photos";n[n.Videos=5]="Videos";n[n.Music=6]="Music";n[n.Documents=7]="Documents";n[n.Folders=8]="Folders";n[n.Emails=9]="Emails";n[n.Store=10]="Store";n[n.SearchSuggestions=11]="SearchSuggestions";n[n.PathCompletion=12]="PathCompletion";n[n.PowerBi=13]="PowerBi";n[n.JumpListTasks=14]="JumpListTasks";n[n.JumpListPinned=15]="JumpListPinned";n[n.JumpListRecent=16]="JumpListRecent";n[n.JumpListFrequent=17]="JumpListFrequent";n[n.JumpListCustom=18]="JumpListCustom";n[n.People=20]="People";n[n.EdgeHistory=21]="EdgeHistory";n[n.LocalPlaces=22]="LocalPlaces";n[n.VCDExamples=23]="VCDExamples";n[n.Bookmarks=25]="Bookmarks";n[n.Related=26]="Related";n[n.Websites=27]="Websites";n[n.Contact=28]="Contact";n[n.GroupHeader=104]="GroupHeader"})(i=t.GroupType||(t.GroupType={}));t.sameGroup=k,function(n){n.PathCompletionGroupHeader="GPT";n.StoreGroupHeader="GT";n.SearchSuggestionsGroupHeader="GW";n.SearchTheWeb="SW";n.Protocol="PWL";n.SearchTheStore="STS";n.SearchBingImages="SBI";n.SearchBingVideos="SBV";n.SearchDocumentsFileExplorer="SDFE";n.ScopesDrawer_SignInToCortana="SDSC";n.ScopesDrawer_IndexingOptions="SDIO";n.IndexingMessage_IndexingOptions="IMIO";n.Substrate_ConnectO365Account="COFA";n.Substrate_ConnectOutlookAccount="COOA";n.SyntheticSuggestionTypesCreatedInAggregator=[n.SearchTheWeb,n.Protocol,n.SearchTheStore,n.SearchBingImages,n.SearchBingVideos,n.SearchDocumentsFileExplorer];n.KValues=function(){var t={};return t[n.PathCompletionGroupHeader]=108,t[n.StoreGroupHeader]=109,t[n.SearchSuggestionsGroupHeader]=110,t[n.SearchTheWeb]=114,t[n.Protocol]=115,t[n.SearchTheStore]=116,t[n.SearchBingImages]=117,t[n.SearchBingVideos]=118,t[n.ScopesDrawer_SignInToCortana]=119,t[n.ScopesDrawer_IndexingOptions]=120,t[n.IndexingMessage_IndexingOptions]=121,t[n.Substrate_ConnectO365Account]=122,t[n.Substrate_ConnectOutlookAccount]=124,t[n.SearchDocumentsFileExplorer]=126,t}();n.HandoffsForNonSuggestions=function(){var t={};return t[n.PathCompletionGroupHeader]=2,t[n.StoreGroupHeader]=3,t[n.SearchSuggestionsGroupHeader]=0,t[n.ScopesDrawer_SignInToCortana]=2,t[n.ScopesDrawer_IndexingOptions]=2,t[n.IndexingMessage_IndexingOptions]=2,t[n.Substrate_ConnectO365Account]=2,t[n.Substrate_ConnectOutlookAccount]=2,t}();n.GroupsForNonSuggestions=function(){var t={};return t[n.PathCompletionGroupHeader]=i.GroupHeader,t[n.StoreGroupHeader]=i.GroupHeader,t[n.SearchSuggestionsGroupHeader]=i.GroupHeader,t[n.ScopesDrawer_SignInToCortana]=i.Settings,t[n.ScopesDrawer_IndexingOptions]=i.Settings,t[n.IndexingMessage_IndexingOptions]=i.Settings,t[n.Substrate_ConnectO365Account]=i.Settings,t[n.Substrate_ConnectOutlookAccount]=i.Settings,t}()}(r=t.SyntheticQSCodes||(t.SyntheticQSCodes={}));t.GroupHeaderQSCodes=function(){var n={};return n[i.PathCompletion]=r.PathCompletionGroupHeader,n[i.Store]=r.StoreGroupHeader,n[i.SearchSuggestions]=r.SearchSuggestionsGroupHeader,n}(),function(n){n.Unknown="UN";n.NotIndexed="NI";n.PartiallyIndexed="PI"}(d=t.LocalProviderIndexerState||(t.LocalProviderIndexerState={})),function(n){n.ContinuePending="CP";n.Disabled="DI";n.PausePending="PP";n.Paused="PD";n.StartPending="SP";n.StopPending="TP";n.Stopped="SD"}(g=t.SearchServiceStatus||(t.SearchServiceStatus={}));t.providerFailureLogName=nt;t.localDataSourceMayContainPII=tt;h=function(){function n(){}return n.RemoveFromDeviceHistory="RemoveFromDeviceHistory",n.RemoveFromWebHistory="RemoveFromWebHistory",n.RemoveFromThisList="RemoveFromThisList",n}();t.SyntheticVerbs=h;t.getSuggestionKey=it;t.getSuggestionDataKey=rt;t.MRUDatabaseName="mruWithIndex";t.isFileOrFolderLocalDataSource=ut;t.isBodyOrSuggestion=ft;t.isModernSetting=et;t.getAppItem=ot;t.getFileItem=st;t.isItemWithFileMetadata=c;t.getItemWithFileMetadata=ht;t.getCommandLineItem=ct;t.getPathCompletionItem=lt;t.getPowerBiItem=at;t.getBrowsingHistoryItem=vt;t.Office365Provider="Office365";t.OutlookProvider="Outlook";t.SubstrateConsumerResource="https://outlook.office.com/";t.SubstrateEnterpriseResource="https://outlook.office.com/autosuggest";t.PeopleCardResource="394866fc-eedb-4f01-8536-3ff84b16be2a";t.SubstrateConsumerScopes="https://outlook.office.com/User.ReadWrite https://outlook.office.com/Files.Read.All https://outlook.office.com/People.Read https://outlook.office.com/Mail.Read";t.CssClass_ScopeTile="scopeTile";t.CssClass_Annotation="annotation";t.CssClass_Action="action";t.CssClass_Force1LineOutsideTopResult="force1LineOutsideTopResult";t.isScopeTile=yt;t.getGroupType=e;t.canGoToL2=pt;t.isJumpListGroup=o;t.isTopHitChildGroup=wt;t.getParentSuggestionGroupType=bt;t.asChildSuggestion=s;t.asJumpListSuggestion=kt;t.getScope=l;t.IconSize_Suggestion=16;t.IconSize_StartMenu=24;t.IconSize_TopResult=32;t.IconSize_GridLayout=92;t.IconSize_GridLayout_Medium=68;t.IconSize_GridLayout_Scaled=130;t.getImageSizeValue=dt;a={"zh-hans-cn":"zh-cn","zh-hans-sg":"zh-cn","zh-hant-hk":"zh-hk","zh-hant-tw":"zh-tw",ko:"ko-kr",ja:"ja-jp",nb:"nb-no"};t.getCurrentLanguage=gt;t.createSuggestion=ni;t.getNarratorText=ti;t.isL2=ii;t.isPhotoOrVideo=ri;t.parseWebSuppressionSignals=ui;t.uses3lineTemplate=fi;t.isLightAnswer=v;t.hasReverseHighlighting=ei;t.supportsPreview=y;t.isEquivalentForPreviewPanePurposes=oi;p=function(){function n(n,t){this.verb=n.verb;this.displayName=n.displayName;this.executeSync=n.executeSync?function(){return t(function(){return n.executeSync()})}:function(){return t(function(){return n.executeAsync()})};this.isDefault=n.isDefault}return n}();t.DeviceItemVerbWrapper=p;t.shouldSetThisPcGroupSource=si;t.getGroupSourceDisplayName=hi;t.IndexingOptionsSettingId="Classic_{87d66a43-7b11-4a28-9811-c86ee395acf7}";t.EdgeAppId="Microsoft.MicrosoftEdge_8wekyb3d8bbwe!MicrosoftEdge";t.getRtlAdjustedKey=ci;t.getSearchSuggestionIcon=li;t.getWebSuggestionsGroupHeader=ai;t.getWebsitesGroupHeader=vi;t.getWebSuggestionAnnotation=yi;t.setVisiblity=pi;t.parseTaskFrame=wi;t.FOLDERID_Profile="{5E6C858F-0E22-4760-9AFE-EA3317B67173}";t.FOLDERID_SkyDrive="{A52BBA46-E9E1-435f-B3D9-28DAA648C0F6}";t.FOLDERID_System="{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}";t.FOLDERID_SystemX86="{D65231B0-B2F1-4857-A4CE-A8E7C6EA7D27}";u={};t.clearFolderCaches=bi;t.getKnownFolderPathLC=w;f={};t.clearPathExpansionCache=ki;b=/^\{([a-z0-9-]{36})\}(.*)/i;t.resolveKnownFolderGUIDsInPath=di;t.indexerFilePathToRegularPath=gi})(t=n.WSB||(n.WSB={}))}(AutoSuggest||(AutoSuggest={})),function(n){var t,i,r;(function(n){n.checking="checking";n.downloading="downloading";n.error="error";n.noUpdate="noupdate";n.obsolete="obsolete";n.updateReady="updateready"})(t||(t={}));i=[t.checking,t.downloading,t.error,t.noUpdate,t.obsolete,t.updateReady];r=function(){function r(n,t,i){i===void 0&&(i=Date.now);this._autoSuggestHost=n;this._instrumentationHelper=t;this.getNowTimestamp=i;this._appCacheEventIndex=1;this._superFreshEnabled=!1;this._appCache=_w.applicationCache;this.subscribeForEvents()}return r.prototype.instrumentSuperFreshUpdate=function(n){this._appCacheTimeline||(this._appCacheTimeline=this.createAppCacheTimelineObject());this._appCacheTimeline.SuperFreshUpdateData.T=this.getNowTimestamp();this._appCacheTimeline.SuperFreshUpdateData.S=n;this.sendAppCacheEvents()},r.prototype.registerSuperFresh=function(){this._superFreshEnabled=!0},r.prototype.subscribeForEvents=function(){var n=this;i.forEach(function(t,i){return sj_be(n._appCache,t,function(){return n.handleAppCacheEvent(t,i)})})},r.prototype.handleAppCacheEvent=function(n,i){n!=t.checking&&this._appCacheTimeline||(this._appCacheTimeline=this.createAppCacheTimelineObject());this._appCacheTimeline.AppCacheEvents[i]=this.getNowTimestamp();switch(n){case t.obsolete:SharedLogHelper.LogError("handleAppCacheEvent",null,"AppCache marked as obsolete and will be deleted");this.sendAppCacheEvents();break;case t.error:case t.noUpdate:this.sendAppCacheEvents();break;case t.updateReady:this._superFreshEnabled||this.sendAppCacheEvents()}},r.prototype.sendAppCacheEvents=function(){var f=_G.ServerIG,t,r,u,i;if(!f){SharedLogHelper.LogError("sendAppCacheEvents","Could not instrument as server IG not known",new Error("Could not instrument app cache event"));return}(t=this._appCacheTimeline,t)&&(r=t.AppCacheEvents,u=[{I:t.EventIndex,E:r,S:t.SuperFreshUpdateData,ABT:this._instrumentationHelper.getConversationStartTimestamp()}],r[2]&&(u[0].OL=navigator.onLine),i=n.InstrumentationCommon.createPerfPingEvent(f,u,"AppCache",this._autoSuggestHost.getConversationId()),Log2.LogEvent(i.EventType,i.Data,n.InstrumentationCommon.QFPERFPING_EVENT_NAME,null,null,i.ImpressionGuid,null,null),this._appCacheTimeline=this.createAppCacheTimelineObject())},r.prototype.createAppCacheTimelineObject=function(){var n={EventIndex:this._appCacheEventIndex,AppCacheEvents:{},SuperFreshUpdateData:{T:undefined,S:undefined}};return this._appCacheEventIndex++,n},r}();n.AppCacheInstrumentationHelper=r}(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(t){var u=[t.DataSources.LocalApps,t.DataSources.LocalSettings,t.DataSources.LocalDocumentsAndFolders,t.DataSources.LocalMedia],i=SearchAppWrapper.CortanaApp,r=i.queryFormulationView,f=function(){function f(n,t){this._config=n;this._host=t}return f.prototype.logProfilerMarker=function(n,t,r,u,f){f||(f={});n==1?i.logMeasure("Bing_QF_"+r,t,"QF",JSON.stringify(f),u):i.logVerboseTrace("Bing_QF_"+r,t,"QF",JSON.stringify(f),u)},f.prototype.getEnrichedClientInfo=function(n){var u={},f;return u.entryPoint=i.entryPoint,u.previousExperience=r.previousExperience,n&&n.scope!=t.Scope.All&&(u.scope=t.Scope[n.scope]),f=r.searchHistory,u.deviceHistoryEnabled=f&&f.isDeviceHistoryEnabled?1:0,typeof ConnectedAccounts!="undefined"&&(u.o365Connected=t.isSubstrateO365AccountConnected?1:0,u.outlookConnected=t.isSubstrateOutlookAccountConnected?1:0),this._host.hasFallbackHappened()&&(u.fallback=1),t.isMobileCache||(i.appsUseLightTheme===!1&&(u.darkMode=!0),i.colorPrevalenceEnabled&&(u.colorPrevalence=1),i.isSearchBoxInTaskbar&&(u.searchBoxInTaskbar=1),i.taskbarOrientation&&(u.taskbarOrientation=i.taskbarOrientation)),i.hostingEnvironment&&(u.hostingEnvironment=i.hostingEnvironment),u},f.prototype.getSuggestionsPageName=function(){return"Page.SmartSearch.AS.Suggestions"},f.prototype.getApplicationName=function(){return"SmartSearch"},f.prototype.getRankerModelId=function(){return this._config.mainRankerId},f.prototype.createNonSuggestionDataSourceObject=function(n,i){return{T:"D.Url",K:i.getKValue(),Val:n,Ho:t.SyntheticQSCodes.HandoffsForNonSuggestions[n],Gr:t.SyntheticQSCodes.GroupsForNonSuggestions[n]}},f.prototype.createDataSourceObject=function(i){var e=this,o=i.mayContainPII&&!this._config.th,r={T:"D.Url",K:i.instItem.getKValue(),Q:o?undefined:i.query,MQ:i.ciMatchedQuery?i.ciMatchedQuery:undefined,Val:i.type,Ho:i.handoffType,Ans:i.isAnswer?1:undefined,Gr:t.getGroupType(i),HC:i.hc?1:undefined,RAF:i.useRaf?1:undefined,HS:i.fromHistory?1:undefined,F:i.features.length>0?i.features.join(","):undefined,AC:i.autoCompleteType?i.autoCompleteType:undefined,HCMS:i.highConfidenceMetaSuggestionScore,HCS:i.highConfidenceSuggestionScore,LM:i.suggestionLogMeta,Uri:i.actionUri,Src:i.source,Sg:i.segments},f,u;return i.deviceItem?r.DeviceSignals=n.safeExecute(function(){return e.buildDeviceItemDataSource(o,i)},"buildDeviceItemDataSource"):(f=t.asJumpListSuggestion(i),f&&(r.DeviceSignals=n.safeExecute(function(){return e.buildJumpListItemDataSource(f)},"buildJumpListItemDataSource"))),this._config.th&&(u=i,u.path&&(r.path=u.path),u.targetPathLC&&(r.targetPath=u.targetPathLC)),r.RankerSignals=this.buildRankerOutputDataSource(i),r},f.prototype.buildRankerOutputDataSource=function(n){if(!n.rankingScore&&!n.featureStore)return undefined;return{rankingScore:n.rankingScore,featureStore:n.featureStore,mruSuppressionScore:n.mruSuppressionScore,fbcScore:n.fbcScore}},f.prototype.buildJumpListItemDataSource=function(t){var r=t.jumpListItem,i={Rank:r.usagePoints||undefined,LAD:n.isValidDate(r.lastAccessed)?r.lastAccessed.toJSON():undefined};if(this._config.th)i.path=r.path,i.description=t.tooltip;else if(!i.Rank&&!i.LAD)return undefined;return i},f.prototype.buildDeviceItemDataSource=function(i,r){var e=r.deviceItem,u={Rank:e.rankScore},f,s,h,o;if(e.propertyHits&&e.propertyHits.length>0&&(u.PHits=e.propertyHits.join(",")),i||(u.Id=e.id,u.DName!=r.query&&(u.DName=e.displayName)),this._config.th&&(u.kind=e.kind),t.isSetting(r.type))return u.MDN=t.isModernSetting(e)?1:0,u;if(f=t.getAppItem(r),f)return u.LAD=n.isValidDate(f.lastAccessed)?f.lastAccessed.toJSON():undefined,u.AppLnch=f.totalLaunches,u.Args=f.launchArguments?1:0,u.MDN=f.isImmersive?1:0,u.Ext=f.extension,this._config.th&&(u.CDT=n.isValidDate(f.createdDate)?f.createdDate.toJSON():undefined,u.LMD=n.isValidDate(f.lastModifiedDate)?f.lastModifiedDate.toJSON():undefined,u.launchArguments=f.launchArguments,u.filePath=f.filePath),u;if(s=t.getItemWithFileMetadata(r),s){if(u.Ext=s.extension,this._config.th&&(u.itemTypeDisplayName=s.itemTypeDisplayName),h=t.getCommandLineItem(r),h)return this._config.th&&(u.launchArguments=h.launchArguments,u.encodedPath=h.encodedPath),u;t.getPathCompletionItem(r)||(o=r.deviceItem,u.CDT=n.isValidDate(o.createdDate)?o.createdDate.toJSON():undefined,u.LMD=n.isValidDate(o.lastModifiedDate)?o.lastModifiedDate.toJSON():undefined,u.Ext=o.extension?o.extension:"")}return u},f.prototype.logMasterPageImpression=function(t){n.safeExecute(function(){return ThresholdInst.LogPageImpression(t,null,t.enrichedClientInfo)},"logMasterImpressionForClient")},f.prototype.logDataSourceTimeout=function(i,f){var s,h,e,o,c;if(r.logProviderFailure)for(s=function(u){n.isDataSourceEnabled(u,f,h._config)&&!n.contains(i,u)&&n.safeExecute(function(){return r.logProviderFailure(t.providerFailureLogName(u),"NoReturnForTopHit")},"logProviderFailure")},h=this,e=0,o=u;e<o.length;e++)c=o[e],s(c)},f.prototype.onItemClick=function(){r.resetConversationIdNextTimeQFIsShown&&r.resetConversationIdNextTimeQFIsShown()},f}();t.WSBInstrumentationProvider=f})(t=n.WSB||(n.WSB={}))}(AutoSuggest||(AutoSuggest={})),function(n){var i="/QF_KEYSTROKE_VIRTUAL_URL?",r="autosuggest",t,u=function(){function u(i,r,u){var f=this,e;this._config=i;this._host=r;this._clientInstrumentationProvider=u;this._conversationStartTimestamp=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE;this._keystrokesPerfPingData={};this._keystrokesInstrumentationData={};ClientInstConfig.queueDumpInterval=i.logQueueDumpInterval;_w.ClTrCo.SharedClickSuppressed=!0;r.bindConversationStart(function(){return f.onConversationStart()});i.th&&(ClientTestHooks.isTesthookParamSet("perfTrace")&&(t=!0),e=n.log,n.log=function(n,t){t||f.instrumentDebugEvent(n);e(n,t)})}return u.prototype.getImpressionGuid=function(n){var t=this._keystrokesInstrumentationData[n];if(t&&t.ImpressionGuid)return t.ImpressionGuid;throw"getImpressionGuid(): No IG for sequence "+n;},u.prototype.instrumentItemClick=function(n,t,i,r,u,f,e,o){this.logCustomGPing(n,u,t.getHValue(),e,f,o);var h=this._keystrokesInstrumentationData[i],s=this._keystrokesInstrumentationData[i];s?(h.RenderingStarted||this.updatePageIG(i),_G.IG!=s.ImpressionGuid&&SharedLogHelper.LogError("instrumentItemClick","IG ("+s.ImpressionGuid+") for sequenceNumber "+i+" does not match the page IG ("+_G.IG+")",new Error("IG for sequence number does not match the currently rendered page's IG (_G.IG)"))):SharedLogHelper.LogError("instrumentItemClick","sequenceNumber: "+i+" ConversationID: "+this._host.getConversationId(),new Error("No instrumentation data found for sequenceNumber"));this.finalizeKeystrokeLog(i,1);r&&r();this._clientInstrumentationProvider.onItemClick();this._config.forceLogFlush?Log2.ForceFlush():Log2.FlushMainQueueDontForce();_w.clickFlushedTime=sb_gt()},u.prototype.logCustomGPing=function(t,i,r,u,f,e){var o={},s,h;u&&(o.cm=u);s=this.getModifierKeyCodes(f);switch(i){case 1:o.i="k";s&&(o.mk=s);break;case 3:o.i="t";break;case 4:o.i="p";break;case 5:o.i="n";break;case 6:o.i="b";break;case 0:o.i="x";default:s&&(o.mk=s)}e&&(o.pp=e);h=r;n.isEmpty(o)||(h+="&PR="+JSON.stringify(o));n.safeExecute(function(){return _w.si_T(h)},"logCustomGPing")},u.prototype.getModifierKeyCodes=function(n){if(n){var t=n.altKey?"A":"";if(t+=n.ctrlKey?"C":"",t+=n.shiftKey?"S":"",t)return t}return undefined},u.prototype.logClientInstEvent=function(n,t,i,r,u){var f,e,o;r?(f=null,e=this._keystrokesInstrumentationData[r],e&&(f=e.ImpressionGuid),Log2.LogEvent(n,u,i,null,null,f,null,null)):(o=[n,t,i,!1],u&&Object.keys(u).forEach(function(n){return o.push(n,u[n])}),Log.Log.apply(null,o))},u.prototype.safeInstrument=function(n,t,i,r){var u=this._keystrokesInstrumentationData[n];u?t(u):SharedLogHelper.LogError(i,(r?r+" ":"")+" sequenceNumber: "+n,new Error("No instrumentation data found for sequenceNumber"))},u.prototype.safeInstrumentPerf=function(n,t,i,r){var u=this._keystrokesPerfPingData[n];u?t(u):SharedLogHelper.LogError(i,(r?r+" ":"")+" sequenceNumber: "+n,new Error("No instrumentation data found for sequenceNumber"))},u.prototype.instrumentRenderingStarted=function(n){var t=this;this.safeInstrument(n,function(i){i.RenderingStarted=!0;t.updatePageIG(n)},"instrumentRenderingStarted")},u.prototype.instrumentBeginRequest=function(t,i,r){var u;delete this._keystrokesInstrumentationData[t-1];n.InstrumentedItem.resetKValues(t);u=this._keystrokesPerfPingData[t];u&&SharedLogHelper.LogError("instrumentBeginRequest","sequenceNumber: "+t,new Error("Duplicate BeginRequest for sequenceNumber"));var f=this._host.getConversationId(),e=this._host.getRawImpressionGuid(),o=n.cleanGuid(e),s=n.getCurrentTime()-r,h={ImpressionGuid:o,ConversationId:f,Query:i,PendingDataSources:{},DataSources:{},RankerExtraInfo:{},DuplicateDS:{},Layout:[],MasterPageImpressionCreated:!1,RenderingStarted:!1,PendingInstrumentedItems:{},PendingSyntheticSuggestions:{},OriginalTimestamp:s},c={RawImpressionGuid:e,ImpressionGuid:o,ConversationId:f,PrefixLength:i.queryToFetch?i.queryToFetch.length:0,RequestBegin:this.getOffsetedNow(s),ResponseReceived:{},DataSourcesState:this._searchServiceStatus?{Indexer:this._searchServiceStatus}:undefined,RenderFinished:{},AllDataSourcesProcessed:!1,PendingIcons:0,TopResultRendered:[],IconsRetrieved:{},ResponseFromCache:{}};this._keystrokesInstrumentationData[t]=h;this._keystrokesPerfPingData[t]=c},u.prototype.setSearchServiceStatus=function(n){this._searchServiceStatus=n},u.prototype.instrumentResponseReceived=function(n,i,r,u){var f=this;this.safeInstrumentPerf(n,function(n){var e=f.getOffsetedNow();n.ResponseReceived[i]=e;t&&f.logProfilerMarker(0,0,i,n);r&&(n.DataSourcesState=n.DataSourcesState||{},n.DataSourcesState[i]=r);u&&(n.ResponseFromCache[i]=u)},"instrumentResponseReceived",i)},u.prototype.instrumentTopResultRendered=function(n,t){var i=this;this.safeInstrumentPerf(n,function(r){var u=i.getOffsetedNow();i.logProfilerMarker(1,0,"topResultRendered",r);r.TopResultRendered.push({V:u,T:t.join(",")});i.tryInstrumentRenderStopped(n,r)},"instrumentTopResultRendered")},u.prototype.instrumentAggregatorCall=function(t,i){var r=this;this.safeInstrument(t,function(t){var e={fastRankModelId:r._clientInstrumentationProvider.getRankerModelId()},f,u;for(f in t.RankerExtraInfo)e[f]=t.RankerExtraInfo[f];t.RankerExtraInfo={};u={T:"D.Aggregator",Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"Aggregator",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,DS:[],rankerModelIds:e};r._config.counterFactualLoggingOn&&(u.counterFactualDiff=u.counterFactualDiff||i);t.DataSources.aggregator=u},"instrumentAggregatorCall")},u.prototype.addDuplicatesDataSource=function(t){var i=Object.keys(t.DuplicateDS).map(function(n){return t.DuplicateDS[n]});i.length>0&&(t.DataSources.duplicates={T:"D.Duplicates",Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"Duplicates",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,DS:i})},u.prototype.instrumentDuplicate=function(t,i,r){this.safeInstrument(t,function(t){var u=t.DuplicateDS[i.instItem.getHValue()],f;u||(u={T:"D.Duplicate",DS:[{T:"D.DSRef",KRef:i.instItem.getKValue()}]},i.instItem.getAppNS()!=n.InstrumentationCommon.DEFAULT_APP_NAMESPACE&&(u.DS[0].AppNS=i.instItem.getAppNS()),t.DuplicateDS[i.instItem.getHValue()]=u);f={T:"D.DSRef",KRef:r.instItem.getKValue()};r.instItem.getAppNS()!=n.InstrumentationCommon.DEFAULT_APP_NAMESPACE&&(f.AppNS=r.instItem.getAppNS());u.DS.push(f);i.duplicates=i.duplicates||[];i.duplicates.push(r)},"instrumentDuplicate")},u.prototype.renderingStopped=function(n){return n.PendingIcons==0&&n.AllDataSourcesProcessed},u.prototype.notifyAllDataSourcesProcessed=function(n){var t=this;this.safeInstrumentPerf(n,function(i){i.AllDataSourcesProcessed=!0;t.tryInstrumentRenderStopped(n,i)},"notifyAllDataSourcesProcessed")},u.prototype.notifyIconPending=function(t,i,r,u){var f=this;this.safeInstrumentPerf(t,function(t){var e=r+(i?"T":"S");t.IconsRetrieved[e]||(t.IconsRetrieved[e]={B:f.getOffsetedNow(),E:n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,T:u},t.PendingIcons++)},"notifyIconPending",i?"TR":"SUG")},u.prototype.notifyIconReady=function(n,t,i){var r=this;this.safeInstrumentPerf(n,function(n){var u=i+(t?"T":"S");n.IconsRetrieved[u]?n.IconsRetrieved[u].E=r.getOffsetedNow():SharedLogHelper.LogError("notifyIconReady",null,new Error("Instrumenting unseen icon"));n.PendingIcons--},"notifyIconReady",t?"TR":"SUG")},u.prototype.tryInstrumentRenderStopped=function(t,i){this.renderingStopped(i)&&(this.finalizeKeystrokeLog(t,2),this._config.th&&n.safeFireEvent("RenderStopped"))},u.prototype.isLayoutLogged=function(n){return this._keystrokesInstrumentationData[n].MasterPageImpressionCreated},u.prototype.finalizeKeystrokeLog=function(n,t){var i,r;t===void 0&&(t=0);i=this._keystrokesInstrumentationData[n];i&&this.logKeystrokeData(i,n);t!=1&&(r=this._keystrokesPerfPingData[n],r&&(this.logPerfPingEvent(this.createKeystrokePerfPingEvent(n,r)),delete this._keystrokesPerfPingData[n]))},u.prototype.instrumentRenderFinished=function(i,r){var u=this;this.safeInstrumentPerf(i,function(f){var e=u.getOffsetedNow();r.forEach(function(n){return f.RenderFinished[n]=e});t&&(u.logProfilerMarker(0,0,"groupsRendered",f),n.log(r.toString()));u.tryInstrumentRenderStopped(i,f)},"instrumentRenderFinished",r.join(","))},u.prototype.instrumentSyntheticInstrumentedItem=function(n,t,i){var r=this._keystrokesInstrumentationData[n];r?r.PendingInstrumentedItems[t]=i:SharedLogHelper.LogError("instrumentSyntheticInstrumentedItem",t,new Error("keystrokesInstrumentationData not found"))},u.prototype.instrumentSyntheticSuggestion=function(n,t){var i=this._keystrokesInstrumentationData[n];i?i.PendingSyntheticSuggestions[t.type]=t:SharedLogHelper.LogError("instrumentSyntheticSuggestion",t.type,new Error("Instrumentation synthetic suggestion after flush"))},u.prototype.getInstrumentedSyntheticSuggestion=function(n,t){return this._keystrokesInstrumentationData[n].PendingSyntheticSuggestions[t]},u.prototype.instrumentDataSource=function(n,t,i,r){this.safeInstrument(n,function(n){var u,f,e;if(r&&r.rankerExtraInfo)for(u in r.rankerExtraInfo)n.RankerExtraInfo[u]=r.rankerExtraInfo[u];f=i||[];e=n.PendingDataSources[t];n.PendingDataSources[t]=e?e.concat(f):f},"instrumentDataSource",t)},u.prototype.processPendingDataSources=function(t){var i,f,r,u,e,o;for(i in t.PendingDataSources)if(f=t.PendingDataSources[i],f.length>0){for(r=[],u=0,e=f;u<e.length;u++)o=e[u],r.push(this._clientInstrumentationProvider.createDataSourceObject(o));i=="Web"&&(i="WebAS");r.length>0&&(t.DataSources[i]={T:"D."+i,AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:i,SC:r.length,DS:r})}t.PendingDataSources={}},u.prototype.instrumentSnRProviderFetchUrl=function(n,t){this.safeInstrument(n,function(n){n.SnRProviderFetchUrl=t},"instrumentSnRProviderFetchUrl")},u.prototype.onConversationStart=function(){this._conversationStartTimestamp=n.getCurrentTime();this._searchServiceStatus=null},u.prototype.getConversationStartTimestamp=function(){return this._conversationStartTimestamp},u.prototype.logDataSourceTimeout=function(i,r){t&&n.log("timeout");this._clientInstrumentationProvider.logDataSourceTimeout(i,r)},u.prototype.logProfilerMarker=function(i,r,u,f,e){if(t&&r!=2){var o=this.getOffsetedNow();n.log(u+" "+(o-f.RequestBegin))}this._clientInstrumentationProvider.logProfilerMarker(i,r,u,f.RawImpressionGuid,e)},u.prototype.createKeystrokePerfPingEvent=function(t,i){var u={I:t,PL:i.PrefixLength,K:i.RequestBegin,RRT:i.ResponseReceived,RFT:i.RenderFinished,TRR:i.TopResultRendered,RS:undefined,IRT:i.IconsRetrieved},r,f,e,o,s;if(this.renderingStopped(i)){for(r=0,f=0,e=u.TRR;f<e.length;f++)o=e[f],r=Math.max(r,o.V);for(s in u.RFT)r=Math.max(r,u.RFT[s]);r&&(u.RS=r)}return n.InstrumentationCommon.createPerfPingEvent(i.ImpressionGuid,[u],"Keystroke",i.ConversationId,i.DataSourcesState,i.ResponseFromCache)},u.prototype.updatePageIG=function(n){_G.IG=this.getImpressionGuid(n)},u.prototype.createMasterPageImpression=function(t,i,u,f,e){var h={dataSources:e||[],layoutNodes:[],pageName:t,rawQuery:f?f.queryToFetch:"",isQuery:!1,impressionUrl:this.createVirtualImpressionURL(i,u),appName:this._clientInstrumentationProvider.getApplicationName(),enrichedClientInfo:{FDPartnerEntry:r,nclid:_G.nclid,isOffline:n.isBrowserOnline()?0:1,webRequested:u?1:0}},o=this._clientInstrumentationProvider.getEnrichedClientInfo(f),s;if(o)for(s in o)h.enrichedClientInfo[s]=o[s];return h},u.prototype.logKeystrokeData=function(t){var r,u,f;(this.processPendingDataSources(t),this._config.th&&this.addDuplicatesDataSource(t),r=Object.keys(t.DataSources).map(function(n){return t.DataSources[n]}).concat(this.createNonSuggestionsDataSource(t.PendingInstrumentedItems,t.PendingSyntheticSuggestions)),t.DataSources={},t.PendingSyntheticSuggestions={},t.PendingInstrumentedItems={},r.length==0&&t.MasterPageImpressionCreated)||(t.RenderingStarted&&(u=DsLManager.CreateLayoutNode(_d.body,n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,!1,!0,t.MasterPageImpressionCreated)),t.MasterPageImpressionCreated?Log2.LogEvent("ClientInst",null,null,r,u,t.ImpressionGuid,null,null):(f=this.createMasterPageImpression(this._clientInstrumentationProvider.getSuggestionsPageName(),i,t.SnRProviderFetchUrl?t.SnRProviderFetchUrl.substring(t.SnRProviderFetchUrl.indexOf("?")+1):"",t.Query,r),u&&(f.layoutNodes=u),f.clientTimestamp=t.OriginalTimestamp,this.logMasterPageImpression(t.ImpressionGuid,f),t.MasterPageImpressionCreated=!0))},u.prototype.logPerfPingEvent=function(t){Log2.LogEvent(t.EventType,t.Data,n.InstrumentationCommon.QFPERFPING_EVENT_NAME,null,null,t.ImpressionGuid,null,null);this._config.th&&ClientTestHooks.ClientApiLogNoConsole("perfPingEvent",[t])},u.prototype.logMasterPageImpression=function(n,t){if(t){if(!n){SharedLogHelper.LogError("logMasterPageImpression",null,new Error("Missing impressionGuid"));return}t.impressionGuid=n;this._clientInstrumentationProvider.logMasterPageImpression(t,this._host.getConversationId());this._config.th&&ClientTestHooks.ClientApiLogNoConsole("masterPageImpression",t,n)}},u.prototype.instrumentInitializationFinish=function(t){var u=_G.ServerIG,i,r;if(!u){SharedLogHelper.LogError("instrumentInitializationFinish","Could not instrument as server IG not known",new Error("Could not instrument initilization finish"));return}if(i=n.InstrumentationCommon.QFPERFPING_INVALID_MEASURE,r=_w.performance,r&&r.timing&&(i=r.timing.navigationStart),!(i<=0)){var f=t.getTime()-i,e=n.getCurrentTime()-i,o=[{BLT:f,ILT:e}],s=n.InstrumentationCommon.createPerfPingEvent(u,o,"Load");this.logPerfPingEvent(s)}},u.prototype.getOffsetedNow=function(t){return t===void 0&&(t=n.getCurrentTime()),t-this._conversationStartTimestamp},u.prototype.createNonSuggestionsDataSource=function(t,i){var r=[],u,f;for(u in t)r.push(this._clientInstrumentationProvider.createNonSuggestionDataSourceObject(u,t[u]));for(u in i)r.push(this._clientInstrumentationProvider.createDataSourceObject(i[u]));return r.length?(f={T:"D.ContentGroup",AppNS:n.InstrumentationCommon.DEFAULT_APP_NAMESPACE,Service:n.InstrumentationCommon.DEFAULT_SERVICE_NAME,Scenario:"NonSuggestions",SC:r.length,DS:r},[f]):[]},u.prototype.createVirtualImpressionURL=function(t,i){var r=n.getWindowProtocol()+"//"+n.getWindowHost()+t;return r+=i?i:n.Service.QueryParams.ConversationId+"="+n.encodeQueryParameter(this._host.getConversationId()),_G.ServerIG&&(r+="&ASInitIG="+n.encodeQueryParameter(_G.ServerIG)),r},u.prototype.instrumentDebugEvent=function(t){var r=_G.ServerIG,i=n.InstrumentationCommon.createPerfPingEvent(r,undefined,"Debug");i.Data.Message=t;this.logPerfPingEvent(i)},u}();n.InstrumentationHelper=u}(AutoSuggest||(AutoSuggest={})),function(n){var t="&nclid=",i="&ts=",r="&nclidts=",u="&tsms=",f="&elv=",e="&cc=",o="&setlang=",s="&cvid=",h="&qs=",c=function(){function c(t,i,r,u,f){u===void 0&&(u=Date.now);f===void 0&&(f=n.getWindowProtocol()+"//"+n.getWindowHost());this._config=t;this._host=i;this._searchPreCacheHandler=r;this.getNowTimestamp=u;this._baseUrl=f}return c.prototype.getSearchUrl=function(t,i,r,u,e,o,s,h){var c,l;return u||(u=(e?"/"+e:"")+"/search?q="+n.encodeQueryParameter(i)),c=this._baseUrl+u,c+="&form="+n.encodeQueryParameter(o||this._host.getFormCode()),c+="&qs="+n.encodeQueryParameter(h?"P":r),c+="&cvid="+n.encodeQueryParameter(this._host.getConversationId()),this._config.suppressPqParameter||(c+="&pq="+n.encodeQueryParameter(t)),c=this.enrichUrlWithMarketInfo(c),s||(c=this.enrichUrlWithMuidInfo(c),l=this._host.getElToken(),l&&this._baseUrl.startsWith("https:")&&(c+=f+n.encodeQueryParameter(l)),c=this.enrichUrlWithSafeSearchInfo(c),this._searchPreCacheHandler&&(c=this._searchPreCacheHandler.attempPreCacheAndEnrichUrl(c))),c},c.prototype.enrichUrlWithMarketInfo=function(n){return n+e+this._host.getRegion()+o+this._host.getLanguage()},c.prototype.enrichUrlWithSafeSearchInfo=function(n){return this._host.getSafeSearchSetting()=="Strict"?n+"&adlt=strict":n},c.prototype.enrichUrlWithMuidInfo=function(f){var e,o,s;return _G.nclid&&(f+=t+n.encodeQueryParameter(_G.nclid),e=this.getNowTimestamp().toString(),f+=i+n.encodeQueryParameter(e),o=e.substring(0,e.length-3),f+=r+n.encodeQueryParameter(o),s=e.substring(e.length-3),f+=u+n.encodeQueryParameter(s)),f},c.prototype.enrichUrlWithCvid=function(t){return t+(s+n.encodeQueryParameter(this._host.getConversationId()))},c.prototype.enrichUrlWithSuggestionType=function(t,i){return t+(h+n.encodeQueryParameter(i))},c}();n.NavigationHelper=c}(AutoSuggest||(AutoSuggest={})),function(n){var t=function(){function n(n,t,i){var r=this;this._config=n;this.host=t;this._selectableItemsContainer=i;t.bindKeyDown(function(n,t,u){switch(n){case 38:r.selectNextItem(!0);break;case 40:r.selectNextItem(!1)}i.onAfterKeyDown(n,t,u)})}return n.prototype.selectNextItem=function(n){var i=this._selectableItemsContainer.getSelectableItems(),f;if(i.length!=0){var r=this._selectableItemsContainer.getSelectedItem(),t=r?i.indexOf(r):-1,u=n?t==0:t==i.length-1;(!u||this._config.allowKeyboardNavCycling)&&(u&&this._selectableItemsContainer.allowUnselectedState()||(t=n?t<=0?i.length-1:t-1:(t+1)%i.length,f=i[t]),this._selectableItemsContainer.select(f,!0))}},n}();n.KeyboardEvtHandler=t}(AutoSuggest||(AutoSuggest={})),function(n){var t=function(){function t(n,t,i,r,u){this._config=n;this._host=t;this._instrumentationHelper=i;this._aggregator=r;this._rootViewModel=u;this._lastUsedId=-1;this._sequenceNumber=-1;this._suggestionsQueue={}}return t.prototype.initiateSequenceNumber=function(t,i){var o=this,u,f,r,s,e;if(this._sequenceNumber>=t){SharedLogHelper.LogError("initiateSequenceNumber",null,new Error("Unexpected sequence number"));return}for(this.resetStateForNewQuery(t,i),this._highPriorityDataSources=[],this._normalPriorityDataSources=[],this._lowPriorityDataSources=[],u=0,f=this._config.enabledDataSources;u<f.length;u++)r=f[u],s=i.enabledDataSources[r],s&&(this._config.lowPriorityDataSources[r]?this._lowPriorityDataSources.push(r):this._config.highPriorityDataSources[r]?this._highPriorityDataSources.push(r):this._normalPriorityDataSources.push(r));this._highPriorityDataSources.length==0&&this._normalPriorityDataSources.length==0&&this._lowPriorityDataSources.length==0?this.processSuggestions(!1):(e=this.getLatencyTimeout(),e>0&&(this._bufferingTimer=sb_st(function(){return n.safeExecute(function(){o._bufferingTimer=null;o.processSuggestions(!0)},"processSuggestionsBuffering")},e)))},t.prototype.getLatencyTimeout=function(){return this._partialQuery.queryToFetch?this._config.latencyTimeout:this._config.latencyTimeoutForZeroInput},t.prototype.queueSuggestions=function(t,i,r,u){if(t>this._sequenceNumber){SharedLogHelper.LogError("queueSuggestions",null,new Error("Unexpected sequence number"));return}if(!(t<this._sequenceNumber)){if(this._suggestionsQueue[i]){SharedLogHelper.LogError("queueSuggestions",i,new Error("Duplicate data source response"));return}if(!n.contains(this._highPriorityDataSources,i)&&!n.contains(this._normalPriorityDataSources,i)&&!n.contains(this._lowPriorityDataSources,i)){SharedLogHelper.LogError("queueSuggestions",i,new Error("Unexpected data source"));return}this._suggestionsQueue[i]={suggestions:r,updated:!1};u&&(this._extraSignalsMap[i]=u);this._arrivedDataSources.push(i);this._allDataSourcesArrived=this._arrivedDataSources.length==this._highPriorityDataSources.length+this._normalPriorityDataSources.length+this._lowPriorityDataSources.length;this._processingStopped||this._instrumentationHelper.isLayoutLogged(this._sequenceNumber)?this._allDataSourcesArrived&&this._instrumentationHelper.notifyAllDataSourcesProcessed(this._sequenceNumber):this.processSuggestions(!1)}},t.prototype.resetTimers=function(){this._bufferingTimer&&(sb_ct(this._bufferingTimer),this._bufferingTimer=null)},t.prototype.resetStateForNewQuery=function(t,i){this._arrivedDataSources=[];this._allProcessedDataSources=[];this._sequenceNumber=t;this._partialQuery=i;this._suggestionsQueue={};this._extraSignalsMap={};this._isAnySuggestionRendered=!1;this._waitingForMoreResults=!0;this._processingStopped=!1;this._allDataSourcesArrived=n.isEmpty(i.enabledDataSources);this.resetTimers()},t.prototype.getDependencies=function(t){var i=this;return this._host.dataSourceDependencies(t).filter(function(t){return n.isDataSourceEnabled(t,i._partialQuery,i._config)})},t.prototype.haveAllDataSources=function(n){var t=this;return n.every(function(n){return!!t._suggestionsQueue[n]})},t.prototype.processSuggestions=function(t){var i=this,u=[],s=[],r,a=this.getLatencyTimeout()>0&&this._bufferingTimer==null,v=this.haveAllDataSources(this._normalPriorityDataSources),o=this.haveAllDataSources(this._highPriorityDataSources),y=o||a,h=o&&v,c,e,l,f;t&&this._instrumentationHelper.logDataSourceTimeout(Object.keys(this._suggestionsQueue),this._partialQuery);c=function(t,f){if(!t.updated&&i.getDependencies(f).every(function(t){return n.contains(i._arrivedDataSources,t)})){if(s.push(f),i._allProcessedDataSources.push(f),t.suggestions.length>0){var e=i.canHaveSuppressions(f)?t.suggestions.filter(function(n){return!i.isSuppressed(f,n,t.suggestions)}):t.suggestions;e.length>0&&(r||(r=i._isAnySuggestionRendered?i._rootViewModel.getSuggestions(!0):[]),u=u.concat(i.removeDuplicatesAndAssignIds(e,r,u,f)))}t.updated=!0}};e=function(n){var u,t,r;for(u in n)t=n[u],r=i._suggestionsQueue[t],r&&c(r,t)};y&&e(this._highPriorityDataSources);this._bufferingTimer&&h&&(sb_ct(this._bufferingTimer),this._bufferingTimer=null);l=this.getLatencyTimeout()>0?this._bufferingTimer==null:o;l&&(e(this._normalPriorityDataSources),e(this._lowPriorityDataSources));f=t&&!this._isAnySuggestionRendered;this._waitingForMoreResults&&h&&(this._waitingForMoreResults=!1,f=!0);this._partialQuery.showProgressBar&&this._allDataSourcesArrived&&(f=!0);(u.length>0||f)&&(r||(r=this._isAnySuggestionRendered?this._rootViewModel.getSuggestions(!0):[]),this.addSuggestions(r,u,s,f));this._allDataSourcesArrived&&this._instrumentationHelper.notifyAllDataSourcesProcessed(this._sequenceNumber)},t.prototype.getAggregatorResult=function(n,t,i){var f=this.waitingForWebProvider(this._allProcessedDataSources),u=null,r,e;return this._config.counterFactualLoggingOn&&(u=this._aggregator.rank(t,i,this._extraSignalsMap,this._partialQuery,n,this._sequenceNumber,f,!0)),r=this._aggregator.rank(t,i,this._extraSignalsMap,this._partialQuery,n,this._sequenceNumber,f,!1),e=this._config.counterFactualLoggingOn&&(!this.isSuggestionOrderTheSame(r.topResults,u.topResults)||!this.isSuggestionOrderTheSame(r.suggestionsToAdd,u.suggestionsToAdd)),[r,e]},t.prototype.waitingForWebProvider=function(t){var i=this;return n.isBrowserOnline()&&[n.WebDataSource].concat(this.getDependencies(n.WebDataSource)).some(function(r){return n.isDataSourceEnabled(r,i._partialQuery,i._config)&&!n.contains(t,r)})},t.prototype.isSuggestionOrderTheSame=function(n,t){var r=function(n){return n.query+"\t"+n.type},i;if(n.length!=t.length)return!1;for(i=0;i<n.length;i++)if(r(n[i])!=r(t[i]))return!1;return!0},t.prototype.addSuggestions=function(t,i,r,u){var e=this,o=this._isAnySuggestionRendered?this._rootViewModel.getCurrentTopResults():[],v=n.safeExecute(function(){return e.getAggregatorResult(o,t,i)},"getAggregatorResults",[null,!1]),f=v[0],p=v[1],s,h,l,c,a,y;for(f||(f={topResults:o,suggestionsToAdd:i,suggestionsToRemove:[],groupOrder:[]}),this._instrumentationHelper.instrumentAggregatorCall(this._sequenceNumber,p),i=f.suggestionsToAdd,s=f.suggestionsToRemove,h=0,l=f.topResults;h<l.length;h++)c=l[h],n.contains(t,c)&&!n.contains(o,c)&&s.push(c);(u||i.length!=0||s.length!=0||!n.sequenceEqual(o,f.topResults))&&(a=!this._isAnySuggestionRendered,a&&(this._isAnySuggestionRendered=!0,this._instrumentationHelper.instrumentRenderingStarted(this._sequenceNumber)),y=n.safeExecute(function(){return e._rootViewModel.update(a,f.topResults,e._waitingForMoreResults,e._sequenceNumber,i,s,r,f.groupOrder,e._allDataSourcesArrived)},"rootViewModel.update",0,null,function(){return e._host.reloadWebView(!0)}),y==0&&(this._processingStopped=!0,this.resetTimers()))},t.prototype.removeDuplicatesAndAssignIds=function(n,t,i,r){var u=this,s=function(n){n.id||(n.id="id_"+ ++u._lastUsedId)},o;if(this._aggregator.canHaveDuplicates(r,this._partialQuery)){var e=[],h=function(o){var h=n[o],c=t.findIndex(function(n){return u._aggregator.isDuplicate(u._partialQuery,n,h)});if(c>=0)return f._instrumentationHelper.instrumentDuplicate(f._sequenceNumber,t[c],h),"continue";if(c=i.findIndex(function(n){return u._aggregator.isDuplicate(u._partialQuery,n,h)}),c>=0)return f._instrumentationHelper.instrumentDuplicate(f._sequenceNumber,i[c],h),"continue";if(f._aggregator.canHaveDuplicatesWithinDataSource(r)&&(c=e.findIndex(function(n){return u._aggregator.isDuplicate(u._partialQuery,n,h)}),c>=0))return f._instrumentationHelper.instrumentDuplicate(f._sequenceNumber,e[c],h),"continue";s(h);e.push(h)},f=this;for(o=0;o<n.length;++o)h(o);return e}return n.forEach(function(n){return s(n)}),n},t.prototype.canHaveSuppressions=function(n){return this._config.suppressDataSources[n]||this._config.dataSourcesWithSuppressedTypes[n]},t.prototype.isSuppressed=function(n,t){return this._config.suppressDataSources[n]||this._config.suppressTypes[t.type]},t}();n.SuggestionsRenderingManager=t}(AutoSuggest||(AutoSuggest={})),function(n){function l(n,t){return n.useTextForRanking?HitHighlightingParser.removeMarkers(t.text):t.query}function f(n){var t,i;if(n.length==0)return 0;for(t=0,i=0;i<n.length;i++)t=(t<<5)-t+n.charCodeAt(i)|0;return t}function t(n,t){var u,i,r;if(!n)return t.length;if(!t)return n.length;for(u=[],i=0;i<=t.length;i++)u[i]=[i];for(r=0;r<=n.length;r++)u[0][r]=r;for(i=1;i<=t.length;i++)for(r=1;r<=n.length;r++)u[i][r]=t.charAt(i-1)==n.charAt(r-1)?u[i-1][r-1]:Math.min(u[i-1][r-1]+1,Math.min(u[i][r-1]+1,u[i-1][r]+1));return u[t.length][n.length]}function a(n,i){return n&&(n=n.toLocaleLowerCase()),i&&(i=i.toLocaleLowerCase()),t(n,i)}function o(n,t,i){var r=0,u;return(t>0||i>0)&&(t>0&&i>0?(i>t&&(u=t,t=i,i=u),r=n/(t-n+i)):r=Number.MAX_VALUE),r}function v(n,t){return!n||!t?0:n.length+1<=t.length&&t[n.length]==" "?1:n.length==t.length?1:0}function y(n){var r=0,i=1,t;if(n&&n.length>1)for(t=1;t<n.length;t++)n.charAt(t)==n.charAt(t-1)?i++:i=1,i>r&&(r=i);else if(n)return 1;return r}function p(n){return n&&n.length>0?n.trim().split(" ").length:0}function w(n){var t=new RegExp("^[0-9a-zA-Z ]+$");return n&&t.test(n)?1:0}function b(n){return n&&n.length>0&&n.charAt(n.length-1)==" "?1:0}function k(n){return n&&n.length>0&&(n.includes("http://")||n.includes("https://")||n.includes("."))?1:0}function d(t,i,r,u){var o,e,s,h;t.includes("?")&&(r[117]=1,tt(t)&&(r[127]=1));t.replace("///","").replace("//","").includes("/")&&(r[118]=1);t.includes(".")&&(r[119]=1);o=u.cvid+u.privacyNumber+t;r[120]=f(o);e=t.toLocaleLowerCase();(e.startsWith("www.")||e.startsWith("http://www.")||e.startsWith("https://www."))&&(r[122]=1);e.startsWith("www.")||e.startsWith("http://")?r[123]=1:e.startsWith("https://")?r[124]=1:e.startsWith("ftp://")?r[125]=1:r[126]=1;i&&(s=n.normalizeUrl(e,15),h=n.normalizeUrl(i,15).toLocaleLowerCase(),s.startsWith(h)&&(r[187]=1))}function g(n,i,r,u,e){if(e){r[128]=t(e,i);r[129]=e.length;var o=u.cvid+u.privacyNumber+e;r[130]=f(o)}}function nt(n,i,r){var e=n.toLocaleLowerCase(),s,u,f,h,c;if(r[140]=n.length,s=e.split(" "),r[144]=s.length,i)for(r[141]=t(n,i),r[142]=Math.min(100,o(r[141],i.length,n.length)),u=i.toLocaleLowerCase(),e.includes(u)&&(r[143]=1),e.startsWith(u)&&(r[188]=1),f=0,h=s;f<h.length;f++)if(c=h[f],c==u){r[145]=1;break}}function tt(n){return wt.some(function(t){return n.startsWith(t)})}function it(n){var i=0,r,t;if(n)for(r in n)t=n[r],t&&t.prefixLaunchCount&&(i+=t.prefixLaunchCount);return i}function rt(n,t,i,r){if(i){var u=i[n];u&&(t[47]=u.prefixLaunchCount,t[49]=u.lastLaunchTime,t[101]=r,r>0&&(t[100]=u.prefixLaunchCount/r))}}function ut(n,t,i){if(i){var r=i[n];r&&(t[281]=r.probability,t[282]=r.weight)}}function ft(n,t,r,u,f,e){if(t){var s=i(u,r),o=t[s];o&&(f?(n[153]=o.ProbSugClickGivenPref,n[152]=o.ClicksOnSugGivenPref):e?(n[161]=o.Loglikelihood,n[162]=o.ProbSugClickGivenBackground,n[163]=o.ClicksOnSugGivenPref,n[164]=o.ProbSugClickGivenPref,n[165]=o.CCR,n[166]=o.EventCount,n[167]=o.ProbSugClickGivenTime,n[168]=o.CCRTime):(n[6]=o.Loglikelihood,n[3]=o.ProbSugClickGivenBackground,n[151]=o.ClicksOnSugGivenPref,n[0]=o.ProbSugClickGivenPref,n[94]=o.CCR,n[95]=o.EventCount,n[154]=o.ProbSugClickGivenTime,n[155]=o.CCRTime))}}function et(n,t,i){if(t){var r=t[i];r&&(n[256]=r.PSGPCR,n[257]=r.PSGCCR,n[258]=r.PSGSTR,n[286]=r.PSGSATCCR,n[287]=r.PSGSATPCR)}}function i(n,t){return(n+"\t"+t).toLocaleLowerCase()}function r(n,t,i,r){t=="100"&&(t="11");i==11..toString()&&i==0..toString();switch(n.athenaKeyType){case 0:return t||SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key group is empty")),t;case 1:return i||SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key handoff is empty")),i;case 2:return r||SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key suggestion type is empty")),i||SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key handoff is empty")),r+"_"+i;default:return SharedLogHelper.LogError("getAthenaGroupKey",null,new Error("Athena key group type is not set")),""}}function u(n,t,i,r){switch(n.athenaKeyType){case 0:return i==t;case 1:return r==t;case 2:return r==t;default:return!1}}function ot(n,t){var i={};return n?(t.athenaKeyType==2?ct(t,n,i):(st(t,n,i),ht(t,n,i)),i):i}function st(n,t,f){var a=t.Suggestions?t.Suggestions.split("\t"):[],v=t.ProbSugClickGivenPrefs?t.ProbSugClickGivenPrefs.split("\t"):[],y=t.ClicksOnSugGivenPrefs?t.ClicksOnSugGivenPrefs.split("\t"):[],p=t.ProbSugClickGivenBackground?t.ProbSugClickGivenBackground.split("\t"):[],w=t.Loglikelihoods?t.Loglikelihoods.split("\t"):[],l=t.SuggestionGroups?t.SuggestionGroups.split("\t"):[],b=t.ProbSugClickGivenPrefWeeks?t.ProbSugClickGivenPrefWeeks.split("\t"):[],k=t.ProbSugClickGivenPrefWeekends?t.ProbSugClickGivenPrefWeekends.split("\t"):[],c=n.athenaKeyType==0||!t.SuggestionHandOffTypes?[]:t.SuggestionHandOffTypes.split("\t"),s=a.length,d=e(),o;if(u(n,s,l.length,c.length))for(o=0;o<s;o++){var g=l&&l.length>o?l[o]:"",nt=c&&c.length>o?c[o]:"",tt=r(n,g,nt,""),h=i(a[o],tt);f[h]={SuggestionGroup:+l[o]};p.length==s&&(f[h].ProbSugClickGivenBackground=Number(p[o]));v.length==s&&(f[h].ProbSugClickGivenPref=Number(v[o]));y.length==s&&(f[h].ClicksOnSugGivenPref=Number(y[o]));w.length==s&&(f[h].Loglikelihood=Number(w[o]));n.athenaKeyType!=0&&c.length==s&&(f[h].SuggestionHandOffType=Number(c[o]));f[h].ProbSugClickGivenTime=b.length!=s||d?k.length==s&&d?Number(k[o]):f[h].ProbSugClickGivenPref:Number(b[o])}else SharedLogHelper.LogError("parseLLSignals",null,new Error("Length doesn't match"))}function ht(n,t,f){var a=t.CCRSuggestions?t.CCRSuggestions.split("\t"):[],l=t.CCRSuggestionGroups?t.CCRSuggestionGroups.split("\t"):[],v=t.CCRs?t.CCRs.split("\t"):[],y=t.EventCounts?t.EventCounts.split("\t"):[],c=n.athenaKeyType==0||!t.CCRSuggestionHandOffTypes?[]:t.CCRSuggestionHandOffTypes.split("\t"),p=t.CCRsWeek?t.CCRsWeek.split("\t"):[],w=t.CCRsWeekend?t.CCRsWeekend.split("\t"):[],s=a.length,b=e(),o;if(u(n,s,l.length,c.length))for(o=0;o<s;o++){var k=l&&l.length>o?l[o]:"",d=c&&c.length>o?c[o]:"",g=r(n,k,d,""),h=i(a[o],g);f[h]||(f[h]={SuggestionGroup:Number(l[o])});v.length==s&&(f[h].CCR=Number(v[o]));y.length==s&&(f[h].EventCount=Number(y[o]));n.athenaKeyType!=0&&c.length==s&&(f[h].CCRSuggestionHandOffType=Number(c[o]));f[h].CCRTime=p.length!=s||b?w.length==s&&b?Number(w[o]):f[h].CCR:Number(p[o])}else SharedLogHelper.LogError("parseCCRSignals",null,new Error("Length doesn't match"))}function ct(n,t,i){var s=t.SugTypes?t.SugTypes.split("\t"):[],h=t.HandOffTypes?t.HandOffTypes.split("\t"):[],c=t.PSGPCRs?t.PSGPCRs.split("\t"):[],l=t.PSGCCRs?t.PSGCCRs.split("\t"):[],a=t.PSGSTRs?t.PSGSTRs.split("\t"):[],v=t.PSGSATCCRs?t.PSGSATCCRs.split("\t"):[],y=t.PSGSATPCRs?t.PSGSATPCRs.split("\t"):[],e=s.length,f;if(u(n,e,0,h.length))for(f=0;f<e;f++){var p=s[f],w=h[f],o=r(n,"",w,p);i[o]={};c.length==e&&(i[o].PSGPCR=Number(c[f]));l.length==e&&(i[o].PSGCCR=Number(l[f]));a.length==e&&(i[o].PSGSTR=Number(a[f]));v.length==e&&(i[o].PSGSATCCR=Number(v[f]));y.length==e&&(i[o].PSGSATPCR=Number(y[f]))}else SharedLogHelper.LogError("parseGroupEngagementSignals",null,new Error("Length doesn't match"))}function lt(n,t){var r={},f,l,o,i;if(t){var a=0,v=0,u={};for(f=0,l=t;f<l.length;f++){var y=l[f],e=y.key,p=y.value;u[e]={lexicalSimilarity:0,groupClickCounts:{},groupWeight:{}};v+=s(u,e,n);o=c(p);u[e].groupClickCounts=o.groupLaunches;for(i in u[e].groupClickCounts)r[i]||(r[i]={probability:0,weight:0}),r[i].probability+=o.groupHits[i],a+=o.groupHits[i]}h(r,u,v,a)}return r}function at(n,t){var r={},f,o,i;if(t){var l=0,a=0,u={};for(f=0,o=t;f<o.length;f++){var v=o[f],c=v.key,e=v.value;u[c]={lexicalSimilarity:0,groupClickCounts:{},groupWeight:{}};a+=s(u,c,n);for(i in e)e[i]&&e[i].prefixLaunchCount&&(r[i]||(r[i]={probability:0,weight:0}),u[c].groupClickCounts[i]=e[i].prefixLaunchCount,r[i].probability++,l++)}h(r,u,a,l)}return r}function s(n,t,i){var r=t.length-i.length,u=r/t.length;return n[t].lexicalSimilarity=1-u,n[t].lexicalSimilarity}function h(n,t,i,r){var o=0,s,e,f,u;for(e in t){f=t[e];f.lexicalSimilarity/=i;for(u in f.groupClickCounts)s=f.groupClickCounts[u],f.groupWeight[u]=s*f.lexicalSimilarity,o+=f.groupWeight[u]}for(u in n)n[u].probability/=r;for(e in t){f=t[e];for(u in f.groupClickCounts)n[u]||(n[u]={probability:0,weight:0}),f.groupWeight[u]/=o,n[u].weight+=f.groupWeight[u]}}function c(n){var u=function(n,t,i){return n[t]=n[t]?n[t]+i:i},r={groupLaunches:{},groupHits:{},otherGroupLaunches:0},f,t,i;for(f in n)(t=n[f],t&&t.prefixLaunchCount)&&(i=t.groupType,i||i===0?(u(r.groupLaunches,i,t.prefixLaunchCount),u(r.groupHits,i,1)):r.otherGroupLaunches+=t.prefixLaunchCount);return r}function vt(n,t,i,r){if(r){var f=i(t),u=r[f];u&&(n[266]=u.probability,n[267]=u.weight)}}function e(t){var i=t?t.getDay():n.getCurrentDate().getDay();return i==6||i==0}function yt(n){var i=Object.keys(n);for(var t in i)n[t]||delete n[t]}function pt(n,t){n.featureStore||(n.featureStore={});n.featureStore[t]=1}n.getTextForLexicalFeatures=l;n.stringHashCode=f;n.getEditDistance=t;n.getEditDistanceIgnoreCase=a;n.computeEditDistanceRatio=o;n.isWordBoundary=v;n.countMaxContiguousRepeatedChars=y;n.getNumberOfWords=p;n.containsOnlyDigitsLettersOrSpaces=w;n.endsWithSpace=b;n.prefixIsLikeUrl=k;n.computeUrlFeatures=d;n.computeDomainFeatures=g;n.computeTitleFeatures=nt;n.getSumMruLaunches=it;n.setMRUSignal=rt;n.setMRUBackPropSignal=ut;n.setEngagementSignals=ft;n.setSuggestionGroupEngagementSignals=et;n.getEngagementSignalKey=i;n.getAthenaGroupKey=r;n.checkAthenaGroupLength=u;n.parseWebEngagementSignals=ot;n.computeGroupBackpropagatedClicks=lt;n.computeSuggestionBackpropagatedClicks=at;n.evaluateGroupLaunches=c;n.setMRUGroupBackpropClicks=vt;n.isWeekend=e;n.removeUndefinedAndZeroValues=yt;n.setFlagInFeatureStore=pt;var wt=["http://www.bing.","www.bing.","https://www.bing.","http://cn.bing.","cn.bing.","https://cn.bing.","http://www.google.","www.google.","https://www.google.","http://www.yandex.","www.yandex.","https://www.yandex.","http://www.baidu.","www.baidu.","https://www.baidu.","http://www.yahoo.","www.yahoo.","https://www.yahoo."]}(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(t){var i;(function(i){i.suggestionRankingModels={};var r=function(){function r(n){this._config=n}return r.prototype.rank=function(n,i,r,u,f,e,o,s,h,c){var l,a,v;return n.scope==t.Scope.PathCompletion?this.rankPathCompletion(i):(l=t.isL2(n)?null:{mruGroupRatios:null,maxGroupCCR:null,maxGroupProbSugClickGivenPref:null,mruGroupBackpropWeights:null,mruGroupBackpropRatios:null},this.orderSuggestions(n,i,r,u,e,o,s,h,l,f),this.setGroupSuppressionSignals(l,i),a=this.getTopHitCandidates(n,i,c.searchTheWeb),v=this.createMulticlassClassifierTopHitSuggestionList(a),{topResults:v,mruSuppressions:l})},r.prototype.rankPathCompletion=function(n){var i=n.find(function(n){return n.type==t.LocalSuggestionTypes.CommandLine})||n[0];return{topResults:i?[i]:[],mruSuppressions:null}},r.prototype.orderSuggestions=function(t,r,u,f,e,o,s,h,c,l){var b=this,p=n.safeExecute(function(){return b.createFeatureStore(t,r,u,f,e,o,s,c,l)},"createFeatureStore"),v,a,w,y;if(p=p||r.map(function(){return{}}),a=h?this._config.counterFactualRankerId:this._config.mainRankerId,a?(v=n.safeExecute(function(){return i.suggestionRankingModels[a]},"getRanker"),v||SharedLogHelper.LogError("getRanker",a,new Error("Model not found"))):SharedLogHelper.LogError("getRanker",a,new Error(h?"CounterFactualRankerId not defined ":"MainRankerId not defined")),v)for(w=function(t){var i=p[t],u=n.safeExecute(function(){return v(i)},"calculateRankingScore");r[t].rankingScore=u;r[t].featureStore=i},y=0;y<r.length;y++)w(y);r.sort(function(n,t){return t.rankingScore-n.rankingScore})},r.prototype.getTopHitCandidates=function(n,t,i){var u=this,r=t.filter(function(i){return u.allowInTopHit(n,i,t.length==1)});return this.enableFallbackClassifier(n,t,i)?this.getFallbackClassifierSuggestions(r):r},r.prototype.getFallbackClassifierScore=function(t){var u=this,r=n.safeExecute(function(){return i.suggestionRankingModels[u._config.fallbackClassifierId]},"getFallbackClassifier");return r?n.safeExecute(function(){return r(t.featureStore)},"calculateFallbackClassifierScore"):0},r.prototype.getFallbackClassifierSuggestions=function(r){var u,f;return(r=r.filter(function(n){return n.type!=t.SyntheticQSCodes.SearchTheWeb}),r.length>0)?(u=r[0],u.fbcScore=this.getFallbackClassifierScore(u),f=n.isWebSuggestion(u)?this._config.webFbcScoreThreshold:this._config.nonWebFbcScoreThreshold,u.fbcScore>=f?r.slice(0,i.topHitIsMultiEntity(r)?2:1):[]):[]},r.prototype.enableFallbackClassifier=function(n,i,r){if(r&&this._config.fallbackClassifierId&&i.length>0){var u=i[0];return!u.isAnswer&&t.getGroupType(u)!=t.GroupType.Cortana}return!1},r.prototype.allowInTopHit=function(i,r,u){if(t.isL2(i)&&t.isPhotoOrVideo(r.type)&&!this._config.topHitAllowedForPhotosAndVideosL2||i.topHitRestriction==1&&r.query&&r.query.toLocaleLowerCase()!=i.queryToFetch.toLocaleLowerCase()&&(n.contains(r.features,"ForcePrefixOnTop")||r.features.push("ForcePrefixOnTop"),this._config.forceTypedQueryOnTop))return!1;switch(r.type){case t.SyntheticQSCodes.SearchBingImages:case t.SyntheticQSCodes.SearchBingVideos:return u&&this._config.topHitAllowedForPhotosAndVideosL2;case t.SyntheticQSCodes.SearchTheStore:case t.SyntheticQSCodes.SearchDocumentsFileExplorer:return u}if(t.isMobileCache)switch(r.handoffType){case 2:case 3:return!1;case 1:if(!i.queryToFetch.includes("."))return!1}var f=t.getGroupType(r);switch(f){case t.GroupType.Store:return r.hc;case t.GroupType.PowerBi:return r.hc;case t.GroupType.Command:return r.hc||u;case t.GroupType.LocalPlaces:return this._config.topHitAllowedForLocal}return t.uses3lineTemplate(t.getScope(f))?!1:!0},r.prototype.createMulticlassClassifierTopHitSuggestionList=function(n){for(var r=0,t=0;t<Math.min(n.length,this._config.maxNumberOfTopResults);t++)n[t].rankingScore!==undefined&&n[t].rankingScore>.5&&(r=t);return r==0&&i.topHitIsMultiEntity(n)&&(r=1),n.slice(0,r+1)},r.prototype.createFeatureStore=function(i,r,u,f,e,o,s,h,c){var rt=[],k=0,ut=0,d=0,lt=i.queryToFetch.toLocaleLowerCase(),at=function(n){return t.getGroupType(n)},ft=n.getSumMruLaunches(f),et=0,ot={},g,nt,st,w,tt,v,y,b,it,a,l,p,ht,ct;for(f&&(g=n.evaluateGroupLaunches(f),et=g.otherGroupLaunches,ot=g.groupLaunches),nt=n.computeGroupBackpropagatedClicks(i.queryToFetch,c),st=n.computeSuggestionBackpropagatedClicks(i.queryToFetch,c),w=0,tt=r;w<tt.length;w++)v=tt[w],v.handoffType==2&&(y=t.getAppItem(v),y&&(ut+=y.totalLaunches,y.totalLaunches>k&&(k=y.totalLaunches)),v.deviceItem&&v.deviceItem.rankScore>d&&(d=v.deviceItem.rankScore));for(b=0,it=r;b<it.length;b++)a=it[b],l=this.getSuggestionFeatureStore(lt,a,e,u,ut,s),l[13]=k,l[7]=d,l[60]=t.isMobileCache?1:0,u&&u.WebSignalsAvailable&&(l[93]=1),n.setMRUSignal(t.getSuggestionKey(a,!1),l,f,ft),this.setMRUGroupLaunchRatios(l,a,ft,ot,et,h),n.setMRUBackPropSignal(t.getSuggestionKey(a,!1),l,st),nt&&n.setMRUGroupBackpropClicks(l,a,at,nt),p=n.getTextForLexicalFeatures(this._config,a),p&&(a.handoffType==1&&(n.computeUrlFeatures(p,i.queryToFetch,l,o),ht=n.getDomain(p),n.computeDomainFeatures(a,i.queryToFetch,l,o,ht,this._config,e)),t.isFileOrFolder(a.type)&&(ct=o.cvid+o.privacyNumber+p,l[131]=n.stringHashCode(ct))),n.removeUndefinedAndZeroValues(l),rt.push(l);return rt},r.prototype.setGroupSuppressionSignals=function(n,i){var f,e,u;if(n)for(n.maxGroupCCR={},n.maxGroupProbSugClickGivenPref={},n.mruGroupBackpropRatios={},n.mruGroupBackpropWeights={},f=0,e=i;f<e.length;f++)if(u=e[f],u.featureStore){var r=t.getGroupType(u),o=u.featureStore[94]||0,s=u.featureStore[0]||0;n.maxGroupCCR[r]=n.maxGroupCCR[r]?Math.max(n.maxGroupCCR[r],o):o;n.maxGroupProbSugClickGivenPref[r]=n.maxGroupProbSugClickGivenPref[r]?Math.max(n.maxGroupProbSugClickGivenPref[r],s):s;n.mruGroupBackpropRatios[r]=u.featureStore[266];n.mruGroupBackpropWeights[r]=u.featureStore[267];(n.mruGroupBackpropWeights[r]||n.mruGroupBackpropRatios[r])&&(n.backPropDataExists=!0)}},r.prototype.setMRUGroupLaunchRatios=function(n,i,r,u,f,e){var s,o;if(r){e&&(e.mruGroupRatios={});n[186]=f/r;for(s in u){o=u[s]/r;t.getGroupType(i)==Number(s)&&(n[271]=o);e&&(e.mruGroupRatios[s]=o);switch(Number(s)){case t.GroupType.Apps:n[169]=o;break;case t.GroupType.Settings:n[170]=o;break;case t.GroupType.Cortana:n[171]=o;break;case t.GroupType.Command:n[172]=o;break;case t.GroupType.Photos:n[173]=o;break;case t.GroupType.Videos:n[174]=o;break;case t.GroupType.Music:n[175]=o;break;case t.GroupType.Documents:n[176]=o;break;case t.GroupType.Folders:n[177]=o;break;case t.GroupType.Emails:n[178]=o;break;case t.GroupType.Store:n[179]=o;break;case t.GroupType.SearchSuggestions:n[262]=o;n[180]=u[t.GroupType.Websites]?(u[t.GroupType.Websites]+u[s])/r:o;break;case t.GroupType.Websites:n[263]=o;n[180]=u[t.GroupType.SearchSuggestions]?(u[t.GroupType.SearchSuggestions]+u[s])/r:o;break;case t.GroupType.PathCompletion:n[181]=o;break;case t.GroupType.PowerBi:n[182]=o;break;case t.GroupType.People:n[184]=o;break;case t.GroupType.EdgeHistory:n[185]=o;break;case t.GroupType.Bookmarks:n[260]=o;break;case t.GroupType.LocalPlaces:n[261]=o}}}},r.prototype.getRank=function(n){if(n.type==t.LocalSuggestionTypes.BrowsingHistory)return undefined;if(n.deviceItem&&typeof n.deviceItem.rankScore!="undefined")return n.deviceItem.rankScore;var i=t.asJumpListSuggestion(n),r=i?i.jumpListItem.usagePoints:undefined;return typeof r!="undefined"?r:undefined},r.prototype.getSuggestionFeatureStore=function(i,r,u,f,e,o){var s={},c,b,a,k,l,v,y,p,h,w,g,nt,d;return this.setTypeSignal(r,s),c=t.getAppItem(r),c?(s[2]=c.totalLaunches,e>0&&(s[103]=c.totalLaunches/e),s[92]=c.launchArguments?1:0,this.addLastAccessDate(c.lastAccessed,s)):(b=t.asJumpListSuggestion(r),this.addLastAccessDate(b?b.jumpListItem.lastAccessed:null,s)),a=t.getBrowsingHistoryItem(r),a&&(a.visitCount&&(s[138]=a.visitCount),this.addLastAccessDate(a.dateVisited,s)),s[96]=r.catalogScore,s[97]=r.avgRating,s[98]=r.ratingCount,s[99]=r.confidence,s[150]=r.source,s[283]=r.pinnedToTaskbar?1:undefined,r.hc&&(s[189]=1),s[17]=r.highConfidenceMetaSuggestionScore,k=this.getRank(r),typeof k!="undefined"?s[16]=k:s[4]=1,l=r,l.matchedOnlyOnContent&&(s[259]=1),l.matchedOnlyOnAuthor&&(s[273]=1),l.lastModifiedDate&&(s[268]=n.getTimeDiffInDays(l.lastModifiedDate)),l.extensionLC==".lnk"&&(s[272]=1),s[23]=r.prefetchConfidenceScore,s[264]=f&&f.ProbNextKS!==undefined?f.ProbNextKS:-1,this.setThresholdRatios(s,f),this.setRatios(s,f),v=t.getGroupType(r),y=r.query,r.type==t.SyntheticQSCodes.SearchTheWeb&&(y="SearchTheWeb"),p=n.getAthenaGroupKey(this._config,String(v),String(r.handoffType),r.type),n.setEngagementSignals(s,u,p,y,!1,!1),n.setEngagementSignals(s,o,p,y,!1,!0),o&&!u&&n.setEngagementSignals(s,o,p,y,!1,!1),s[10]=i.length,(r.isAnswer||v==t.GroupType.Cortana)&&(s[11]=1),h=n.getTextForLexicalFeatures(this._config,r),w=h?h.toLocaleLowerCase():null,h&&this.supportLexicalFeaturesV1(r)||(s[65]=1),h&&this.supportLexicalFeaturesV2(r,!1)||(s[132]=1),w==i&&(this.supportLexicalFeaturesV1(r)&&(s[20]=1),this.supportLexicalFeaturesV2(r,!1)&&(s[133]=1)),r.handoffType==2&&(s[8]=1,t.isSetting(r.type)&&(s[64]=1),t.isApp(r.type)&&(s[83]=1)),v==t.GroupType.SearchSuggestions&&(r.type!=t.SyntheticQSCodes.SearchTheWeb&&(s[82]=1),s[25]=1),g=s[65]==1,g?s[15]=i.length:(s[15]=h.length,s[14]=n.getEditDistance(i,w),s[22]=Math.min(100,n.computeEditDistanceRatio(s[14],i.length,h.length)),s[70]=n.isWordBoundary(i,h),s[265]=Math.abs(h.length-i.length)),nt=s[132]==1,nt?s[137]=i.length:(s[137]=h.length,s[134]=n.getEditDistance(i,w),s[135]=Math.min(100,n.computeEditDistanceRatio(s[134],i.length,h.length)),s[136]=n.isWordBoundary(i,h),this.supportLexicalFeaturesV2(r,!0)&&(s[265]=Math.abs(h.length-i.length)),s[284]=Math.abs(h.length-i.length)),s[8]==1&&(s[27]=s[20]),(r.isAnswer||v==t.GroupType.Cortana)&&(s[55]=s[20]),(r.type==t.OnlineSuggestionTypes.SearchHistory||r.fromHistory)&&(s[121]=1),s[41]=s[83]==1?s[40]:s[64]==1?s[39]:s[11]==1?s[32]:s[89]==1?s[54]:s[85]==1?s[30]:s[86]==1?s[53]:s[87]==1?s[52]:s[61]==1?s[31]:s[88]==1?s[51]:s[63]==1?s[35]:s[82]==1?s[29]:s[90]==1?s[50]:s[59]==1?s[34]:s[37],(t.isSetting(r.type)||t.isApp(r.type))&&(d=r.ciMetaData,this.computeConstraintIndexFeatures(r.deviceItem,s,d),r.ciMatchedQuery=this.getConstraintIndexMatchedQuery(d)),r.signals&&(s[230]=r.signals.DistanceToEntity,s[231]=r.signals.DistanceToEntityPrecision,s[232]=r.signals.RankingScore),s},r.prototype.supportLexicalFeaturesV1=function(n){return!n.mayContainPII},r.prototype.supportLexicalFeaturesV2=function(n,i){return!i||!n.mayContainPII||t.isFileOrFolder(n.type)},r.prototype.addLastAccessDate=function(t,i){var r=n.getTimeDiffInDays(t);r!=null?i[9]=r:i[19]=1},r.prototype.setTypeSignal=function(n,i){switch(n.type){case t.LocalSuggestionTypes.StartMenuDocument:case t.LocalSuggestionTypes.Document:i[61]=1;break;case t.LocalSuggestionTypes.Photo:i[85]=1;break;case t.LocalSuggestionTypes.Video:i[86]=1;break;case t.LocalSuggestionTypes.Music:i[87]=1;break;case t.LocalSuggestionTypes.Folder:i[88]=1;break;case t.LocalSuggestionTypes.CommandLine:i[89]=1;break;case t.LocalSuggestionTypes.PathCompletion:i[90]=1;break;case t.LocalSuggestionTypes.App:i[1]=1;break;case t.OnlineSuggestionTypes.Deeplink:case t.OnlineSuggestionTypes.DirectNav:i[21]=1;break;case t.OnlineSuggestionTypes.Store:i[63]=1;break;case t.SyntheticQSCodes.SearchTheWeb:i[59]=1}},r.prototype.setRatios=function(n,t){t&&t.AppsRatio!==undefined&&(n[26]=t.AppsRatio,t.SettingsRatio&&(n[5]=t.SettingsRatio),t.StoreRatio&&(n[57]=t.StoreRatio),t.PrefixProbability&&(n[12]=t.PrefixProbability),t.FilesRatio&&(n[24]=t.FilesRatio),t.WebRatio&&(n[18]=t.WebRatio),t.PhotosVideosMusicRatio&&(n[28]=t.PhotosVideosMusicRatio),t.ContactsRatio&&(n[56]=t.ContactsRatio),t.LocalProtocolRatio&&(n[91]=t.LocalProtocolRatio))},r.prototype.setThresholdRatios=function(n,t){t&&t.ThApps!==undefined?(n[40]=t.ThApps,t.ThStore&&(n[35]=t.ThStore),t.ThSetting&&(n[39]=t.ThSetting),t.ThCortAns&&(n[32]=t.ThCortAns),t.ThPrefixCount&&(n[38]=t.ThPrefixCount),t.ThWeb&&(n[29]=t.ThWeb),t.ThSearchTheWeb&&(n[34]=t.ThSearchTheWeb),t.ThOther&&(n[37]=t.ThOther),t.ThSearchMyStuff&&(n[36]=t.ThSearchMyStuff),t.ThFile&&(n[31]=t.ThFile),t.ThFolder&&(n[51]=t.ThFolder),t.ThPath&&(n[50]=t.ThPath),t.ThEmail&&(n[33]=t.ThEmail),t.ThCommAns&&(n[54]=t.ThCommAns),t.ThPhotoAns&&(n[30]=t.ThPhotoAns),t.ThVideoAns&&(n[53]=t.ThVideoAns),t.ThMusicAns&&(n[52]=t.ThMusicAns),t.ThDNav&&(n[147]=t.ThDNav)):n[42]=1},r.prototype.computeConstraintIndexFeatures=function(n,t,i){var u,o,f,e,s,r;if(n&&n.rawIndexResponse){if(!i)return;if(t[157]=i.GrammarScore,t[158]=i.MatchScore,i.Parses&&i.Parses.length>0&&i.Parses[0].Entities&&i.Parses[0].Entities.length>0)for(u=0,o=i.Parses[0].Entities;u<o.length;u++)if(f=o[u],t[159]=f.EntityScore,f.Attributes)for(e=0,s=f.Attributes;e<s.length;e++)r=s[e],r.Name=="gscore"?t[269]=Number(r.Value):r.Name=="lscore"&&(t[270]=Number(r.Value))}},r.prototype.getConstraintIndexMatchedQuery=function(n){return!n||n.MatchScore==0?null:n.Query},r}();i.FastRankRanker=r})(i=t.Ranking||(t.Ranking={}))})(t=n.WSB||(n.WSB={}))}(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(t){var i;(function(i){function e(n,i){var r,u;return i?(r=t.getKnownFolderPathLC(t.FOLDERID_SkyDrive),r?r+="\\":r="\\onedrive\\",u=n.indexOf(r),u>=0&&(n=n.substr(u+r.length))):n.startsWith("onedrive:\\")&&(n=n.substr(10)),n}function o(n,i){var r,u,f;return i?(r=t.getKnownFolderPathLC(t.FOLDERID_Profile)+"\\onedrive - ",u=n.indexOf(r),u>=0&&(f=n.indexOf("\\",u+r.length),n=n.substr(f+1))):n.startsWith("onedrive for business:\\")&&(n=n.substr(23)),n}function r(n,t){return!n.suppressed&&n.handoffType==0&&!n.answerHtml&&(!n.query||n.query.toLocaleLowerCase()==t.queryToFetch.toLocaleLowerCase())}function s(n){return n.length>=2&&n[0].type==t.OnlineSuggestionTypes.Entity&&n[1].type==t.OnlineSuggestionTypes.Entity}var u={"Microsoft.Windows.ControlPanel":"ControlPanel","Microsoft.AutoGenerated.{923DD477-5846-686B-A659-0FCCD73851A8}":"Classic_{E9C71548-B580-43B2-ACDB-1BA924002754}","{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\dfrgui.exe":"Classic_{7D13A5DB-6081-48BD-8EA3-A9D7FE67A335}","{6D809377-6AF0-444B-8957-A3773F02200E}\\Windows Defender\\MSASCui.exe":"NameSpace_Classic_{D8559EB9-20C0-410E-BEDA-7ED416AECC2A}","{1AC14E77-02E7-4E5D-B744-2EB1AE5198B7}\\cleanmgr.exe":"Classic_{AACA901F-E74F-4894-B074-F55059532853}","Microsoft.AutoGenerated.{BB044BFD-25B7-2FAA-22A8-6371A93E0456}":"Classic_{45FDB5DF-1457-4A41-A824-7AD9C75767BC}","Microsoft.Windows.PCSettings.DefaultApps":"AAA_SettingsPageAppsDefaults"},f={"NameSpace_Classic_{F942C606-0914-47AB-BE56-1321B8035096}":"Classic_{232A1851-808C-4B44-A92A-38E862989CE5",AAA_Proxy_Automatic_Config_Group:"AAA_SettingsPageNetworkProxy",AAA_Settings_DeveloperModeGroup:"AAA_SettingsPageRestoreDeveloperOptions",AAA_SystemSettings_Users_PicturePassword:"AAA_SettingsGroupPicturePassword"},h;i.isWebSuggestionForPrefix=r;i.topHitIsMultiEntity=s;h=function(){function i(n,t,i,r,u,f,e,o){this._config=n;this._host=t;this._instrumentationHelper=i;this._navigationHelper=r;this._webSignalsCache=u;this._ranker=f;this._renderedTopResults=e;this._previewPane=o}return i.prototype.launchWebSearch=function(n,t,i,r){var u=n.queryToFetch;this._host.launchSearch(u,this._navigationHelper.getSearchUrl(n.fullPartialQuery,u,i,null,r),t)},i.prototype.getProtocol=function(i,r){var o=this,f=t.SyntheticQSCodes.Protocol,u=this._instrumentationHelper.getInstrumentedSyntheticSuggestion(r,f),e;return u?u:(u=t.createSuggestion(null,this._host.getEdgeIcon,null,f,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(f,t.SyntheticQSCodes.KValues),1,r,!1,"tp",function(){return o._host.launchUrl(u.url)}),e=function(i){var r=n.prettyPrintUrl(i.fixedUrl,i.queryToFetch,!1);u.url=i.fixedUrl;u.tooltip=i.fixedUrl;u.text=HitHighlightingParser.addMarkers(r);u.narratorText=t.getNarratorText(u,o._host.getLocString("DirectNavSuggestion"))},e(i),u.updateFromQuery=function(n){return n.isProtocol?(e(n),!0):!1},this._instrumentationHelper.instrumentSyntheticSuggestion(r,u),u)},i.prototype.getSearchSuggestion=function(i,r,u,f,e,o,s,h){var c=this._instrumentationHelper.getInstrumentedSyntheticSuggestion(r,u),a,l;return c?c:(a=i.scope,c=t.createSuggestion(null,null,f,u,null,n.InstrumentedItem.getNonSuggestionInstrumentedItem(u,t.SyntheticQSCodes.KValues),e,r,!1,u),c.secondaryText=o,c.secondaryTextClass=t.CssClass_Annotation,s&&(c.additionalInfoText=" - "+c.secondaryText),l=function(n){var i=n.queryToFetch.toLocaleLowerCase();c.text=HitHighlightingParser.addMarkers(i);c.narratorText=t.getNarratorText(c);c.click=function(){return h(c,n)}},l(i),c.updateFromQuery=function(n){return!n.isProtocol&&n.scope==a&&n.queryToFetch?(l(n),!0):!1},this._instrumentationHelper.instrumentSyntheticSuggestion(r,c),c)},i.prototype.getWebSearch=function(n,t,i,r,u,f,e){var o=this,s=!!e;return this.getSearchSuggestion(n,t,i,r,u,f,s,function(n,t){return o.launchWebSearch(t,n.useRaf,i,e)})},i.prototype.getExplorerSearch=function(n,i){var u=this,r=this.getSearchSuggestion(n,i,t.SyntheticQSCodes.SearchDocumentsFileExplorer,{content:t.SegoeFontIcons.FileExplorer,type:1},2,this._host.getLocString("SearchInFileExplorer"),!0,function(n,t){return u._host.launchSearchInFileExplorer(t.queryToFetch.toLocaleLowerCase())});return t.shouldSetThisPcGroupSource(t.GroupType.Documents,n,this._config)&&(r.sourceForGroup=1),r},i.prototype.getStoreSearch=function(n,i){var r=this;return this.getSearchSuggestion(n,i,t.SyntheticQSCodes.SearchTheStore,{content:t.CortanaFontIcons.StoreLogo,type:2},3,this._host.getLocString("SearchForAppsInTheStore"),!0,function(n,t){return r._host.launchStoreSearch(t.queryToFetch)})},i.prototype.getRecourse=function(i,r){if(!i.queryToFetch)return null;switch(t.getScopeFromTaskFrame(i.taskFrame,i.scope)){case t.Scope.Apps:return n.isBingEnabledCache?this.getStoreSearch(i,r):null;case t.Scope.Documents:return this.getExplorerSearch(i,r);case t.Scope.Photos:return n.isBingEnabledCache?this.getWebSearch(i,r,t.SyntheticQSCodes.SearchBingImages,{content:t.CortanaFontIcons.Photo2,type:2},9,this._host.getLocString("SearchForWebImages"),"images"):null;case t.Scope.Videos:return n.isBingEnabledCache?this.getWebSearch(i,r,t.SyntheticQSCodes.SearchBingVideos,{content:t.SegoeFontIcons.Video,type:1},9,this._host.getLocString("SearchForWebVideos"),"videos"):null;default:return null}},i.prototype.getSyntheticSuggestions=function(i,r){var f=i.queryToFetch&&n.isSuggestionTypeEnabled(n.WebDataSource,t.SyntheticQSCodes.SearchTheWeb,0,i,this._config)?this.getWebSearch(i,r,t.SyntheticQSCodes.SearchTheWeb,t.getSearchSuggestionIcon(),0,t.getWebSuggestionAnnotation(this._host),""):null,e=i.isProtocol?this.getProtocol(i,r):null,u=this.getRecourse(i,r);return u&&(u.rankingScore=-Number.MAX_VALUE),{protocol:e,searchTheWeb:f,recourse:u}},i.prototype.canHaveDuplicates=function(i,r){switch(i){case n.WebDataSource:case n.MRUDataSource:case t.DataSources.BingApps:case t.DataSources.BingSettings:case t.DataSources.LocalApps:case t.DataSources.IndexerBasedApps:case t.DataSources.LocalRecentApps:case t.DataSources.LocalSettings:case t.DataSources.LocalDocumentsAndFolders:case t.DataSources.LocalMedia:case t.DataSources.CommandLine:case t.DataSources.PathCompletion:case t.DataSources.MRUApps:case t.DataSources.MRUSettings:case t.DataSources.MRUFilesAndFolders:case t.DataSources.OneDrive:case t.DataSources.MyStuffOneDrive:case t.DataSources.MyStuffDocuments:case t.DataSources.MyStuffFolders:case t.DataSources.MyStuffPhotos:case t.DataSources.MyStuffVideos:case t.DataSources.MyStuffMusic:case t.DataSources.EdgeBrowsingHistory:case t.DataSources.SubstrateSuggestionsEnterprise:case t.DataSources.SubstrateSuggestionsConsumer:return!0;case t.DataSources.SubstrateSearchConsumer:case t.DataSources.PowerBi:return!1;case t.DataSources.SubstrateSearchEnterprise:return r.scope==t.Scope.Documents}throw new Error("New data source "+i+" needs to be explicity classified as needed deduping with other data sources or not");},i.prototype.canHaveDuplicatesWithinDataSource=function(i){switch(i){case t.DataSources.MRUApps:case t.DataSources.MRUSettings:case t.DataSources.IndexerBasedApps:case n.MRUDataSource:return!0;case t.DataSources.LocalDocumentsAndFolders:case t.DataSources.LocalMedia:return this._config.showShortcutFilesInL1;case t.DataSources.MyStuffDocuments:case t.DataSources.MyStuffFolders:case t.DataSources.MyStuffPhotos:case t.DataSources.MyStuffVideos:case t.DataSources.MyStuffMusic:return!0}return!1},i.prototype.isDuplicate=function(i,r,s){var l,a,h,c,d,g,k,v,y,w,b;if(n.contains([5,4],r.handoffType)&&n.contains([5,4],s.handoffType)&&r.actionUri==s.actionUri&&r.query.toLocaleLowerCase()==s.query.toLocaleLowerCase()||r.handoffType==10&&s.handoffType==10&&r.type==s.type&&!r.answerHtml&&!s.answerHtml&&r.query.toLocaleLowerCase()==s.query.toLocaleLowerCase()||r.type!=t.SyntheticQSCodes.Protocol&&r.handoffType==1&&s.handoffType==1&&n.isDuplicateUrl(i,r.url,s.url))return!0;if(l=t.getAppItem(r),a=t.getAppItem(s),h=l?l.filePath:r.path,h&&(h=h.toLocaleLowerCase()),c=a?a.filePath:s.path,c&&(c=c.toLocaleLowerCase()),d=t.getCommandLineItem(r),g=t.getCommandLineItem(s),d&&a||g&&l){var nt=h||c,p=d||g,tt=p.encodedPath;return nt&&tt&&nt==tt.toLocaleLowerCase()?(k=l||a,!p.launchArguments||(k.launchArguments||"").toLocaleLowerCase()==p.launchArguments.toLocaleLowerCase()||!k.launchArguments&&p.launchArguments&&k.displayName.toLocaleLowerCase().startsWith(p.displayName.toLocaleLowerCase())):!1}if(r.deviceItem&&s.deviceItem){if(v=r.deviceItem.id||"",y=s.deviceItem.id||"",v.toLocaleLowerCase()==y.toLocaleLowerCase())return!0;if(l){if(t.isSetting(s.type)&&u[v]==y)return!0}else if(t.isSetting(r.type)&&(a&&u[y]==v||t.isSetting(s.type)&&(f[v]==y||f[y]==v)))return!0}return h&&c&&(h==c||!l&&!a&&r.handoffType!=s.handoffType&&((h=e(h,r.handoffType!=7),c=e(c,s.handoffType!=7),h==c)||(h=o(h,r.handoffType!=8),c=o(c,s.handoffType!=8),h==c))||(w=r.targetPathLC,b=s.targetPathLC,n.isDataSourceEnabled(t.DataSources.IndexerBasedApps,i,this._config)&&(l&&(h=t.resolveKnownFolderGUIDsInPath(h)),a&&(c=t.resolveKnownFolderGUIDsInPath(c))),(w&&b&&w==b||w&&w==c||b&&h==b||h==c)&&(!l||!a||(l.launchArguments||"").toLocaleLowerCase()==(a.launchArguments||"").toLocaleLowerCase())))?!0:this.isCortanaSettingDuplicate(r,s)||this.isCortanaSettingDuplicate(s,r)?!0:r.type==t.OnlineSuggestionTypes.Person&&s.type==t.OnlineSuggestionTypes.Person&&r.email.toLocaleLowerCase()==s.email.toLocaleLowerCase()?!0:!1},i.prototype.isCortanaSettingDuplicate=function(n,t){return n.handoffType==5&&n.actionUri=="ms-cortana://navigate/Settings"&&t.deviceItem&&t.deviceItem.id=="CortanaSettings"},i.prototype.rank=function(i,u,f,e,o,s,h,c){var ct=this,g,b,nt,ut,w,ft,et,k,tt,ot;t.isL2(e)&&(h=!1);var y=f[n.WebDataSource],it=y?y.rankingSignals:null,lt=y?y.webTopResultRoutingType:1,d=f[n.MRUDataSource],st=null,l=null,ht=null;it&&(it.WebSignalsAvailable=!0,st=y.engagementSignals,l=y.suppressedGroups);this._webSignalsCache&&(ht=this._webSignalsCache.getPreviousEventData(e.queryToFetch));var at=d?d.RankingSignals:null,vt=d?d.LookupCompletions:null,yt={cvid:this._host.getConversationId(),privacyNumber:this._host.getPrivacyNumber()},a=this.getSyntheticSuggestions(e,s);u=u.slice();l&&(l.fullySuppressedGroups&&l.fullySuppressedGroups.length>0&&(u=u.filter(function(t){return!n.contains(l.fullySuppressedGroups,String(ct.getGroupTypeForSuppressions(t)))})),l.suppressedSuggestions&&l.suppressedSuggestions.length>0&&(u=u.filter(function(i){return!n.contains(l.suppressedSuggestions,t.getSuggestionKey(i,!0))})));i.length==0&&a.protocol&&u.unshift(a.protocol);g=o.length==1&&o[0].childSuggestions&&o[0].childSuggestions.some(function(n){return n.displayed});b=this._ranker.rank(e,this.getSuggestionsToRank(g,i,u,a,s),it,at,vt,st,yt,ht,c,a);i.length==0&&a.recourse&&u.push(a.recourse);var p=this.determineTopResults(o,u,b,a,e,s,g),rt=i.filter(function(t){return!n.contains(o,t)}),v=this.determineSuggestionsToAddToGroups(rt,u,o,p,a,e,g,h);if(b.mruSuppressions&&b.mruSuppressions.backPropDataExists)this.applyMRUSuppressions(b,o,p,v,e);else if(l&&l.partiallySuppressedGroups&&this.canPartiallySuppressGroups(p,v))for(nt=0,ut=v;nt<ut.length;nt++)w=ut[nt],r(w,e)||(ft=this.getGroupTypeForSuppressions(w),this.canBePartiallySuppressed(w,ft)&&n.contains(l.partiallySuppressedGroups,String(ft))&&(n.contains(o,w)||(w.suppressed=!0)));return et=[],this.removeProtocolIfDuplicate(e,a,p,rt,v,et),this.setUseRafFlag(p,v,e,lt),k=this.getGroupOrder(e,v,rt),tt=e.forceGroupOnTop,tt!=undefined&&(ot=k.findIndex(function(n){return t.sameGroup(n,tt)}),ot>=0&&(k.splice(ot,1),k.unshift(tt))),{topResults:p,suggestionsToAdd:v,suggestionsToRemove:et,groupOrder:k}},i.prototype.applyMRUSuppressions=function(i,u,f,e,o){var c,l,a,h,s;if(this.canPartiallySuppressGroups(f,e))for(c={},l=0,a=e;l<a.length;l++)if(h=a[l],!r(h,o)&&(s=t.getGroupType(h),this.canBePartiallySuppressed(h,s))){if(!c[s]){var v=i.mruSuppressions.maxGroupCCR?i.mruSuppressions.maxGroupCCR[s]||0:0,y=i.mruSuppressions.maxGroupProbSugClickGivenPref?i.mruSuppressions.maxGroupProbSugClickGivenPref[s]||0:0,p=i.mruSuppressions.mruGroupRatios?i.mruSuppressions.mruGroupRatios[s]||0:0,w=i.mruSuppressions.mruGroupBackpropRatios?i.mruSuppressions.mruGroupBackpropRatios[s]||0:0,b=i.mruSuppressions.mruGroupBackpropWeights?i.mruSuppressions.mruGroupBackpropWeights[s]||0:0,k=3.34728026*v+3.523466*y+3.72204852*p+.5865976*w+1.37432766*b-1.75450325,d=1/(1+Math.exp(-k));c[s]=d}h.mruSuppressionScore=c[s];h.mruSuppressionScore<.5&&(n.contains(u,h)||(h.suppressed=!0))}},i.prototype.allowedInGroups=function(n){return n.isAnswer?n.allowedInGroups:!0},i.prototype.getGroupTypeForSuppressions=function(n){var i=t.getGroupType(n);return this._config.useWebSuppressionsForLocal&&i==t.GroupType.LocalPlaces?t.GroupType.SearchSuggestions:i},i.prototype.canBePartiallySuppressed=function(n,i){return!this._config.enablePartialSuppressionsForSubstrateSuggestions&&(n.handoffType==8||n.type==t.OnlineSuggestionTypes.Bookmark)?!1:t.getScope(i)!=t.Scope.All},i.prototype.canPartiallySuppressGroups=function(n,i){return n.every(function(n){return t.getGroupType(n)==t.GroupType.SearchSuggestions})&&i.every(function(n){return t.getGroupType(n)==t.GroupType.SearchSuggestions})?!1:!0},i.prototype.isProtocolDuplicate=function(i,r,u){return i==u?!1:i.type==t.OnlineSuggestionTypes.DirectNav?!0:i.handoffType==1&&n.isDuplicateUrl(r,i.url,u.url)},i.prototype.removeProtocolIfDuplicate=function(t,i,r,u,f,e){var h=this,o,s;i.protocol&&(o=function(n){return!n.suppressed&&h.isProtocolDuplicate(n,t,i.protocol)},(r.some(o)||u.some(o)||f.some(o))&&(n.tryRemove(r,i.protocol)?r.length||(s=n.removeFirstWhere(u,o)||n.removeFirstWhere(f,o),r.push(s)):n.tryRemove(f,i.protocol)||n.contains(u,i.protocol)&&e.push(i.protocol),i.protocol=null))},i.prototype.getSuggestionsToRank=function(i,r,u,f){i&&(r=r.filter(function(n){return!t.asChildSuggestion(n)}));f.recourse&&(r=r.filter(function(n){return n!=f.recourse}));var e=r.concat(u);return f.searchTheWeb&&!n.contains(r,f.searchTheWeb)&&e.push(f.searchTheWeb),e},i.prototype.determineTopResults=function(i,u,f,e,o,h,c){var l,w,v,y,p,k,d,b,g,a;if(c)return i;for(l=this._config.forceVoiceFlowOnTopHit||!o.queryToFetch?[]:f.topResults,w=this._previewPane?this._previewPane.getPreviewedSuggestionToForceTopHit():null,w&&this._ranker.allowInTopHit(o,w,!0)&&(v=function(n){return t.isEquivalentForPreviewPanePurposes(o,w,n)},y=l.findIndex(v),y!=0&&(p=void 0,y>0?(p=l[y],l.splice(y,1)):p=i.find(v)||u.find(v)||(e.searchTheWeb?[e.searchTheWeb]:[]).find(v),p&&l.unshift(p))),e.protocol&&e.searchTheWeb&&this._ranker.allowInTopHit(o,e.protocol,!0)&&n.tryRemove(l,e.searchTheWeb),e.searchTheWeb&&(k=l.indexOf(e.searchTheWeb),k>=0&&l.some(function(n){return n!=e.searchTheWeb&&r(n,o)})&&l.splice(k,1)),l.length==0&&(e.protocol&&this._ranker.allowInTopHit(o,e.protocol,!0)?l.push(e.protocol):e.searchTheWeb&&this._ranker.allowInTopHit(o,e.searchTheWeb,!0)?l.push(e.searchTheWeb):e.recourse&&this._ranker.allowInTopHit(o,e.recourse,!0)&&l.push(e.recourse)),d=this._config.maxNumberOfTopResults==1&&s(l)?2:this._config.maxNumberOfTopResults,l.length>d&&(l=l.slice(0,d)),b=0,g=i;b<g.length;b++)a=g[b],n.contains(l,a)||(a.useRaf&&(a.useRaf=!1),a!=e.searchTheWeb&&u.unshift(a));return l.forEach(function(n){return n.suppressed=!1}),l},i.prototype.setUseRafFlag=function(n,i,r,u){var e,s,o,h,f;if(t.isCortanaEnabledCache)if(u==2||this._config.forceVoiceFlowOnTopHit)for(e=0,s=n;e<s.length;e++)f=s[e],f.handoffType!=0||f.isAnswer||(f.useRaf=!0);else for(o=0,h=n;o<h.length;o++)f=h[o],f.handoffType==0&&!f.isAnswer&&this._host.matchesVcd(f.query||r.queryToFetch)&&(f.useRaf=!0)},i.prototype.determineSuggestionsToAddToGroups=function(i,u,f,e,o,s,h,c){var y=this,l=u.filter(function(t){return!n.contains(e,t)}),p=[],a,v,w;for(l.forEach(function(n,i){y.allowedInGroups(n)||(t.getScope(t.getGroupType(n))==t.Scope.All?p.push(i):n.suppressed=!0)}),a=p.length-1;a>=0;--a)l.splice(a,1);return o.searchTheWeb&&n.contains(e,o.searchTheWeb)&&n.removeFirstWhere(l,function(n){return r(n,s)}),v=l.filter(function(i){return i.handoffType==5||n.contains([t.GroupType.SearchSuggestions,t.GroupType.Websites],t.getGroupType(i))}),w=l.filter(function(n){return n.handoffType==8||y._config.enforceOriginalOrderForTypes[n.type]}),!h&&this.canRenderChildSuggestions(e,c)&&this.addChildSuggestions(e[0],l),s.queryToFetch&&l.sort(function(n,t){return t.rankingScore-n.rankingScore}),this.insertDefaultSearchTheWeb(s,o,e,i,l,v),l=this.insertSuggestionsToRightPlace(l,w),this.insertSuggestionsToRightPlace(l,v)},i.prototype.insertDefaultSearchTheWeb=function(n,i,u,f,e,o){var s,h;i.searchTheWeb&&(n.scope==t.Scope.Web||n.scope==t.Scope.All)&&(s=o.findIndex(function(t){return r(t,n)}),f.some(function(t){return r(t,n)})||u.some(function(t){return r(t,n)})?s!=-1&&(h=o[s],o.splice(s,1),e.splice(e.indexOf(h),1)):s==-1&&(o.unshift(i.searchTheWeb),e.unshift(i.searchTheWeb)))},i.prototype.getGroupOrder=function(n,i,r){var f,c,e,o,l,s,v,h,a,u;switch(n.scope){case t.Scope.Web:if(!n.queryToFetch)return[{type:t.GroupType.EdgeHistory},{type:t.GroupType.Websites},{type:t.GroupType.SearchSuggestions}];break;case t.Scope.Apps:return[{type:t.GroupType.Apps},{type:t.GroupType.Store}];case t.Scope.Photos:return[{type:t.GroupType.Photos},{type:t.GroupType.SearchSuggestions}];case t.Scope.Videos:return[{type:t.GroupType.Videos},{type:t.GroupType.SearchSuggestions}]}for(f=r.concat(i),f.sort(function(n,t){return t.rankingScore-n.rankingScore}),c=[],e=[],o=0,l=f;o<l.length;o++)u=l[o],u.suppressed?e.push(u):c.push(u);for(e.length!=0&&(f=c.concat(e)),s=[],v=function(n){var r=t.getGroupType(n),i={type:r,source:n.sourceForGroup};s.some(function(n){return t.sameGroup(n,i)})||s.push(i)},h=0,a=f;h<a.length;h++)u=a[h],v(u);return s},i.prototype.addChildSuggestions=function(t,i){var r=this;t.calculateChildSuggestions&&t.calculateChildSuggestions();t.childSuggestions&&t.childSuggestions.length>0&&Object.keys(this._config.topHitChildGroups).forEach(function(u,f){var e=parseInt(u),o=n.contains(r._config.suppressedTopHitChildGroups,e)?0:r._config.topHitChildGroups[u],s;o>0&&(s=t.childSuggestions.filter(function(n){return n.groupType==e}).slice(0,o),s.forEach(function(n,t){n.rankingScore=1e4-100*f-t;i.push(n)}))})},i.prototype.canRenderChildSuggestions=function(n,i){if(n.length!=1)return!1;if(!i)return!0;if(this._renderedTopResults.topResults.length==1){var u=n[0],r=this._renderedTopResults.topResults[0];return r.hasChildSuggestionsDisplayed&&r.query==u.query&&t.getGroupType(r)==t.getGroupType(u)}return!1},i.prototype.insertSuggestionsToRightPlace=function(t,i){var r,e,u,f;if(i.length==0)return t;for(r=[],e=i[0],u=0;u<t.length;u++)f=t[u],f==e?r=r.concat(i):n.contains(i,f)||r.push(f);return r},i}();i.Aggregator=h})(i=t.Ranking||(t.Ranking={}))})(t=n.WSB||(n.WSB={}))}(AutoSuggest||(AutoSuggest={})),function(n){var t=function(){function t(n,t,i,r,u){var f=this;this._config=n;this._instrumentationHelper=i;this._sequenceNumberReader=r;this._page=u;this._itemLaunchEventHandlers=[];this.groups=[];this.topResults=[];this._lastUpdatedSequenceNumber=-1;this._topResultsRenderingDisabled=!1;this._groupRenderingDisabled=!1;t.bindDismissed(function(){f.topResults=[];f.renderTopResults();f.groups=[];f.renderGroups();f._partialQuery=null;f._lastUpdatedSequenceNumber=-1});t.bindShown(function(){f._selectedItem=null})}return t.prototype.bindItemLaunch=function(n){this._itemLaunchEventHandlers.push(n)},t.prototype.onSuggestionLaunch=function(n,t){this._itemLaunchEventHandlers.forEach(function(i){return i(n,t)})},t.prototype.onQueryChanged=function(n){this._partialQuery=n},t.prototype.getCurrentTopResults=function(){return this.topResults.slice(0)},t.prototype.getTopResultsWhichFitInCanvas=function(n){return n},t.prototype.updateTopResults=function(t,i,r,u,f,e){var o=this,a,s,h,y;t!=(u!=this._lastUpdatedSequenceNumber)&&SharedLogHelper.LogError("updateTopResult",t+" != (sequenceNumber "+u+" != lastUpdateSequenceNumber "+this._lastUpdatedSequenceNumber+")",new Error("Precondition failed"));this._lastUpdatedSequenceNumber=u;t&&(this.groups=[],this.onGroupsCleared());a=this._selectedItem;s=this.topResults;i=this.getTopResultsWhichFitInCanvas(i);h=!n.sequenceEqual(i,s);h&&(this.topResults=i.slice(0));var c=!1,l=h?i.length:0,v=function(){c&&l==0&&(o._instrumentationHelper.instrumentTopResultRendered(u,i.map(function(n){return n.type})),c=!1)};return h?(this.renderTopResultsAfter(function(){for(var h,t=0,i=o.topResults;t<i.length;t++)h=i[t],n.contains(s,h)?l-=1:o.setupIcon(u,h,!0,function(){l-=1;v()});o.onBeforeRenderTopResults(s,f,r,e)}),c=!0):(y=this.onBeforeRenderTopResults(s,f,r,e),y==0&&(this.renderTopResults(),c=!0)),this._selectedItem&&(a!=this._selectedItem||t)&&n.contains(this.topResults,this._selectedItem)&&this._page.render(function(){var n=_ge(o._selectedItem.id);n&&(n.setAttribute("aria-selected","false"),n.setAttribute("aria-selected","true"))}),[h,v]},t.prototype.setupIcon=function(n,t,i,r){r()},t.prototype.renderGroups=function(){this._groupRenderingDisabled||this._page.updateGroupsView(this.groups)},t.prototype.renderGroupsAfter=function(n){var t=this._groupRenderingDisabled;this._groupRenderingDisabled=!0;try{n()}finally{this._groupRenderingDisabled=t;this.renderGroups()}},t.prototype.renderTopResults=function(){this._topResultsRenderingDisabled||this._page.updateTopResultsView(this.topResults)},t.prototype.renderTopResultsAfter=function(n){var u=this._topResultsRenderingDisabled,t,i,r;this._topResultsRenderingDisabled=!0;try{n()}finally{for(this._topResultsRenderingDisabled=u,this.renderTopResults(),t=0,i=this.topResults;t<i.length;t++)r=i[t],r.executeScript&&r.executeScript()}},t}();n.BaseRootViewModel=t}(AutoSuggest||(AutoSuggest={})),function(n){var t="aria-selected",i=function(){function i(i){var r=this,u;this._renderingInProgress=!1;this._narratorLaunchHandlers=[];this._viewData={};u=new MutationObserver(function(n){var i,o,u,f,s,e;if(!r._renderingInProgress){for(i=[],u=0,f=n;u<f.length;u++)s=f[u],e=s.target,o=e.id,i.push(e.getAttribute(t)=="true"?1:0);(i.length==1&&i[0]==0||i.length==2&&i[0]^i[1])&&r._narratorLaunchHandlers.forEach(function(n){return n(o)})}});u.observe(document,{subtree:!0,attributes:!0,attributeFilter:[t]});n.View&&(n.View.getLocString=function(n){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return i.getLocString.apply(i,[n].concat(r))})}return i.prototype.bindOnNarratorLaunch=function(n){this._narratorLaunchHandlers.push(n)},i.prototype.render=function(t){var i=this;this._renderingTimer&&sb_ct(this._renderingTimer);this._renderingInProgress=!0;try{n.View&&(n.View.ViewData=this.getViewData());t()}finally{this._renderingTimer=sb_st(function(){i._renderingTimer=null;i._renderingInProgress=!1},0)}},i.prototype.addViewData=function(n,t){this._viewData[n]=t},i.prototype.getViewData=function(){return this._viewData},i}();n.BasePage=i}(AutoSuggest||(AutoSuggest={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i="slideInMessage",r;t.PreviewPaneWidth=440;r=function(r){function u(n,u){var f=r.call(this,u)||this,e;return f._config=n,f._host=u,f._windowsTemporaryMessageShown=!1,f._windowsIndexingMessageShown=!1,f._suggestionsContainerHeight=0,f.progressBarVisible=!1,f.previewPaneVisible=!1,f.addViewData("TestHooksEnabled",n.th),f._windowsTemporaryMessageWrapper=_ge("temporaryMessageWrapper"),f._windowsIndexingMessageWrapper=_ge("indexingMessageWrapper"),f._qfContainer=_ge("qfContainer"),e="en-US",f._groupsView=Sparkle.render("AutoSuggest:WindowsGroups",{uiCulture:e,properties:{Groups:[]},viewData:f.getViewData()},_ge("groups")),f._topResultsView=Sparkle.render("AutoSuggest:WindowsTopResults",{uiCulture:e,properties:{},viewData:f.getViewData()},_ge("topResults")),f._windowsTemporaryMessageView=Sparkle.render("AutoSuggest:WindowsMessage",{uiCulture:e,properties:{MessageClassName:i},viewData:f.getViewData()},_ge("temporaryMessage")),f._windowsDialogBoxView=Sparkle.render("AutoSuggest:WindowsDialogBox",{uiCulture:e,properties:{},viewData:f.getViewData()},_ge("dialogBox")),f._windowsIndexingMessageView=Sparkle.render("AutoSuggest:WindowsIndexingMessage",{uiCulture:e,properties:{},viewData:f.getViewData()},_ge("indexingMessage")),f._topHitHeaderView=Sparkle.render("AutoSuggest:TopHitHeader",{uiCulture:e,properties:{ShowModule:!1,Scopes:[]},viewData:f.getViewData()},_ge("topHitHeader")),n.scopesOrder.length>0&&(f._searchScopesL2View=Sparkle.render("AutoSuggest:WindowsSearchScopesL2",{uiCulture:e,properties:{Scopes:[],AdvancedOptions:[]},viewData:f.getViewData()},_ge("searchScopesL2"))),n.startMenuPrototypeEnabled&&(f._startMenu=Sparkle.render("AutoSuggest:WindowsGroups",{uiCulture:e,properties:{Groups:[]},viewData:f.getViewData()},_ge("startMenu"))),u.bindAppVisible(function(){var i,r,n;f._root||(f._root=_ge("root"));i=SearchAppWrapper.CortanaApp.width;r=SearchAppWrapper.CortanaApp.height;i&&r?(f.setDimensions(i,r),t.PreviewPane&&(f.initPreviewPane(),n=f.immersiveMode(),t.setVisiblity(f._previewPane,n),t.setZeroInputDataSourcesForL1(f._config,n),n?f._root.classList.add("immersiveMode"):f._root.classList.remove("immersiveMode"))):ThresholdUtilities.getCortanaHeaders(function(n){if(n){var t=n["X-BM-DeviceDimensionsLogical"].split("x"),i=t[0],r=t[1];f.setDimensions(parseInt(i),r)}});u.getFeatureEnabled("TransparentQFWebview").featureEnabled?f._root.classList.add("transparentWebView"):f._root.classList.remove("transparentWebView");f.resetSuggestionsContainerHeight()}),u.bindAppHidden(function(){return f._openPreviewPaneButtonCache=undefined}),f}return __extends(u,r),u.prototype.alwaysWideMode=function(){return this._config.goWideAtStartup||this.immersiveMode()},u.prototype.immersiveMode=function(){return this._config.immersiveModeSupported&&this._originalPaneWidth>t.PreviewPaneWidth||SearchAppWrapper.CortanaApp.hostingEnvironment==1},u.prototype.initPreviewPane=function(){this._previewPane||(this._previewPane=_ge("qfPreviewPane"),this._previewPane.style.flexBasis=t.PreviewPaneWidth+"px")},u.prototype.setDimensions=function(n,i){if(t.isMobileCache&&i&&(this._root||(this._root=_ge("root")),this._root.style.height=i+"px"),n!=this._currentPaneWidth){this.onPaneWidthSet(n);this._originalPaneWidth=n}},u.prototype.getScrollTop=function(){return this._qfContainer.scrollTop},u.prototype.scrollToTop=function(){this._qfContainer.scrollTop=0;_d.body.scrollTop=0},u.prototype.scrollTo=function(n){var r=_ge(n.id),i;this.scrollToElement(r,this._qfContainer,this._qfContainer.offsetHeight);i=window.innerHeight;t.isMobileCache&&_d.body.scrollHeight>i&&this.scrollToElement(r,_d.body,i)},u.prototype.scrollToElement=function(n,t,i){var u=t.scrollTop,r=n.offsetTop-t.offsetTop,f=r+n.offsetHeight;f>u+i?t.scrollTop=f-i:r<u&&(t.scrollTop=r)},u.prototype.getSuggestionsContainerHeight=function(){return this._suggestionsContainerHeight||this.calculateSuggestionsContainerHeight(),this._suggestionsContainerHeight},u.prototype.resetSuggestionsContainerHeight=function(){this._suggestionsContainerHeight=0},u.prototype.calculateSuggestionsContainerHeight=function(){var n=_ge("root").clientHeight,t=_ge("indexingMessage");n-=t.offsetHeight;this._suggestionsContainerHeight=n},u.prototype.isSingleWidth=function(){return!this.immersiveMode()&&this._currentPaneWidth==this._originalPaneWidth},u.prototype.openDoubleWidth=function(){if(this.isSingleWidth()){this.setDimensions(SearchAppWrapper.CortanaApp.width,null);var n=this._currentPaneWidth+t.PreviewPaneWidth;SearchAppWrapper.CortanaApp.setPaneWidth(n);this.onPaneWidthSet(n)}},u.prototype.closeDoubleWidth=function(){if(!this.isSingleWidth()){SearchAppWrapper.CortanaApp.resetToDefaultSize();this.onPaneWidthSet(this._originalPaneWidth)}},u.prototype.onPaneWidthSet=function(t){this._currentPaneWidth=t;n.safeFireEvent("CortanaPaneWidthSet",t)},u.prototype.setContextMenuHandler=function(n){this._contextMenuHandler=n},u.prototype.setSuggestionClickHandler=function(n){this._suggestionClickHandler=n},u.prototype.setOpenPreviewPaneClickHandler=function(n){this._openPreviewPaneClickHandler=n},u.prototype.getOpenPreviewPaneButton=function(){if(!t.PreviewPane||this.alwaysWideMode())return null;if(!this._openPreviewPaneButtonCache){var n=ThresholdUtilities.isRightToLeftLanguage(t.uiLanguageCache);this._openPreviewPaneButtonCache={defaultIcon:{content:n?t.CortanaFontIcons.ChevronLeft:t.CortanaFontIcons.ChevronRight,type:2},openedIcon:{content:n?t.CortanaFontIcons.Back:t.CortanaFontIcons.Forward,type:2},clickHandler:this._openPreviewPaneClickHandler}}return this._openPreviewPaneButtonCache},u.prototype.updateGroupsView=function(n){var i=this;if(this._config.th&&ClientTestHooks.isTesthookParamSet("forceRenderingCrashOnSecondConversation")&&this._host.getPaneCloseCount())throw new Error("Simulated exception");this.render(function(){Sparkle.update(i._groupsView,{uiCulture:t.uiLanguageCache,properties:{Groups:n,ContextMenuHandler:i._contextMenuHandler,ClickHandler:i._suggestionClickHandler,OpenPreviewPaneButton:i.getOpenPreviewPaneButton(),WebSuggestionAnnotation:" - "+t.getWebSuggestionAnnotation(i._host),CountLabelNextToL2Headers:i._config.countLabelNextToL2Headers},viewData:i.getViewData()})})},u.prototype.updateTopResultsView=function(n){var i=this;this.render(function(){Sparkle.update(i._topResultsView,{uiCulture:t.uiLanguageCache,properties:{Suggestions:n,ContextMenuHandler:i._contextMenuHandler,ClickHandler:i._suggestionClickHandler,OpenPreviewPaneButton:i.getOpenPreviewPaneButton()},viewData:i.getViewData()})})},u.prototype.showTemporaryMessage=function(r,u){var f=this;this._windowsTemporaryMessageShown?(this.hideTemporaryMessage(),sb_st(function(){return n.safeExecute(function(){return f.showTemporaryMessage(r,u)},"showTemporaryMessage")},100)):(Sparkle.update(this._windowsTemporaryMessageView,{uiCulture:t.uiLanguageCache,properties:{Visible:!0,Icon:u,MessageClassName:i,MessageText:r,ClickHandler:function(){f.hideTemporaryMessage();f._host.setFocusInSearchBox("temporaryMessage")}},viewData:this.getViewData()}),this._windowsTemporaryMessageShown=!0,t.setVisiblity(this._windowsTemporaryMessageWrapper,!0))},u.prototype.hideTemporaryMessage=function(){this._windowsTemporaryMessageShown&&(Sparkle.update(this._windowsTemporaryMessageView,{uiCulture:t.uiLanguageCache,properties:{MessageClassName:i},viewData:this.getViewData()}),this._windowsTemporaryMessageShown=!1,t.setVisiblity(this._windowsTemporaryMessageWrapper,!1))},u.prototype.showIndexingMessage=function(n,i){this._windowsIndexingMessageShown||(Sparkle.update(this._windowsIndexingMessageView,{uiCulture:t.uiLanguageCache,properties:{Icon:{content:t.CortanaFontIcons.Sync,type:2},Running:n,Visible:!0,Action:i},viewData:this.getViewData()}),this._windowsIndexingMessageShown=!0,t.setVisiblity(this._windowsIndexingMessageWrapper,!0),this.resetSuggestionsContainerHeight())},u.prototype.hideIndexingMessage=function(){this._windowsIndexingMessageShown&&(Sparkle.update(this._windowsIndexingMessageView,{uiCulture:t.uiLanguageCache,properties:{},viewData:this.getViewData()}),this._windowsIndexingMessageShown=!1,t.setVisiblity(this._windowsIndexingMessageWrapper,!1),this.resetSuggestionsContainerHeight())},u.prototype.updateDialogBox=function(n,i,r){var u=this;this.render(function(){Sparkle.update(u._windowsDialogBoxView,{uiCulture:t.uiLanguageCache,properties:{Visible:n,MessageText:i,Buttons:r},viewData:u.getViewData()})})},u.prototype.updateTopHitHeaderView=function(n,i,r,u,f,e,o){var s=this;this.render(function(){Sparkle.update(s._topHitHeaderView,{uiCulture:t.uiLanguageCache,properties:{ShowModule:n&&!s.immersiveMode(),HeaderText:i,Message:r,MessageIcon:u,Scopes:f,ChevronDownIcon:{content:t.CortanaFontIcons.ChevronDown,type:2},MoreClickHandler:e,AdvancedOptions:o},viewData:s.getViewData()})})},u.prototype.updateSearchScopesL2View=function(n,i,r,u){var f=this;this.render(function(){Sparkle.update(f._searchScopesL2View,{uiCulture:t.uiLanguageCache,properties:{Scopes:n,CancelIcon:{content:t.CortanaFontIcons.ChevronDown,type:2},CancelHandler:i,AdvancedOptionsBottom:u,AdvancedOptionsTop:r},viewData:f.getViewData()})})},u.prototype.updateStartMenu=function(n){this._config.startMenuPrototypeEnabled&&(_ge("startMenu").style.display=n.length?"block":"none",Sparkle.update(this._startMenu,{uiCulture:t.uiLanguageCache,properties:{Groups:n,ContextMenuHandler:this._contextMenuHandler,ClickHandler:this._suggestionClickHandler},viewData:this.getViewData()}))},u.prototype.setProgressIndicatorVisibility=function(n){this.progressBarVisible!=n&&(this._progressBar||(this._progressBar=_ge("b_progress")),t.setVisiblity(this._progressBar,n),this.progressBarVisible=n)},u.prototype.setPreviewPaneVisibility=function(n){this.previewPaneVisible!=n&&(n||this.closeDoubleWidth(),t.setVisiblity(this._previewPane,n),n&&this.openDoubleWidth(),this.previewPaneVisible=n)},u}(n.BasePage);t.Page=r})(t=n.WSB||(n.WSB={}))}(AutoSuggest||(AutoSuggest={})),function(n){var r="SA_SUPERFRESH_SUPPRESS",u="LAST",t="SRCHHPGUSR",i="FORCE",f=54e5,e=function(){function e(t,i,e){var o=this;this._config=t;this._host=i;this._appCacheInstrumentationHelper=e;this._isReloadSuppressed=!1;this._pendingReload=!1;e.registerSuperFresh();this._lastCheck=Number(sj_cook.get(r,u));i.hasFallbackHappened()&&(this._isReloadSuppressed=!0,this._lastReloadAfterFallback=n.getCurrentTime());i.bindAppHidden(function(){(o._isReloadSuppressed=o._lastReloadAfterFallback&&n.getCurrentTime()-o._lastReloadAfterFallback<f,o._isReloadSuppressed)||(!o._pendingReload&&t.reloadAfterConversations&&i.getPaneCloseCount()>=t.reloadAfterConversations&&(o._pendingReload=!0),o._pendingReload&&(o.logReloadAttempt(),o.reload()))});sj_be(applicationCache,"updateready",function(){return o.onUpdateReady()});i.bindConversationStart(function(){o._isReloadSuppressed=!0;o.shouldCheckForUpdate()&&(applicationCache.status!=0||appcacheConfig.IgnoreAppCacheStatus)&&n.safeExecute(function(){applicationCache.update();o._lastCheck=sb_gt();sj_cook.set(r,u,o._lastCheck.toString())},"probe for manifest update")})}return e.prototype.shouldCheckForUpdate=function(){var r,u,f;return n.isBingEnabledCache?(r=!0,appcacheConfig.ReduceLoadEnabled&&(u=sj_cook.get(t,i),u!=="1"&&(f=(sb_gt()-this._lastCheck)/6e4,r=f>=appcacheConfig.TimeToRefresh)),this._config.th&&ClientTestHooks.isTesthookParamSet("disableAppCache"))?!1:r:!1},e.prototype.onUpdateReady=function(){appcacheConfig.ReduceLoadEnabled&&sj_cook.get(t,i)==="1"&&sj_cook.set(t,i,"0",!0,"/");this.logReloadAttempt();this._isReloadSuppressed?this._pendingReload=!0:this.reload()},e.prototype.reload=function(){this._host.reloadWebView(!1)},e.prototype.logReloadAttempt=function(){this._appCacheInstrumentationHelper.instrumentSuperFreshUpdate(this._isReloadSuppressed)},e}();n.SuperFreshAppCache=e}(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(t){var i,r;(function(t){function u(t,i,r,u,f,e){var s,h=function(n){s&&f.unregister(s);SharedLogHelper.LogError(t,e,n);u&&u(n)},o,c;try{o=i();o?(f&&o.cancel&&(s=f.register(function(){return n.safeExecute(function(){return o.cancel()},t+" cancellation")},!1)),c=function(i){s&&f.unregister(s);r&&n.safeExecute(function(){return r(i)},t+" completion")},o.done?o.done(c,h):o.then(c,h)):h(new Error("No promise returned"))}catch(l){h(l)}}function f(n,i,r){var f,e,o,u=[],s=function(n){f=n;o=!0;u.forEach(function(t){return t(n)});u=null};return function(h){o?h(f):(u.push(h),e||(e=!0,t.safeChain(n,function(){return i()},function(n){return s(r?r(n):n)},function(){return s(null)})))}}function r(t,i,r,u){i.completed=!0;i.result=r;i.pendingCallbacks.forEach(function(t){return n.safeExecute(function(){return t(r)},u)});i.pendingCallbacks=null}function e(){i={}}function o(){var n=[];for(var t in i)i[t].completed||n.push(t);n.forEach(function(n){return delete i[n]})}function s(u,f,e,o,s,h,c){return function(l,a){var y=e(l),v=i[y],p;v||(v={started:!1,completed:!1,result:null,pendingCallbacks:[]},i[y]=v);v.completed?a(v.result):(v.pendingCallbacks.push(a),v.started||(v.started=!0,p=function(){t.safeChain(u,function(){return f(l)},function(n){return r(y,v,o?o(n):n,u)},function(t){n.isCancellation(t)?r(y,v,null,u):c?(c-=1,p()):r(y,v,s,u)},null,h)},p()))}}t.safeChain=u;t.safeChainWithCaching=f;var i={};t.clearGlobalCache=e;t.clearPendingItemsFromCache=o;t.safeChainWithGlobalCaching=s})(i=t.Promise||(t.Promise={})),function(n){function t(n,t,i){for(var u,f,e={},r=0,o=n;r<o.length;r++)u=o[r],f=t[u],f&&(e[u]=i(f));return e}function i(n){for(var t in n)if(n[t])return!1;return!0}n.map=t;n.isEmpty=i}(r=t.Map||(t.Map={}))})(t=n.WSB||(n.WSB={}))}(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(t){var i;(function(i){function o(){return!!r}function s(){return r&&r.selectableItems}function h(){return r&&r.selectedItem}function e(n,t){var i=_ge(n.id),u;t?i.classList.add(f):i.classList.remove(f);u=t?"true":"false";r&&r.page?r.page.render(function(){return i.setAttribute("aria-selected",u)}):i.setAttribute("aria-selected",u)}function c(n){r&&(r.selectedItem&&(r.selectedItem.selected=!1,e(r.selectedItem,!1)),r.selectedItem=n,r.selectedItem&&(r.selectedItem.selected=!0,e(r.selectedItem,!0)))}function l(n,t,i,r,u,f){v(t,i,a(n,r),u,f)}function a(i,r){return i.map(function(i){var f={id:i.verb,text:i.displayName,isSeparator:!i.verb,selected:!1,isDefault:i.isDefault};return f.isSeparator||(f.click=function(f,e,o){r(i.verb,f,e,o);i.executeSync?n.safeExecute(function(){return i.executeSync()},"verb.executeSync",null,i.verb):t.Promise&&t.Promise.safeChain?t.Promise.safeChain("verb.executeAsync",function(){return i.executeAsync()},null,null,null,i.verb):n.safeExecute(function(){return i.executeAsync()},"verb.executeAsync",null,i.verb);u()}),f})}function v(t,i,f,e,o){var s,l,h,c,a;if(u(),f.length>0){for(s=_d.createElement("div"),s.id="contextMenu",s.className="contextMenu",s.style.top="1px",s.style.left="1px",s.style.visibility="hidden",s.setAttribute("role","listbox"),l=function(t){var r,i,u;t.isSeparator?(r=_d.createElement("hr"),r.className="divider",s.appendChild(r)):(i=_d.createElement("div"),i.id=t.id,u=t.isDefault?'<span class="highlighted">'+t.text+"<\/span>":t.text,i.innerHTML=u,i.setAttribute("role","listitem"),i.setAttribute("aria-label",t.text),i.className="contextMenuItem",i.addEventListener("mouseup",function(i){i.button==0&&t.click(n.getCurrentTime(),n.getInputType(i),null)}),s.appendChild(i))},h=0,c=f;h<c.length;h++)a=c[h],l(a);_d.body.appendChild(s);r={contextMenuElement:s,selectableItems:f.filter(function(n){return!n.isSeparator}),selectedItem:null,page:e,onDismiss:o};sb_st(function(){return n.safeExecute(function(){var u,o;if(r&&r.contextMenuElement){var n=r.contextMenuElement,f=13,e=2*f;t-=f;i-=f;u=n.offsetWidth+e;u>n.parentElement.offsetWidth&&(u=n.parentElement.offsetWidth,n.style.width=u-e+"px");o=n.offsetHeight+e;n.style.left=n.parentElement.offsetWidth-t<u?n.parentElement.offsetWidth-u+"px":t+"px";n.style.top=n.parentElement.offsetHeight-i<o?n.parentElement.offsetHeight-o+"px":i+"px";n.style.visibility=""}},"renderContextMenu")},0)}}function u(){if(r){var n=r;r=null;n.contextMenuElement&&_d.body.removeChild(n.contextMenuElement);n.onDismiss&&n.onDismiss()}}var r,f;i.isContextMenuVisible=o;i.getSelectableItems=s;i.getSelectedItem=h;f="sa_hv";i.select=c;i.showContextMenu=l;i.dismiss=u;_d.body.addEventListener("mouseup",u);_w.addEventListener("blur",u);sj_evt.bind("ajax.threshold.pageStart",u)})(i=t.ContextMenus||(t.ContextMenus={}))})(t=n.WSB||(n.WSB={}))}(AutoSuggest||(AutoSuggest={})),function(n){var t;(function(t){var i=SearchAppWrapper.CortanaApp,f="/account/permissions/token?",e="/account/permissions/sso?",o=function(){function n(n){this._config=n;this._windowsAccount=new r;this._connectedAccount=new u(n)}return n.prototype.getAccount=function(n,i,r,u,f){if(this._config.substrateContentForWindowsAccount)this._windowsAccount.getWindowsAccount(n,i,r,u,f);else if(t.isCortanaPersonalized)this._connectedAccount.getConnectedAccount(n,i,r,u,f);else throw new Error("getAccountAsync can be called only in RS3+ or when Cortana is personalized");},n.prototype.authenticate=function(n,t,i,r,u){this._windowsAccount.authenticate(n,t,i,r,u)},n}(),r,u;t.AccessTokenManager=o;r=function(){function r(){}return r.prototype.authenticate=function(r,u,f,e,o){var s=i.authenticationManager.createAuthenticateRequest();s.accountType=t.WindowsAccountType;s.silentMode=f;r==t.Office365Provider?s.resource=u:s.scope=t.SubstrateConsumerScopes;t.Promise.safeChain("authenticateAsync",function(){return i.authenticationManager.authenticateAsync(s)},function(i){if(i&&i.token){var f={AccessTokenValue:i.token,IsActive:"true",ProviderType:r,UserSmtpAddress:i.properties.UPN||i.userName,ExpireDateTime:i.properties.exp?parseInt(i.properties.exp)*1e3:null,TenantName:i.properties.tenant_display_name||""};r==t.OutlookProvider&&(f.ExpireDateTime=n.getCurrentTime()+36e5);ConnectedAccounts.setToken(f,r,u);e()}else o()},o)},r.prototype.getWindowsAccount=function(t,i,r,u,f){var e=ConnectedAccounts.findAccount(t,i,r,u),o,s;e&&(!e.Connected||!r||e.Token)?f(e):(o=function(){f(ConnectedAccounts.findAccount(t,i,r))},s=function(){ConnectedAccounts.setConnectedState(!1,t);f(ConnectedAccounts.findAccount(t,i,r))},n.isBrowserOnline()?this.authenticate(t,i,!0,o,s):f(null))},r}();u=function(){function r(r){var u=this;this._config=r;this._triggerSSO=!0;this._config.cortanaCapabilitiesAvailable&&sj_be(_w,"load",function(){var r=function(){var f=i.isCortanaEnabled?n.safeExecute(function(){return i.getCortanaCapabilities()},"getCortanaCapabilities","").split(","):[],e=n.contains(f,t.CortanaCapabilities.Personalization),r;i.currentState==0&&u._triggerSSO&&e&&(u._triggerSSO=!1,r=function(n){if(!u._config.substrateContentForWindowsAccount){var i=n==t.OutlookProvider?t.SubstrateConsumerResource:t.SubstrateEnterpriseResource,r=ConnectedAccounts.findAccount(n,i,!1);r&&r.Connected&&u.getConnectedAccount(n,i,!0,0,function(){})}},u._config.substrateContentForWindowsAccount?t.Promise.safeChain("enumerateAccountAuthorityAsync",function(){return i.authenticationManager.enumerateAccountAuthorityAsync()},function(n){var i=n[t.WindowsAccountType],f=n[t.CortanaAccountType];i=="organizations"?u.silentSignIn(t.Office365Provider,r):i=="consumers"&&f!="organizations"&&u.silentSignIn(t.OutlookProvider,r)}):t.Promise.safeChain("getQueryHeadersAsync",function(){return i.getQueryHeadersAsync()},function(n){n&&(u.silentSignIn(t.Office365Provider,r),n["X-Search-RPSToken"]&&u.silentSignIn(t.OutlookProvider,r))}))};n.isBrowserOnline()?r():sj_be(_w,"online",function(){r()})})}return r.prototype.getConnectedAccount=function(t,i,r,u,e){var s=ConnectedAccounts.findAccount(t,i,r,u),o,h,c,l;s&&(!s.Connected||!r||s.Token)?e(s):(o=f+"provider="+t+"&resource="+i,this._config.th&&(o=ClientTestHooks.CopyTestParameters(_w.location.search,o),h=ClientTestHooks.getUrlValue("aadAccessToken",null),h!=null&&(o+="&aadAccessToken="+h),c=ClientTestHooks.getUrlValue("msaAccessToken",null),c!=null&&(o+="&msaAccessToken="+c)),l=function(n){var u,f;if(n)if(n.AccessTokenValue)ConnectedAccounts.setToken(n,t,i);else{if(n.AuthError){u={Connected:!1,Token:null,UserSmtpAddress:null,AuthError:!0};e(u);return}ConnectedAccounts.setConnectedState(!1,t)}else ConnectedAccounts.setConnectedState(!1,t);f=ConnectedAccounts.findAccount(t,i,r);e(f)},n.fetchUrlJson(o,{},null,l))},r.prototype.silentSignIn=function(t,r){var u=this,f=e+"provider="+t,o=function(f){if(f){var e=function(n){n&&!n.IsError&&ConnectedAccounts.setConnectedState(!0,t);r(t)};n.isBrowserOnline()&&i.currentState==0?u.refreshOAuthToken(f.AuthUrl,f.CallbackUrl,f.Options||1,e):r(t)}else r(t)};n.fetchUrlJson(f,{},null,o)},r.prototype.refreshOAuthToken=function(r,u,f,e){t.Promise.safeChain("authenticateAsync",function(){return i.authenticateAsync(f,r,u)},function(t){if(t){var i=t.split("?")[1],r="/agents/oauth?"+i;n.fetchUrlJson(r,{},null,e)}})},r}()})(t=n.WSB||(n.WSB={}))}(AutoSuggest||(AutoSuggest={}))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        dataTable.dtr-column > tbody > tr > th.control:before {
  top: 50%;
  left: 50%;
  height: 16px;
  width: 16px;
  margin-top: -10px;
  margin-left: -10px;
  display: block;
  position: absolute;
  color: white;
  border: 2px solid white;
  border-radius: 14px;
  box-shadow: 0 0 3px #444;
  box-sizing: content-box;
  text-align: center;
  font-family: 'Courier New', Courier, monospace;
  line-height: 14px;
  content: '+';
  background-color: #337ab7;
}
table.dataTable.dtr-column > tbody > tr.parent td.control:before,
table.dataTable.dtr-column > tbody > tr.parent th.control:before {
  content: '-';
  background-color: #d33333;
}
table.dataTable > tbody > tr.child {
  padding: 0.5em 1em;
}
table.dataTable > tbody > tr.child:hover {
  background: transparent !important;
}
table.dataTable > tbody > tr.child ul {
  display: inline-block;
  list-style-type: none;
  margin: 0;
  padding: 0;
}
table.dataTable > tbody > tr.child ul li {
  border-bottom: 1px solid #efefef;
  padding: 0.5em 0;
}
table.dataTable > tbody > tr.child ul li:first-child {
  padding-top: 0;
}
table.dataTable > tbody > tr.child ul li:last-child {
  border-bottom: none;
}
table.dataTable > tbody > tr.child span.dtr-title {
  display: inline-block;
  min-width: 75px;
  font-weight: bold;
}

div.dtr-modal {
  position: fixed;
  box-sizing: border-box;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  z-index: 100;
  padding: 10em 1em;
}
div.dtr-modal div.dtr-modal-display {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 50%;
  height: 50%;
  overflow: auto;
  margin: auto;
  z-index: 102;
  overflow: auto;
  background-color: #f5f5f7;
  border: 1px solid black;
  border-radius: 0.5em;
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
}
div.dtr-modal div.dtr-modal-content {
  position: relative;
  padding: 1em;
}
div.dtr-modal div.dtr-modal-close {
  position: absolute;
  top: 6px;
  right: 6px;
  width: 22px;
  height: 22px;
  border: 1px solid #eaeaea;
  background-color: #f9f9f9;
  text-align: center;
  border-radius: 3px;
  cursor: pointer;
  z-index: 12;
}
div.dtr-modal div.dtr-modal-close:hover {
  background-color: #eaeaea;
}
div.dtr-modal div.dtr-modal-background {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 101;
  background: rgba(0, 0, 0, 0.6);
}

@media screen and (max-width: 767px) {
  div.dtr-modal div.dtr-modal-display {
    width: 95%;
  }
}
div.dtr-bs-modal table.table tr:first-child td {
  border-top: none;
}


